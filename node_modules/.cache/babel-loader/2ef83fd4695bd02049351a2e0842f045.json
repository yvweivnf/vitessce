{"ast":null,"code":"import { isNumber } from 'vega-util';\nimport { getViewConfigDiscreteStep } from '../../config';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { getMarkPropOrConfig, signalOrValueRef } from '../common';\nimport * as encode from './encode';\nexport const tick = {\n  vgMark: 'rect',\n  encodeEntry: model => {\n    const {\n      config,\n      markDef\n    } = model;\n    const orient = markDef.orient;\n    const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n    const vgThicknessChannel = orient === 'horizontal' ? 'height' : 'width';\n    return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, encode.baseEncodeEntry(model, {\n      align: 'ignore',\n      baseline: 'ignore',\n      color: 'include',\n      orient: 'ignore',\n      size: 'ignore',\n      theta: 'ignore'\n    })), encode.pointPosition('x', model, {\n      defaultPos: 'mid',\n      vgChannel: 'xc'\n    })), encode.pointPosition('y', model, {\n      defaultPos: 'mid',\n      vgChannel: 'yc'\n    })), encode.nonPosition('size', model, {\n      defaultValue: defaultSize(model),\n      vgChannel: vgSizeChannel\n    })), {\n      [vgThicknessChannel]: signalOrValueRef(getMarkPropOrConfig('thickness', markDef, config))\n    });\n  }\n};\n\nfunction defaultSize(model) {\n  var _a;\n\n  const {\n    config,\n    markDef\n  } = model;\n  const {\n    orient\n  } = markDef;\n  const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n  const scale = model.getScaleComponent(orient === 'horizontal' ? 'x' : 'y');\n  const markPropOrConfig = (_a = getMarkPropOrConfig('size', markDef, config, {\n    vgChannel: vgSizeChannel\n  })) !== null && _a !== void 0 ? _a : config.tick.bandSize;\n\n  if (markPropOrConfig !== undefined) {\n    return markPropOrConfig;\n  } else {\n    const scaleRange = scale ? scale.get('range') : undefined;\n\n    if (scaleRange && isVgRangeStep(scaleRange) && isNumber(scaleRange.step)) {\n      return scaleRange.step * 3 / 4;\n    }\n\n    const defaultViewStep = getViewConfigDiscreteStep(config.view, vgSizeChannel);\n    return defaultViewStep * 3 / 4;\n  }\n}","map":{"version":3,"sources":["../../../../src/compile/mark/tick.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { isNumber } from 'vega-util';\nimport { getViewConfigDiscreteStep } from '../../config';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { getMarkPropOrConfig, signalOrValueRef } from '../common';\nimport * as encode from './encode';\nexport const tick = {\n    vgMark: 'rect',\n    encodeEntry: (model) => {\n        const { config, markDef } = model;\n        const orient = markDef.orient;\n        const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n        const vgThicknessChannel = orient === 'horizontal' ? 'height' : 'width';\n        return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({}, encode.baseEncodeEntry(model, {\n            align: 'ignore',\n            baseline: 'ignore',\n            color: 'include',\n            orient: 'ignore',\n            size: 'ignore',\n            theta: 'ignore'\n        })), encode.pointPosition('x', model, { defaultPos: 'mid', vgChannel: 'xc' })), encode.pointPosition('y', model, { defaultPos: 'mid', vgChannel: 'yc' })), encode.nonPosition('size', model, {\n            defaultValue: defaultSize(model),\n            vgChannel: vgSizeChannel\n        })), { [vgThicknessChannel]: signalOrValueRef(getMarkPropOrConfig('thickness', markDef, config)) });\n    }\n};\nfunction defaultSize(model) {\n    var _a;\n    const { config, markDef } = model;\n    const { orient } = markDef;\n    const vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n    const scale = model.getScaleComponent(orient === 'horizontal' ? 'x' : 'y');\n    const markPropOrConfig = (_a = getMarkPropOrConfig('size', markDef, config, { vgChannel: vgSizeChannel })) !== null && _a !== void 0 ? _a : config.tick.bandSize;\n    if (markPropOrConfig !== undefined) {\n        return markPropOrConfig;\n    }\n    else {\n        const scaleRange = scale ? scale.get('range') : undefined;\n        if (scaleRange && isVgRangeStep(scaleRange) && isNumber(scaleRange.step)) {\n            return (scaleRange.step * 3) / 4;\n        }\n        const defaultViewStep = getViewConfigDiscreteStep(config.view, vgSizeChannel);\n        return (defaultViewStep * 3) / 4;\n    }\n}\n//# sourceMappingURL=tick.js.map"]},"metadata":{},"sourceType":"module"}