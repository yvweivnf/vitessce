{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport getHiResTimestamp from '../utils/hi-res-timestamp';\nexport default class Stat {\n  constructor(name, type) {\n    _defineProperty(this, \"name\", void 0);\n\n    _defineProperty(this, \"type\", void 0);\n\n    _defineProperty(this, \"sampleSize\", 1);\n\n    _defineProperty(this, \"time\", void 0);\n\n    _defineProperty(this, \"count\", void 0);\n\n    _defineProperty(this, \"samples\", void 0);\n\n    _defineProperty(this, \"lastTiming\", void 0);\n\n    _defineProperty(this, \"lastSampleTime\", void 0);\n\n    _defineProperty(this, \"lastSampleCount\", void 0);\n\n    _defineProperty(this, \"_count\", 0);\n\n    _defineProperty(this, \"_time\", 0);\n\n    _defineProperty(this, \"_samples\", 0);\n\n    _defineProperty(this, \"_startTime\", 0);\n\n    _defineProperty(this, \"_timerPending\", false);\n\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  setSampleSize(samples) {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  incrementCount() {\n    this.addCount(1);\n    return this;\n  }\n\n  decrementCount() {\n    this.subtractCount(1);\n    return this;\n  }\n\n  addCount(value) {\n    this._count += value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  subtractCount(value) {\n    this._count -= value;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  addTime(time) {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  timeStart() {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n    return this;\n  }\n\n  timeEnd() {\n    if (!this._timerPending) {\n      return this;\n    }\n\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount() {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  getSampleAverageTime() {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  getSampleHz() {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount() {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  getAverageTime() {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  getHz() {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset() {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n    return this;\n  }\n\n  _checkSampling() {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n\n}","map":{"version":3,"sources":["../../../src/lib/stat.ts"],"names":["constructor","setSampleSize","incrementCount","decrementCount","addCount","subtractCount","addTime","timeStart","getHiResTimestamp","timeEnd","getSampleAverageCount","getSampleAverageTime","getSampleHz","getAverageCount","getAverageTime","getHz","reset","_checkSampling"],"mappings":"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","sourcesContent":["import getHiResTimestamp from '../utils/hi-res-timestamp';\n\nexport default class Stat {\n  readonly name: string;\n  readonly type: string;\n  sampleSize: number = 1;\n  time: number;\n  count: number;\n  samples: number;\n  lastTiming: number;\n  lastSampleTime: number;\n  lastSampleCount: number;\n\n  _count: number = 0;\n  _time: number = 0;\n  _samples: number = 0;\n  _startTime: number = 0;\n  _timerPending: boolean = false;\n\n  constructor(name: string, type?: string) {\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  setSampleSize(samples: number): this {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  /** Call to increment count (+1) */\n  incrementCount(): this {\n    this.addCount(1);\n\n    return this;\n  }\n\n  /** Call to decrement count (-1) */\n  decrementCount(): this {\n    this.subtractCount(1);\n\n    return this;\n  }\n\n  /** Increase count */\n  addCount(value: number): this {\n    this._count += value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Decrease count */\n  subtractCount(value: number): this {\n    this._count -= value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Add an arbitrary timing and bump the count */\n  addTime(time: number): this {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Start a timer */\n  timeStart(): this {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n\n    return this;\n  }\n\n  /** End a timer. Adds to time and bumps the timing count. */\n  timeEnd(): this {\n    if (!this._timerPending) {\n      return this;\n    }\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount(): number {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  /** Calculate average time / count for the previous window */\n  getSampleAverageTime(): number {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  /** Calculate counts per second for the previous window */\n  getSampleHz(): number {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount(): number {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  /** Calculate average time / count */\n  getAverageTime(): number {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  /** Calculate counts per second */\n  getHz(): number {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  reset(): this {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n\n    return this;\n  }\n\n  _checkSampling(): void {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n}\n"]},"metadata":{},"sourceType":"module"}