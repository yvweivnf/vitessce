{"ast":null,"code":"import { tickStep } from 'd3-array';\nimport { formatSpecifier, precisionFixed, precisionRound, precisionPrefix, formatLocale, format, formatPrefix } from 'd3-format';\nimport { SECONDS, MINUTES, HOURS, DATE, WEEK, MONTH, QUARTER, YEAR, MILLISECONDS, DAY, timeInterval, utcInterval } from 'vega-time';\nimport { isString, isObject, error, extend } from 'vega-util';\nimport { timeFormat, timeParse, utcFormat, utcParse, timeFormatLocale as timeFormatLocale$1 } from 'd3-time-format';\n\nfunction memoize(method) {\n  const cache = {};\n  return spec => cache[spec] || (cache[spec] = method(spec));\n}\n\nfunction trimZeroes(numberFormat, decimalChar) {\n  return x => {\n    const str = numberFormat(x),\n          dec = str.indexOf(decimalChar);\n    if (dec < 0) return str;\n    let idx = rightmostDigit(str, dec);\n    const end = idx < str.length ? str.slice(idx) : '';\n\n    while (--idx > dec) if (str[idx] !== '0') {\n      ++idx;\n      break;\n    }\n\n    return str.slice(0, idx) + end;\n  };\n}\n\nfunction rightmostDigit(str, dec) {\n  let i = str.lastIndexOf('e'),\n      c;\n  if (i > 0) return i;\n\n  for (i = str.length; --i > dec;) {\n    c = str.charCodeAt(i);\n    if (c >= 48 && c <= 57) return i + 1; // is digit\n  }\n}\n\nfunction numberLocale(locale) {\n  const format = memoize(locale.format),\n        formatPrefix = locale.formatPrefix;\n  return {\n    format,\n    formatPrefix,\n\n    formatFloat(spec) {\n      const s = formatSpecifier(spec || ',');\n\n      if (s.precision == null) {\n        s.precision = 12;\n\n        switch (s.type) {\n          case '%':\n            s.precision -= 2;\n            break;\n\n          case 'e':\n            s.precision -= 1;\n            break;\n        }\n\n        return trimZeroes(format(s), // number format\n        format('.1f')(1)[1] // decimal point character\n        );\n      } else {\n        return format(s);\n      }\n    },\n\n    formatSpan(start, stop, count, specifier) {\n      specifier = formatSpecifier(specifier == null ? ',f' : specifier);\n      const step = tickStep(start, stop, count),\n            value = Math.max(Math.abs(start), Math.abs(stop));\n      let precision;\n\n      if (specifier.precision == null) {\n        switch (specifier.type) {\n          case 's':\n            {\n              if (!isNaN(precision = precisionPrefix(step, value))) {\n                specifier.precision = precision;\n              }\n\n              return formatPrefix(specifier, value);\n            }\n\n          case '':\n          case 'e':\n          case 'g':\n          case 'p':\n          case 'r':\n            {\n              if (!isNaN(precision = precisionRound(step, value))) {\n                specifier.precision = precision - (specifier.type === 'e');\n              }\n\n              break;\n            }\n\n          case 'f':\n          case '%':\n            {\n              if (!isNaN(precision = precisionFixed(step))) {\n                specifier.precision = precision - (specifier.type === '%') * 2;\n              }\n\n              break;\n            }\n        }\n      }\n\n      return format(specifier);\n    }\n\n  };\n}\n\nlet defaultNumberLocale;\nresetNumberFormatDefaultLocale();\n\nfunction resetNumberFormatDefaultLocale() {\n  return defaultNumberLocale = numberLocale({\n    format: format,\n    formatPrefix: formatPrefix\n  });\n}\n\nfunction numberFormatLocale(definition) {\n  return numberLocale(formatLocale(definition));\n}\n\nfunction numberFormatDefaultLocale(definition) {\n  return arguments.length ? defaultNumberLocale = numberFormatLocale(definition) : defaultNumberLocale;\n}\n\nfunction timeMultiFormat(format, interval, spec) {\n  spec = spec || {};\n\n  if (!isObject(spec)) {\n    error(\"Invalid time multi-format specifier: \".concat(spec));\n  }\n\n  const second = interval(SECONDS),\n        minute = interval(MINUTES),\n        hour = interval(HOURS),\n        day = interval(DATE),\n        week = interval(WEEK),\n        month = interval(MONTH),\n        quarter = interval(QUARTER),\n        year = interval(YEAR),\n        L = format(spec[MILLISECONDS] || '.%L'),\n        S = format(spec[SECONDS] || ':%S'),\n        M = format(spec[MINUTES] || '%I:%M'),\n        H = format(spec[HOURS] || '%I %p'),\n        d = format(spec[DATE] || spec[DAY] || '%a %d'),\n        w = format(spec[WEEK] || '%b %d'),\n        m = format(spec[MONTH] || '%B'),\n        q = format(spec[QUARTER] || '%B'),\n        y = format(spec[YEAR] || '%Y');\n  return date => (second(date) < date ? L : minute(date) < date ? S : hour(date) < date ? M : day(date) < date ? H : month(date) < date ? week(date) < date ? d : w : year(date) < date ? quarter(date) < date ? m : q : y)(date);\n}\n\nfunction timeLocale(locale) {\n  const timeFormat = memoize(locale.format),\n        utcFormat = memoize(locale.utcFormat);\n  return {\n    timeFormat: spec => isString(spec) ? timeFormat(spec) : timeMultiFormat(timeFormat, timeInterval, spec),\n    utcFormat: spec => isString(spec) ? utcFormat(spec) : timeMultiFormat(utcFormat, utcInterval, spec),\n    timeParse: memoize(locale.parse),\n    utcParse: memoize(locale.utcParse)\n  };\n}\n\nlet defaultTimeLocale;\nresetTimeFormatDefaultLocale();\n\nfunction resetTimeFormatDefaultLocale() {\n  return defaultTimeLocale = timeLocale({\n    format: timeFormat,\n    parse: timeParse,\n    utcFormat: utcFormat,\n    utcParse: utcParse\n  });\n}\n\nfunction timeFormatLocale(definition) {\n  return timeLocale(timeFormatLocale$1(definition));\n}\n\nfunction timeFormatDefaultLocale(definition) {\n  return arguments.length ? defaultTimeLocale = timeFormatLocale(definition) : defaultTimeLocale;\n}\n\nconst createLocale = (number, time) => extend({}, number, time);\n\nfunction locale(numberSpec, timeSpec) {\n  const number = numberSpec ? numberFormatLocale(numberSpec) : numberFormatDefaultLocale();\n  const time = timeSpec ? timeFormatLocale(timeSpec) : timeFormatDefaultLocale();\n  return createLocale(number, time);\n}\n\nfunction defaultLocale(numberSpec, timeSpec) {\n  const args = arguments.length;\n\n  if (args && args !== 2) {\n    error('defaultLocale expects either zero or two arguments.');\n  }\n\n  return args ? createLocale(numberFormatDefaultLocale(numberSpec), timeFormatDefaultLocale(timeSpec)) : createLocale(numberFormatDefaultLocale(), timeFormatDefaultLocale());\n}\n\nfunction resetDefaultLocale() {\n  resetNumberFormatDefaultLocale();\n  resetTimeFormatDefaultLocale();\n  return defaultLocale();\n}\n\nexport { defaultLocale, locale, numberFormatDefaultLocale, numberFormatLocale, resetDefaultLocale, resetNumberFormatDefaultLocale, resetTimeFormatDefaultLocale, timeFormatDefaultLocale, timeFormatLocale };","map":{"version":3,"sources":["C:/Users/wkuo/Documents/vitessce-forked-v1.2.2/vitessce/node_modules/vega-format/build/vega-format.module.js"],"names":["tickStep","formatSpecifier","precisionFixed","precisionRound","precisionPrefix","formatLocale","format","formatPrefix","SECONDS","MINUTES","HOURS","DATE","WEEK","MONTH","QUARTER","YEAR","MILLISECONDS","DAY","timeInterval","utcInterval","isString","isObject","error","extend","timeFormat","timeParse","utcFormat","utcParse","timeFormatLocale","timeFormatLocale$1","memoize","method","cache","spec","trimZeroes","numberFormat","decimalChar","x","str","dec","indexOf","idx","rightmostDigit","end","length","slice","i","lastIndexOf","c","charCodeAt","numberLocale","locale","formatFloat","s","precision","type","formatSpan","start","stop","count","specifier","step","value","Math","max","abs","isNaN","defaultNumberLocale","resetNumberFormatDefaultLocale","numberFormatLocale","definition","numberFormatDefaultLocale","arguments","timeMultiFormat","interval","concat","second","minute","hour","day","week","month","quarter","year","L","S","M","H","d","w","m","q","y","date","timeLocale","parse","defaultTimeLocale","resetTimeFormatDefaultLocale","timeFormatDefaultLocale","createLocale","number","time","numberSpec","timeSpec","defaultLocale","args","resetDefaultLocale"],"mappings":"AAAA,SAASA,QAAT,QAAyB,UAAzB;AACA,SAASC,eAAT,EAA0BC,cAA1B,EAA0CC,cAA1C,EAA0DC,eAA1D,EAA2EC,YAA3E,EAAyFC,MAAzF,EAAiGC,YAAjG,QAAqH,WAArH;AACA,SAASC,OAAT,EAAkBC,OAAlB,EAA2BC,KAA3B,EAAkCC,IAAlC,EAAwCC,IAAxC,EAA8CC,KAA9C,EAAqDC,OAArD,EAA8DC,IAA9D,EAAoEC,YAApE,EAAkFC,GAAlF,EAAuFC,YAAvF,EAAqGC,WAArG,QAAwH,WAAxH;AACA,SAASC,QAAT,EAAmBC,QAAnB,EAA6BC,KAA7B,EAAoCC,MAApC,QAAkD,WAAlD;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,SAAhC,EAA2CC,QAA3C,EAAqDC,gBAAgB,IAAIC,kBAAzE,QAAmG,gBAAnG;;AAEA,SAASC,OAAT,CAAkBC,MAAlB,EAA0B;AACxB,QAAMC,KAAK,GAAG,EAAd;AACA,SAAOC,IAAI,IAAID,KAAK,CAACC,IAAD,CAAL,KAAgBD,KAAK,CAACC,IAAD,CAAL,GAAcF,MAAM,CAACE,IAAD,CAApC,CAAf;AACD;;AAED,SAASC,UAAT,CAAoBC,YAApB,EAAkCC,WAAlC,EAA+C;AAC7C,SAAOC,CAAC,IAAI;AACV,UAAMC,GAAG,GAAGH,YAAY,CAACE,CAAD,CAAxB;AAAA,UACME,GAAG,GAAGD,GAAG,CAACE,OAAJ,CAAYJ,WAAZ,CADZ;AAEA,QAAIG,GAAG,GAAG,CAAV,EAAa,OAAOD,GAAP;AACb,QAAIG,GAAG,GAAGC,cAAc,CAACJ,GAAD,EAAMC,GAAN,CAAxB;AACA,UAAMI,GAAG,GAAGF,GAAG,GAAGH,GAAG,CAACM,MAAV,GAAmBN,GAAG,CAACO,KAAJ,CAAUJ,GAAV,CAAnB,GAAoC,EAAhD;;AAEA,WAAO,EAAEA,GAAF,GAAQF,GAAf,EAAoB,IAAID,GAAG,CAACG,GAAD,CAAH,KAAa,GAAjB,EAAsB;AACxC,QAAEA,GAAF;AACA;AACD;;AAED,WAAOH,GAAG,CAACO,KAAJ,CAAU,CAAV,EAAaJ,GAAb,IAAoBE,GAA3B;AACD,GAbD;AAcD;;AAED,SAASD,cAAT,CAAwBJ,GAAxB,EAA6BC,GAA7B,EAAkC;AAChC,MAAIO,CAAC,GAAGR,GAAG,CAACS,WAAJ,CAAgB,GAAhB,CAAR;AAAA,MACIC,CADJ;AAEA,MAAIF,CAAC,GAAG,CAAR,EAAW,OAAOA,CAAP;;AAEX,OAAKA,CAAC,GAAGR,GAAG,CAACM,MAAb,EAAqB,EAAEE,CAAF,GAAMP,GAA3B,GAAiC;AAC/BS,IAAAA,CAAC,GAAGV,GAAG,CAACW,UAAJ,CAAeH,CAAf,CAAJ;AACA,QAAIE,CAAC,IAAI,EAAL,IAAWA,CAAC,IAAI,EAApB,EAAwB,OAAOF,CAAC,GAAG,CAAX,CAFO,CAEO;AACvC;AACF;;AAED,SAASI,YAAT,CAAsBC,MAAtB,EAA8B;AAC5B,QAAM7C,MAAM,GAAGwB,OAAO,CAACqB,MAAM,CAAC7C,MAAR,CAAtB;AAAA,QACMC,YAAY,GAAG4C,MAAM,CAAC5C,YAD5B;AAEA,SAAO;AACLD,IAAAA,MADK;AAELC,IAAAA,YAFK;;AAIL6C,IAAAA,WAAW,CAACnB,IAAD,EAAO;AAChB,YAAMoB,CAAC,GAAGpD,eAAe,CAACgC,IAAI,IAAI,GAAT,CAAzB;;AAEA,UAAIoB,CAAC,CAACC,SAAF,IAAe,IAAnB,EAAyB;AACvBD,QAAAA,CAAC,CAACC,SAAF,GAAc,EAAd;;AAEA,gBAAQD,CAAC,CAACE,IAAV;AACE,eAAK,GAAL;AACEF,YAAAA,CAAC,CAACC,SAAF,IAAe,CAAf;AACA;;AAEF,eAAK,GAAL;AACED,YAAAA,CAAC,CAACC,SAAF,IAAe,CAAf;AACA;AAPJ;;AAUA,eAAOpB,UAAU,CAAC5B,MAAM,CAAC+C,CAAD,CAAP,EAAY;AAC7B/C,QAAAA,MAAM,CAAC,KAAD,CAAN,CAAc,CAAd,EAAiB,CAAjB,CADiB,CACG;AADH,SAAjB;AAGD,OAhBD,MAgBO;AACL,eAAOA,MAAM,CAAC+C,CAAD,CAAb;AACD;AACF,KA1BI;;AA4BLG,IAAAA,UAAU,CAACC,KAAD,EAAQC,IAAR,EAAcC,KAAd,EAAqBC,SAArB,EAAgC;AACxCA,MAAAA,SAAS,GAAG3D,eAAe,CAAC2D,SAAS,IAAI,IAAb,GAAoB,IAApB,GAA2BA,SAA5B,CAA3B;AACA,YAAMC,IAAI,GAAG7D,QAAQ,CAACyD,KAAD,EAAQC,IAAR,EAAcC,KAAd,CAArB;AAAA,YACMG,KAAK,GAAGC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAASR,KAAT,CAAT,EAA0BM,IAAI,CAACE,GAAL,CAASP,IAAT,CAA1B,CADd;AAEA,UAAIJ,SAAJ;;AAEA,UAAIM,SAAS,CAACN,SAAV,IAAuB,IAA3B,EAAiC;AAC/B,gBAAQM,SAAS,CAACL,IAAlB;AACE,eAAK,GAAL;AACE;AACE,kBAAI,CAACW,KAAK,CAACZ,SAAS,GAAGlD,eAAe,CAACyD,IAAD,EAAOC,KAAP,CAA5B,CAAV,EAAsD;AACpDF,gBAAAA,SAAS,CAACN,SAAV,GAAsBA,SAAtB;AACD;;AAED,qBAAO/C,YAAY,CAACqD,SAAD,EAAYE,KAAZ,CAAnB;AACD;;AAEH,eAAK,EAAL;AACA,eAAK,GAAL;AACA,eAAK,GAAL;AACA,eAAK,GAAL;AACA,eAAK,GAAL;AACE;AACE,kBAAI,CAACI,KAAK,CAACZ,SAAS,GAAGnD,cAAc,CAAC0D,IAAD,EAAOC,KAAP,CAA3B,CAAV,EAAqD;AACnDF,gBAAAA,SAAS,CAACN,SAAV,GAAsBA,SAAS,IAAIM,SAAS,CAACL,IAAV,KAAmB,GAAvB,CAA/B;AACD;;AAED;AACD;;AAEH,eAAK,GAAL;AACA,eAAK,GAAL;AACE;AACE,kBAAI,CAACW,KAAK,CAACZ,SAAS,GAAGpD,cAAc,CAAC2D,IAAD,CAA3B,CAAV,EAA8C;AAC5CD,gBAAAA,SAAS,CAACN,SAAV,GAAsBA,SAAS,GAAG,CAACM,SAAS,CAACL,IAAV,KAAmB,GAApB,IAA2B,CAA7D;AACD;;AAED;AACD;AA/BL;AAiCD;;AAED,aAAOjD,MAAM,CAACsD,SAAD,CAAb;AACD;;AAvEI,GAAP;AA0ED;;AAED,IAAIO,mBAAJ;AACAC,8BAA8B;;AAC9B,SAASA,8BAAT,GAA0C;AACxC,SAAOD,mBAAmB,GAAGjB,YAAY,CAAC;AACxC5C,IAAAA,MAAM,EAAEA,MADgC;AAExCC,IAAAA,YAAY,EAAEA;AAF0B,GAAD,CAAzC;AAID;;AACD,SAAS8D,kBAAT,CAA4BC,UAA5B,EAAwC;AACtC,SAAOpB,YAAY,CAAC7C,YAAY,CAACiE,UAAD,CAAb,CAAnB;AACD;;AACD,SAASC,yBAAT,CAAmCD,UAAnC,EAA+C;AAC7C,SAAOE,SAAS,CAAC5B,MAAV,GAAmBuB,mBAAmB,GAAGE,kBAAkB,CAACC,UAAD,CAA3D,GAA0EH,mBAAjF;AACD;;AAED,SAASM,eAAT,CAAyBnE,MAAzB,EAAiCoE,QAAjC,EAA2CzC,IAA3C,EAAiD;AAC/CA,EAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;;AAEA,MAAI,CAACZ,QAAQ,CAACY,IAAD,CAAb,EAAqB;AACnBX,IAAAA,KAAK,CAAC,wCAAwCqD,MAAxC,CAA+C1C,IAA/C,CAAD,CAAL;AACD;;AAED,QAAM2C,MAAM,GAAGF,QAAQ,CAAClE,OAAD,CAAvB;AAAA,QACMqE,MAAM,GAAGH,QAAQ,CAACjE,OAAD,CADvB;AAAA,QAEMqE,IAAI,GAAGJ,QAAQ,CAAChE,KAAD,CAFrB;AAAA,QAGMqE,GAAG,GAAGL,QAAQ,CAAC/D,IAAD,CAHpB;AAAA,QAIMqE,IAAI,GAAGN,QAAQ,CAAC9D,IAAD,CAJrB;AAAA,QAKMqE,KAAK,GAAGP,QAAQ,CAAC7D,KAAD,CALtB;AAAA,QAMMqE,OAAO,GAAGR,QAAQ,CAAC5D,OAAD,CANxB;AAAA,QAOMqE,IAAI,GAAGT,QAAQ,CAAC3D,IAAD,CAPrB;AAAA,QAQMqE,CAAC,GAAG9E,MAAM,CAAC2B,IAAI,CAACjB,YAAD,CAAJ,IAAsB,KAAvB,CARhB;AAAA,QASMqE,CAAC,GAAG/E,MAAM,CAAC2B,IAAI,CAACzB,OAAD,CAAJ,IAAiB,KAAlB,CAThB;AAAA,QAUM8E,CAAC,GAAGhF,MAAM,CAAC2B,IAAI,CAACxB,OAAD,CAAJ,IAAiB,OAAlB,CAVhB;AAAA,QAWM8E,CAAC,GAAGjF,MAAM,CAAC2B,IAAI,CAACvB,KAAD,CAAJ,IAAe,OAAhB,CAXhB;AAAA,QAYM8E,CAAC,GAAGlF,MAAM,CAAC2B,IAAI,CAACtB,IAAD,CAAJ,IAAcsB,IAAI,CAAChB,GAAD,CAAlB,IAA2B,OAA5B,CAZhB;AAAA,QAaMwE,CAAC,GAAGnF,MAAM,CAAC2B,IAAI,CAACrB,IAAD,CAAJ,IAAc,OAAf,CAbhB;AAAA,QAcM8E,CAAC,GAAGpF,MAAM,CAAC2B,IAAI,CAACpB,KAAD,CAAJ,IAAe,IAAhB,CAdhB;AAAA,QAeM8E,CAAC,GAAGrF,MAAM,CAAC2B,IAAI,CAACnB,OAAD,CAAJ,IAAiB,IAAlB,CAfhB;AAAA,QAgBM8E,CAAC,GAAGtF,MAAM,CAAC2B,IAAI,CAAClB,IAAD,CAAJ,IAAc,IAAf,CAhBhB;AAiBA,SAAO8E,IAAI,IAAI,CAACjB,MAAM,CAACiB,IAAD,CAAN,GAAeA,IAAf,GAAsBT,CAAtB,GAA0BP,MAAM,CAACgB,IAAD,CAAN,GAAeA,IAAf,GAAsBR,CAAtB,GAA0BP,IAAI,CAACe,IAAD,CAAJ,GAAaA,IAAb,GAAoBP,CAApB,GAAwBP,GAAG,CAACc,IAAD,CAAH,GAAYA,IAAZ,GAAmBN,CAAnB,GAAuBN,KAAK,CAACY,IAAD,CAAL,GAAcA,IAAd,GAAqBb,IAAI,CAACa,IAAD,CAAJ,GAAaA,IAAb,GAAoBL,CAApB,GAAwBC,CAA7C,GAAiDN,IAAI,CAACU,IAAD,CAAJ,GAAaA,IAAb,GAAoBX,OAAO,CAACW,IAAD,CAAP,GAAgBA,IAAhB,GAAuBH,CAAvB,GAA2BC,CAA/C,GAAmDC,CAAxM,EAA2MC,IAA3M,CAAf;AACD;;AAED,SAASC,UAAT,CAAoB3C,MAApB,EAA4B;AAC1B,QAAM3B,UAAU,GAAGM,OAAO,CAACqB,MAAM,CAAC7C,MAAR,CAA1B;AAAA,QACMoB,SAAS,GAAGI,OAAO,CAACqB,MAAM,CAACzB,SAAR,CADzB;AAEA,SAAO;AACLF,IAAAA,UAAU,EAAES,IAAI,IAAIb,QAAQ,CAACa,IAAD,CAAR,GAAiBT,UAAU,CAACS,IAAD,CAA3B,GAAoCwC,eAAe,CAACjD,UAAD,EAAaN,YAAb,EAA2Be,IAA3B,CADlE;AAELP,IAAAA,SAAS,EAAEO,IAAI,IAAIb,QAAQ,CAACa,IAAD,CAAR,GAAiBP,SAAS,CAACO,IAAD,CAA1B,GAAmCwC,eAAe,CAAC/C,SAAD,EAAYP,WAAZ,EAAyBc,IAAzB,CAFhE;AAGLR,IAAAA,SAAS,EAAEK,OAAO,CAACqB,MAAM,CAAC4C,KAAR,CAHb;AAILpE,IAAAA,QAAQ,EAAEG,OAAO,CAACqB,MAAM,CAACxB,QAAR;AAJZ,GAAP;AAMD;;AAED,IAAIqE,iBAAJ;AACAC,4BAA4B;;AAC5B,SAASA,4BAAT,GAAwC;AACtC,SAAOD,iBAAiB,GAAGF,UAAU,CAAC;AACpCxF,IAAAA,MAAM,EAAEkB,UAD4B;AAEpCuE,IAAAA,KAAK,EAAEtE,SAF6B;AAGpCC,IAAAA,SAAS,EAAEA,SAHyB;AAIpCC,IAAAA,QAAQ,EAAEA;AAJ0B,GAAD,CAArC;AAMD;;AACD,SAASC,gBAAT,CAA0B0C,UAA1B,EAAsC;AACpC,SAAOwB,UAAU,CAACjE,kBAAkB,CAACyC,UAAD,CAAnB,CAAjB;AACD;;AACD,SAAS4B,uBAAT,CAAiC5B,UAAjC,EAA6C;AAC3C,SAAOE,SAAS,CAAC5B,MAAV,GAAmBoD,iBAAiB,GAAGpE,gBAAgB,CAAC0C,UAAD,CAAvD,GAAsE0B,iBAA7E;AACD;;AAED,MAAMG,YAAY,GAAG,CAACC,MAAD,EAASC,IAAT,KAAkB9E,MAAM,CAAC,EAAD,EAAK6E,MAAL,EAAaC,IAAb,CAA7C;;AAEA,SAASlD,MAAT,CAAgBmD,UAAhB,EAA4BC,QAA5B,EAAsC;AACpC,QAAMH,MAAM,GAAGE,UAAU,GAAGjC,kBAAkB,CAACiC,UAAD,CAArB,GAAoC/B,yBAAyB,EAAtF;AACA,QAAM8B,IAAI,GAAGE,QAAQ,GAAG3E,gBAAgB,CAAC2E,QAAD,CAAnB,GAAgCL,uBAAuB,EAA5E;AACA,SAAOC,YAAY,CAACC,MAAD,EAASC,IAAT,CAAnB;AACD;;AACD,SAASG,aAAT,CAAuBF,UAAvB,EAAmCC,QAAnC,EAA6C;AAC3C,QAAME,IAAI,GAAGjC,SAAS,CAAC5B,MAAvB;;AAEA,MAAI6D,IAAI,IAAIA,IAAI,KAAK,CAArB,EAAwB;AACtBnF,IAAAA,KAAK,CAAC,qDAAD,CAAL;AACD;;AAED,SAAOmF,IAAI,GAAGN,YAAY,CAAC5B,yBAAyB,CAAC+B,UAAD,CAA1B,EAAwCJ,uBAAuB,CAACK,QAAD,CAA/D,CAAf,GAA4FJ,YAAY,CAAC5B,yBAAyB,EAA1B,EAA8B2B,uBAAuB,EAArD,CAAnH;AACD;;AACD,SAASQ,kBAAT,GAA8B;AAC5BtC,EAAAA,8BAA8B;AAC9B6B,EAAAA,4BAA4B;AAC5B,SAAOO,aAAa,EAApB;AACD;;AAED,SAASA,aAAT,EAAwBrD,MAAxB,EAAgCoB,yBAAhC,EAA2DF,kBAA3D,EAA+EqC,kBAA/E,EAAmGtC,8BAAnG,EAAmI6B,4BAAnI,EAAiKC,uBAAjK,EAA0LtE,gBAA1L","sourcesContent":["import { tickStep } from 'd3-array';\nimport { formatSpecifier, precisionFixed, precisionRound, precisionPrefix, formatLocale, format, formatPrefix } from 'd3-format';\nimport { SECONDS, MINUTES, HOURS, DATE, WEEK, MONTH, QUARTER, YEAR, MILLISECONDS, DAY, timeInterval, utcInterval } from 'vega-time';\nimport { isString, isObject, error, extend } from 'vega-util';\nimport { timeFormat, timeParse, utcFormat, utcParse, timeFormatLocale as timeFormatLocale$1 } from 'd3-time-format';\n\nfunction memoize (method) {\n  const cache = {};\n  return spec => cache[spec] || (cache[spec] = method(spec));\n}\n\nfunction trimZeroes(numberFormat, decimalChar) {\n  return x => {\n    const str = numberFormat(x),\n          dec = str.indexOf(decimalChar);\n    if (dec < 0) return str;\n    let idx = rightmostDigit(str, dec);\n    const end = idx < str.length ? str.slice(idx) : '';\n\n    while (--idx > dec) if (str[idx] !== '0') {\n      ++idx;\n      break;\n    }\n\n    return str.slice(0, idx) + end;\n  };\n}\n\nfunction rightmostDigit(str, dec) {\n  let i = str.lastIndexOf('e'),\n      c;\n  if (i > 0) return i;\n\n  for (i = str.length; --i > dec;) {\n    c = str.charCodeAt(i);\n    if (c >= 48 && c <= 57) return i + 1; // is digit\n  }\n}\n\nfunction numberLocale(locale) {\n  const format = memoize(locale.format),\n        formatPrefix = locale.formatPrefix;\n  return {\n    format,\n    formatPrefix,\n\n    formatFloat(spec) {\n      const s = formatSpecifier(spec || ',');\n\n      if (s.precision == null) {\n        s.precision = 12;\n\n        switch (s.type) {\n          case '%':\n            s.precision -= 2;\n            break;\n\n          case 'e':\n            s.precision -= 1;\n            break;\n        }\n\n        return trimZeroes(format(s), // number format\n        format('.1f')(1)[1] // decimal point character\n        );\n      } else {\n        return format(s);\n      }\n    },\n\n    formatSpan(start, stop, count, specifier) {\n      specifier = formatSpecifier(specifier == null ? ',f' : specifier);\n      const step = tickStep(start, stop, count),\n            value = Math.max(Math.abs(start), Math.abs(stop));\n      let precision;\n\n      if (specifier.precision == null) {\n        switch (specifier.type) {\n          case 's':\n            {\n              if (!isNaN(precision = precisionPrefix(step, value))) {\n                specifier.precision = precision;\n              }\n\n              return formatPrefix(specifier, value);\n            }\n\n          case '':\n          case 'e':\n          case 'g':\n          case 'p':\n          case 'r':\n            {\n              if (!isNaN(precision = precisionRound(step, value))) {\n                specifier.precision = precision - (specifier.type === 'e');\n              }\n\n              break;\n            }\n\n          case 'f':\n          case '%':\n            {\n              if (!isNaN(precision = precisionFixed(step))) {\n                specifier.precision = precision - (specifier.type === '%') * 2;\n              }\n\n              break;\n            }\n        }\n      }\n\n      return format(specifier);\n    }\n\n  };\n}\n\nlet defaultNumberLocale;\nresetNumberFormatDefaultLocale();\nfunction resetNumberFormatDefaultLocale() {\n  return defaultNumberLocale = numberLocale({\n    format: format,\n    formatPrefix: formatPrefix\n  });\n}\nfunction numberFormatLocale(definition) {\n  return numberLocale(formatLocale(definition));\n}\nfunction numberFormatDefaultLocale(definition) {\n  return arguments.length ? defaultNumberLocale = numberFormatLocale(definition) : defaultNumberLocale;\n}\n\nfunction timeMultiFormat(format, interval, spec) {\n  spec = spec || {};\n\n  if (!isObject(spec)) {\n    error(\"Invalid time multi-format specifier: \".concat(spec));\n  }\n\n  const second = interval(SECONDS),\n        minute = interval(MINUTES),\n        hour = interval(HOURS),\n        day = interval(DATE),\n        week = interval(WEEK),\n        month = interval(MONTH),\n        quarter = interval(QUARTER),\n        year = interval(YEAR),\n        L = format(spec[MILLISECONDS] || '.%L'),\n        S = format(spec[SECONDS] || ':%S'),\n        M = format(spec[MINUTES] || '%I:%M'),\n        H = format(spec[HOURS] || '%I %p'),\n        d = format(spec[DATE] || spec[DAY] || '%a %d'),\n        w = format(spec[WEEK] || '%b %d'),\n        m = format(spec[MONTH] || '%B'),\n        q = format(spec[QUARTER] || '%B'),\n        y = format(spec[YEAR] || '%Y');\n  return date => (second(date) < date ? L : minute(date) < date ? S : hour(date) < date ? M : day(date) < date ? H : month(date) < date ? week(date) < date ? d : w : year(date) < date ? quarter(date) < date ? m : q : y)(date);\n}\n\nfunction timeLocale(locale) {\n  const timeFormat = memoize(locale.format),\n        utcFormat = memoize(locale.utcFormat);\n  return {\n    timeFormat: spec => isString(spec) ? timeFormat(spec) : timeMultiFormat(timeFormat, timeInterval, spec),\n    utcFormat: spec => isString(spec) ? utcFormat(spec) : timeMultiFormat(utcFormat, utcInterval, spec),\n    timeParse: memoize(locale.parse),\n    utcParse: memoize(locale.utcParse)\n  };\n}\n\nlet defaultTimeLocale;\nresetTimeFormatDefaultLocale();\nfunction resetTimeFormatDefaultLocale() {\n  return defaultTimeLocale = timeLocale({\n    format: timeFormat,\n    parse: timeParse,\n    utcFormat: utcFormat,\n    utcParse: utcParse\n  });\n}\nfunction timeFormatLocale(definition) {\n  return timeLocale(timeFormatLocale$1(definition));\n}\nfunction timeFormatDefaultLocale(definition) {\n  return arguments.length ? defaultTimeLocale = timeFormatLocale(definition) : defaultTimeLocale;\n}\n\nconst createLocale = (number, time) => extend({}, number, time);\n\nfunction locale(numberSpec, timeSpec) {\n  const number = numberSpec ? numberFormatLocale(numberSpec) : numberFormatDefaultLocale();\n  const time = timeSpec ? timeFormatLocale(timeSpec) : timeFormatDefaultLocale();\n  return createLocale(number, time);\n}\nfunction defaultLocale(numberSpec, timeSpec) {\n  const args = arguments.length;\n\n  if (args && args !== 2) {\n    error('defaultLocale expects either zero or two arguments.');\n  }\n\n  return args ? createLocale(numberFormatDefaultLocale(numberSpec), timeFormatDefaultLocale(timeSpec)) : createLocale(numberFormatDefaultLocale(), timeFormatDefaultLocale());\n}\nfunction resetDefaultLocale() {\n  resetNumberFormatDefaultLocale();\n  resetTimeFormatDefaultLocale();\n  return defaultLocale();\n}\n\nexport { defaultLocale, locale, numberFormatDefaultLocale, numberFormatLocale, resetDefaultLocale, resetNumberFormatDefaultLocale, resetTimeFormatDefaultLocale, timeFormatDefaultLocale, timeFormatLocale };\n"]},"metadata":{},"sourceType":"module"}