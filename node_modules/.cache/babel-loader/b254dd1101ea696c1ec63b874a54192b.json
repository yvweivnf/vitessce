{"ast":null,"code":"import { applyPatch } from 'fast-json-patch';\nimport stringify from 'json-stringify-pretty-compact';\nimport { satisfies } from 'semver';\nimport * as vegaImport from 'vega';\nimport { writeConfig, mergeConfig, isString, isBoolean } from 'vega';\nimport { expressionInterpreter } from 'vega-interpreter';\nimport * as vegaLiteImport from 'vega-lite';\nimport schemaParser from 'vega-schema-url-parser';\nimport * as themes from 'vega-themes';\nimport { Handler } from 'vega-tooltip';\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n\nvar Op = Object.prototype;\nvar hasOwn = Op.hasOwnProperty;\nvar undefined$1; // More compressible than void 0.\n\nvar $Symbol = typeof Symbol === \"function\" ? Symbol : {};\nvar iteratorSymbol = $Symbol.iterator || \"@@iterator\";\nvar asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\nvar toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\nfunction wrap(innerFn, outerFn, self, tryLocsList) {\n  // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n  var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n  var generator = Object.create(protoGenerator.prototype);\n  var context = new Context(tryLocsList || []); // The ._invoke method unifies the implementations of the .next,\n  // .throw, and .return methods.\n\n  generator._invoke = makeInvokeMethod(innerFn, self, context);\n  return generator;\n} // Try/catch helper to minimize deoptimizations. Returns a completion\n// record like context.tryEntries[i].completion. This interface could\n// have been (and was previously) designed to take a closure to be\n// invoked without arguments, but in all the cases we care about we\n// already have an existing method we want to call, so there's no need\n// to create a new function object. We can even get away with assuming\n// the method takes exactly one argument, since that happens to be true\n// in every case, so we don't have to touch the arguments object. The\n// only additional allocation required is the completion record, which\n// has a stable shape and so hopefully should be cheap to allocate.\n\n\nfunction tryCatch(fn, obj, arg) {\n  try {\n    return {\n      type: \"normal\",\n      arg: fn.call(obj, arg)\n    };\n  } catch (err) {\n    return {\n      type: \"throw\",\n      arg: err\n    };\n  }\n}\n\nvar GenStateSuspendedStart = \"suspendedStart\";\nvar GenStateSuspendedYield = \"suspendedYield\";\nvar GenStateExecuting = \"executing\";\nvar GenStateCompleted = \"completed\"; // Returning this object from the innerFn has the same effect as\n// breaking out of the dispatch switch statement.\n\nvar ContinueSentinel = {}; // Dummy constructor functions that we use as the .constructor and\n// .constructor.prototype properties for functions that return Generator\n// objects. For full spec compliance, you may wish to configure your\n// minifier not to mangle the names of these two functions.\n\nfunction Generator() {}\n\nfunction GeneratorFunction() {}\n\nfunction GeneratorFunctionPrototype() {} // This is a polyfill for %IteratorPrototype% for environments that\n// don't natively support it.\n\n\nvar IteratorPrototype = {};\n\nIteratorPrototype[iteratorSymbol] = function () {\n  return this;\n};\n\nvar getProto = Object.getPrototypeOf;\nvar NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n\nif (NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n  // This environment has a native %IteratorPrototype%; use it instead\n  // of the polyfill.\n  IteratorPrototype = NativeIteratorPrototype;\n}\n\nvar Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype);\nGeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\nGeneratorFunctionPrototype.constructor = GeneratorFunction;\nGeneratorFunctionPrototype[toStringTagSymbol] = GeneratorFunction.displayName = \"GeneratorFunction\"; // Helper for defining the .next, .throw, and .return methods of the\n// Iterator interface in terms of a single ._invoke method.\n\nfunction defineIteratorMethods(prototype) {\n  [\"next\", \"throw\", \"return\"].forEach(function (method) {\n    prototype[method] = function (arg) {\n      return this._invoke(method, arg);\n    };\n  });\n}\n\nfunction isGeneratorFunction(genFun) {\n  var ctor = typeof genFun === \"function\" && genFun.constructor;\n  return ctor ? ctor === GeneratorFunction || // For the native GeneratorFunction constructor, the best we can\n  // do is to check its .name property.\n  (ctor.displayName || ctor.name) === \"GeneratorFunction\" : false;\n}\n\nfunction mark(genFun) {\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n  } else {\n    genFun.__proto__ = GeneratorFunctionPrototype;\n\n    if (!(toStringTagSymbol in genFun)) {\n      genFun[toStringTagSymbol] = \"GeneratorFunction\";\n    }\n  }\n\n  genFun.prototype = Object.create(Gp);\n  return genFun;\n} // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n// `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n// meant to be awaited.\n\n\nfunction awrap(arg) {\n  return {\n    __await: arg\n  };\n}\n\nfunction AsyncIterator(generator, PromiseImpl) {\n  function invoke(method, arg, resolve, reject) {\n    var record = tryCatch(generator[method], generator, arg);\n\n    if (record.type === \"throw\") {\n      reject(record.arg);\n    } else {\n      var result = record.arg;\n      var value = result.value;\n\n      if (value && typeof value === \"object\" && hasOwn.call(value, \"__await\")) {\n        return PromiseImpl.resolve(value.__await).then(function (value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function (err) {\n          invoke(\"throw\", err, resolve, reject);\n        });\n      }\n\n      return PromiseImpl.resolve(value).then(function (unwrapped) {\n        // When a yielded Promise is resolved, its final value becomes\n        // the .value of the Promise<{value,done}> result for the\n        // current iteration.\n        result.value = unwrapped;\n        resolve(result);\n      }, function (error) {\n        // If a rejected Promise was yielded, throw the rejection back\n        // into the async generator function so it can be handled there.\n        return invoke(\"throw\", error, resolve, reject);\n      });\n    }\n  }\n\n  var previousPromise;\n\n  function enqueue(method, arg) {\n    function callInvokeWithMethodAndArg() {\n      return new PromiseImpl(function (resolve, reject) {\n        invoke(method, arg, resolve, reject);\n      });\n    }\n\n    return previousPromise = // If enqueue has been called before, then we want to wait until\n    // all previous Promises have been resolved before calling invoke,\n    // so that results are always delivered in the correct order. If\n    // enqueue has not been called before, then it is important to\n    // call invoke immediately, without waiting on a callback to fire,\n    // so that the async generator function has the opportunity to do\n    // any necessary setup in a predictable way. This predictability\n    // is why the Promise constructor synchronously invokes its\n    // executor callback, and why async functions synchronously\n    // execute code before the first await. Since we implement simple\n    // async functions in terms of async generators, it is especially\n    // important to get this right, even though it requires care.\n    previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, // Avoid propagating failures to Promises returned by later\n    // invocations of the iterator.\n    callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg();\n  } // Define the unified helper method that is used to implement .next,\n  // .throw, and .return (see defineIteratorMethods).\n\n\n  this._invoke = enqueue;\n}\n\ndefineIteratorMethods(AsyncIterator.prototype);\n\nAsyncIterator.prototype[asyncIteratorSymbol] = function () {\n  return this;\n}; // Note that simple async functions are implemented on top of\n// AsyncIterator objects; they just return a Promise for the value of\n// the final result produced by the iterator.\n\n\nfunction async(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n  if (PromiseImpl === void 0) PromiseImpl = Promise;\n  var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl);\n  return isGeneratorFunction(outerFn) ? iter // If outerFn is a generator, return the full iterator.\n  : iter.next().then(function (result) {\n    return result.done ? result.value : iter.next();\n  });\n}\n\nfunction makeInvokeMethod(innerFn, self, context) {\n  var state = GenStateSuspendedStart;\n  return function invoke(method, arg) {\n    if (state === GenStateExecuting) {\n      throw new Error(\"Generator is already running\");\n    }\n\n    if (state === GenStateCompleted) {\n      if (method === \"throw\") {\n        throw arg;\n      } // Be forgiving, per 25.3.3.3.3 of the spec:\n      // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n\n\n      return doneResult();\n    }\n\n    context.method = method;\n    context.arg = arg;\n\n    while (true) {\n      var delegate = context.delegate;\n\n      if (delegate) {\n        var delegateResult = maybeInvokeDelegate(delegate, context);\n\n        if (delegateResult) {\n          if (delegateResult === ContinueSentinel) continue;\n          return delegateResult;\n        }\n      }\n\n      if (context.method === \"next\") {\n        // Setting context._sent for legacy support of Babel's\n        // function.sent implementation.\n        context.sent = context._sent = context.arg;\n      } else if (context.method === \"throw\") {\n        if (state === GenStateSuspendedStart) {\n          state = GenStateCompleted;\n          throw context.arg;\n        }\n\n        context.dispatchException(context.arg);\n      } else if (context.method === \"return\") {\n        context.abrupt(\"return\", context.arg);\n      }\n\n      state = GenStateExecuting;\n      var record = tryCatch(innerFn, self, context);\n\n      if (record.type === \"normal\") {\n        // If an exception is thrown from innerFn, we leave state ===\n        // GenStateExecuting and loop back for another invocation.\n        state = context.done ? GenStateCompleted : GenStateSuspendedYield;\n\n        if (record.arg === ContinueSentinel) {\n          continue;\n        }\n\n        return {\n          value: record.arg,\n          done: context.done\n        };\n      } else if (record.type === \"throw\") {\n        state = GenStateCompleted; // Dispatch the exception by looping back around to the\n        // context.dispatchException(context.arg) call above.\n\n        context.method = \"throw\";\n        context.arg = record.arg;\n      }\n    }\n  };\n} // Call delegate.iterator[context.method](context.arg) and handle the\n// result, either by returning a { value, done } result from the\n// delegate iterator, or by modifying context.method and context.arg,\n// setting context.delegate to null, and returning the ContinueSentinel.\n\n\nfunction maybeInvokeDelegate(delegate, context) {\n  var method = delegate.iterator[context.method];\n\n  if (method === undefined$1) {\n    // A .throw or .return when the delegate iterator has no .throw\n    // method always terminates the yield* loop.\n    context.delegate = null;\n\n    if (context.method === \"throw\") {\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined$1;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n\n      context.method = \"throw\";\n      context.arg = new TypeError(\"The iterator does not provide a 'throw' method\");\n    }\n\n    return ContinueSentinel;\n  }\n\n  var record = tryCatch(method, delegate.iterator, context.arg);\n\n  if (record.type === \"throw\") {\n    context.method = \"throw\";\n    context.arg = record.arg;\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  var info = record.arg;\n\n  if (!info) {\n    context.method = \"throw\";\n    context.arg = new TypeError(\"iterator result is not an object\");\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  if (info.done) {\n    // Assign the result of the finished delegate to the temporary\n    // variable specified by delegate.resultName (see delegateYield).\n    context[delegate.resultName] = info.value; // Resume execution at the desired location (see delegateYield).\n\n    context.next = delegate.nextLoc; // If context.method was \"throw\" but the delegate handled the\n    // exception, let the outer generator proceed normally. If\n    // context.method was \"next\", forget context.arg since it has been\n    // \"consumed\" by the delegate iterator. If context.method was\n    // \"return\", allow the original .return call to continue in the\n    // outer generator.\n\n    if (context.method !== \"return\") {\n      context.method = \"next\";\n      context.arg = undefined$1;\n    }\n  } else {\n    // Re-yield the result returned by the delegate method.\n    return info;\n  } // The delegate iterator is finished, so forget it and continue with\n  // the outer generator.\n\n\n  context.delegate = null;\n  return ContinueSentinel;\n} // Define Generator.prototype.{next,throw,return} in terms of the\n// unified ._invoke helper method.\n\n\ndefineIteratorMethods(Gp);\nGp[toStringTagSymbol] = \"Generator\"; // A Generator should always return itself as the iterator object when the\n// @@iterator function is called on it. Some browsers' implementations of the\n// iterator prototype chain incorrectly implement this, causing the Generator\n// object to not be returned from this call. This ensures that doesn't happen.\n// See https://github.com/facebook/regenerator/issues/274 for more details.\n\nGp[iteratorSymbol] = function () {\n  return this;\n};\n\nGp.toString = function () {\n  return \"[object Generator]\";\n};\n\nfunction pushTryEntry(locs) {\n  var entry = {\n    tryLoc: locs[0]\n  };\n\n  if (1 in locs) {\n    entry.catchLoc = locs[1];\n  }\n\n  if (2 in locs) {\n    entry.finallyLoc = locs[2];\n    entry.afterLoc = locs[3];\n  }\n\n  this.tryEntries.push(entry);\n}\n\nfunction resetTryEntry(entry) {\n  var record = entry.completion || {};\n  record.type = \"normal\";\n  delete record.arg;\n  entry.completion = record;\n}\n\nfunction Context(tryLocsList) {\n  // The root entry object (effectively a try statement without a catch\n  // or a finally block) gives us a place to store values thrown from\n  // locations where there is no enclosing try statement.\n  this.tryEntries = [{\n    tryLoc: \"root\"\n  }];\n  tryLocsList.forEach(pushTryEntry, this);\n  this.reset(true);\n}\n\nfunction keys(object) {\n  var keys = [];\n\n  for (var key in object) {\n    keys.push(key);\n  }\n\n  keys.reverse(); // Rather than returning an object with a next method, we keep\n  // things simple and return the next function itself.\n\n  return function next() {\n    while (keys.length) {\n      var key = keys.pop();\n\n      if (key in object) {\n        next.value = key;\n        next.done = false;\n        return next;\n      }\n    } // To avoid creating an additional object, we just hang the .value\n    // and .done properties off the next function object itself. This\n    // also ensures that the minifier will not anonymize the function.\n\n\n    next.done = true;\n    return next;\n  };\n}\n\nfunction values(iterable) {\n  if (iterable) {\n    var iteratorMethod = iterable[iteratorSymbol];\n\n    if (iteratorMethod) {\n      return iteratorMethod.call(iterable);\n    }\n\n    if (typeof iterable.next === \"function\") {\n      return iterable;\n    }\n\n    if (!isNaN(iterable.length)) {\n      var i = -1,\n          next = function next() {\n        while (++i < iterable.length) {\n          if (hasOwn.call(iterable, i)) {\n            next.value = iterable[i];\n            next.done = false;\n            return next;\n          }\n        }\n\n        next.value = undefined$1;\n        next.done = true;\n        return next;\n      };\n\n      return next.next = next;\n    }\n  } // Return an iterator with no values.\n\n\n  return {\n    next: doneResult\n  };\n}\n\nfunction doneResult() {\n  return {\n    value: undefined$1,\n    done: true\n  };\n}\n\nContext.prototype = {\n  constructor: Context,\n  reset: function reset(skipTempReset) {\n    this.prev = 0;\n    this.next = 0; // Resetting context._sent for legacy support of Babel's\n    // function.sent implementation.\n\n    this.sent = this._sent = undefined$1;\n    this.done = false;\n    this.delegate = null;\n    this.method = \"next\";\n    this.arg = undefined$1;\n    this.tryEntries.forEach(resetTryEntry);\n\n    if (!skipTempReset) {\n      for (var name in this) {\n        // Not sure about the optimal order of these conditions:\n        if (name.charAt(0) === \"t\" && hasOwn.call(this, name) && !isNaN(+name.slice(1))) {\n          this[name] = undefined$1;\n        }\n      }\n    }\n  },\n  stop: function stop() {\n    this.done = true;\n    var rootEntry = this.tryEntries[0];\n    var rootRecord = rootEntry.completion;\n\n    if (rootRecord.type === \"throw\") {\n      throw rootRecord.arg;\n    }\n\n    return this.rval;\n  },\n  dispatchException: function dispatchException(exception) {\n    if (this.done) {\n      throw exception;\n    }\n\n    var context = this;\n\n    function handle(loc, caught) {\n      record.type = \"throw\";\n      record.arg = exception;\n      context.next = loc;\n\n      if (caught) {\n        // If the dispatched exception was caught by a catch block,\n        // then let that catch block handle the exception normally.\n        context.method = \"next\";\n        context.arg = undefined$1;\n      }\n\n      return !!caught;\n    }\n\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n      var record = entry.completion;\n\n      if (entry.tryLoc === \"root\") {\n        // Exception thrown outside of any try block that could handle\n        // it, so set the completion value of the entire function to\n        // throw the exception.\n        return handle(\"end\");\n      }\n\n      if (entry.tryLoc <= this.prev) {\n        var hasCatch = hasOwn.call(entry, \"catchLoc\");\n        var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n        if (hasCatch && hasFinally) {\n          if (this.prev < entry.catchLoc) {\n            return handle(entry.catchLoc, true);\n          } else if (this.prev < entry.finallyLoc) {\n            return handle(entry.finallyLoc);\n          }\n        } else if (hasCatch) {\n          if (this.prev < entry.catchLoc) {\n            return handle(entry.catchLoc, true);\n          }\n        } else if (hasFinally) {\n          if (this.prev < entry.finallyLoc) {\n            return handle(entry.finallyLoc);\n          }\n        } else {\n          throw new Error(\"try statement without catch or finally\");\n        }\n      }\n    }\n  },\n  abrupt: function abrupt(type, arg) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n\n      if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) {\n        var finallyEntry = entry;\n        break;\n      }\n    }\n\n    if (finallyEntry && (type === \"break\" || type === \"continue\") && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc) {\n      // Ignore the finally entry if control is not jumping to a\n      // location outside the try/catch block.\n      finallyEntry = null;\n    }\n\n    var record = finallyEntry ? finallyEntry.completion : {};\n    record.type = type;\n    record.arg = arg;\n\n    if (finallyEntry) {\n      this.method = \"next\";\n      this.next = finallyEntry.finallyLoc;\n      return ContinueSentinel;\n    }\n\n    return this.complete(record);\n  },\n  complete: function complete(record, afterLoc) {\n    if (record.type === \"throw\") {\n      throw record.arg;\n    }\n\n    if (record.type === \"break\" || record.type === \"continue\") {\n      this.next = record.arg;\n    } else if (record.type === \"return\") {\n      this.rval = this.arg = record.arg;\n      this.method = \"return\";\n      this.next = \"end\";\n    } else if (record.type === \"normal\" && afterLoc) {\n      this.next = afterLoc;\n    }\n\n    return ContinueSentinel;\n  },\n  finish: function finish(finallyLoc) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n\n      if (entry.finallyLoc === finallyLoc) {\n        this.complete(entry.completion, entry.afterLoc);\n        resetTryEntry(entry);\n        return ContinueSentinel;\n      }\n    }\n  },\n  \"catch\": function _catch(tryLoc) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n\n      if (entry.tryLoc === tryLoc) {\n        var record = entry.completion;\n\n        if (record.type === \"throw\") {\n          var thrown = record.arg;\n          resetTryEntry(entry);\n        }\n\n        return thrown;\n      }\n    } // The context.catch method must only be called with a location\n    // argument that corresponds to a known catch block.\n\n\n    throw new Error(\"illegal catch attempt\");\n  },\n  delegateYield: function delegateYield(iterable, resultName, nextLoc) {\n    this.delegate = {\n      iterator: values(iterable),\n      resultName: resultName,\n      nextLoc: nextLoc\n    };\n\n    if (this.method === \"next\") {\n      // Deliberately forget the last sent value so that we don't\n      // accidentally pass it on to the delegate.\n      this.arg = undefined$1;\n    }\n\n    return ContinueSentinel;\n  }\n}; // Export a default namespace that plays well with Rollup\n\nvar _regeneratorRuntime = {\n  wrap,\n  isGeneratorFunction,\n  AsyncIterator,\n  mark,\n  awrap,\n  async,\n  keys,\n  values\n};\n/**\n * Open editor url in a new window, and pass a message.\n */\n\nfunction post(window, url, data) {\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  var editor = window.open(url);\n  var wait = 10000;\n  var step = 250;\n\n  var _URL = new URL(url),\n      origin = _URL.origin; // eslint-disable-next-line no-bitwise\n\n\n  var count = ~~(wait / step);\n\n  function listen(evt) {\n    if (evt.source === editor) {\n      count = 0;\n      window.removeEventListener('message', listen, false);\n    }\n  }\n\n  window.addEventListener('message', listen, false); // send message\n  // periodically resend until ack received or timeout\n\n  function send() {\n    if (count <= 0) {\n      return;\n    }\n\n    editor.postMessage(data, origin);\n    setTimeout(send, step);\n    count -= 1;\n  }\n\n  setTimeout(send, step);\n} // generated with build-style.sh\n\n\nvar embedStyle = \".vega-embed {\\n  position: relative;\\n  display: inline-block;\\n  box-sizing: border-box; }\\n  .vega-embed.has-actions {\\n    padding-right: 38px; }\\n  .vega-embed details:not([open]) > :not(summary) {\\n    display: none !important; }\\n  .vega-embed summary {\\n    list-style: none;\\n    position: absolute;\\n    top: 0;\\n    right: 0;\\n    padding: 6px;\\n    z-index: 1000;\\n    background: white;\\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\\n    color: #1b1e23;\\n    border: 1px solid #aaa;\\n    border-radius: 999px;\\n    opacity: 0.2;\\n    transition: opacity 0.4s ease-in;\\n    outline: none;\\n    cursor: pointer;\\n    line-height: 0px; }\\n    .vega-embed summary::-webkit-details-marker {\\n      display: none; }\\n    .vega-embed summary:active {\\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\\n    .vega-embed summary svg {\\n      width: 14px;\\n      height: 14px; }\\n  .vega-embed details[open] summary {\\n    opacity: 0.7; }\\n  .vega-embed:hover summary,\\n  .vega-embed:focus summary {\\n    opacity: 1 !important;\\n    transition: opacity 0.2s ease; }\\n  .vega-embed .vega-actions {\\n    position: absolute;\\n    z-index: 1001;\\n    top: 35px;\\n    right: -9px;\\n    display: flex;\\n    flex-direction: column;\\n    padding-bottom: 8px;\\n    padding-top: 8px;\\n    border-radius: 4px;\\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\\n    border: 1px solid #d9d9d9;\\n    background: white;\\n    animation-duration: 0.15s;\\n    animation-name: scale-in;\\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\\n    text-align: left; }\\n    .vega-embed .vega-actions a {\\n      padding: 8px 16px;\\n      font-family: sans-serif;\\n      font-size: 14px;\\n      font-weight: 600;\\n      white-space: nowrap;\\n      color: #434a56;\\n      text-decoration: none; }\\n      .vega-embed .vega-actions a:hover {\\n        background-color: #f7f7f9;\\n        color: black; }\\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\\n      content: \\\"\\\";\\n      display: inline-block;\\n      position: absolute; }\\n    .vega-embed .vega-actions::before {\\n      left: auto;\\n      right: 14px;\\n      top: -16px;\\n      border: 8px solid #0000;\\n      border-bottom-color: #d9d9d9; }\\n    .vega-embed .vega-actions::after {\\n      left: auto;\\n      right: 15px;\\n      top: -14px;\\n      border: 7px solid #0000;\\n      border-bottom-color: #fff; }\\n  .vega-embed .chart-wrapper.fit-x {\\n    width: 100%; }\\n  .vega-embed .chart-wrapper.fit-y {\\n    height: 100%; }\\n\\n.vega-embed-wrapper {\\n  max-width: 100%;\\n  overflow: auto;\\n  padding-right: 14px; }\\n\\n@keyframes scale-in {\\n  from {\\n    opacity: 0;\\n    transform: scale(0.6); }\\n  to {\\n    opacity: 1;\\n    transform: scale(1); } }\\n\";\n\nif (!String.prototype.startsWith) {\n  // eslint-disable-next-line no-extend-native,func-names\n  String.prototype.startsWith = function (search, pos) {\n    return this.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n  };\n}\n\nfunction mergeDeep(dest) {\n  for (var _len = arguments.length, src = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    src[_key - 1] = arguments[_key];\n  }\n\n  for (var _i = 0, _src = src; _i < _src.length; _i++) {\n    var s = _src[_i];\n    deepMerge_(dest, s);\n  }\n\n  return dest;\n}\n\nfunction deepMerge_(dest, src) {\n  for (var _i2 = 0, _Object$keys = Object.keys(src); _i2 < _Object$keys.length; _i2++) {\n    var property = _Object$keys[_i2];\n    writeConfig(dest, property, src[property], true);\n  }\n}\n\nvar name = \"vega-embed\";\nvar version$1 = \"6.20.0\";\nvar description = \"Publish Vega visualizations as embedded web components.\";\nvar keywords = [\"vega\", \"data\", \"visualization\", \"component\", \"embed\"];\nvar repository = {\n  type: \"git\",\n  url: \"http://github.com/vega/vega-embed.git\"\n};\nvar author = {\n  name: \"UW Interactive Data Lab\",\n  url: \"http://idl.cs.washington.edu\"\n};\nvar contributors = [{\n  name: \"Dominik Moritz\",\n  url: \"https://www.domoritz.de\"\n}];\nvar bugs = {\n  url: \"https://github.com/vega/vega-embed/issues\"\n};\nvar homepage = \"https://github.com/vega/vega-embed#readme\";\nvar license = \"BSD-3-Clause\";\nvar main = \"build/vega-embed.js\";\nvar module = \"build/vega-embed.module.js\";\nvar unpkg = \"build/vega-embed.min.js\";\nvar jsdelivr = \"build/vega-embed.min.js\";\nvar types = \"build/vega-embed.module.d.ts\";\nvar files = [\"src\", \"build\", \"build-es5\"];\nvar devDependencies = {\n  \"@auto-it/conventional-commits\": \"^10.32.0\",\n  \"@auto-it/first-time-contributor\": \"^10.32.0\",\n  \"@rollup/plugin-commonjs\": \"21.0.1\",\n  \"@rollup/plugin-json\": \"^4.1.0\",\n  \"@rollup/plugin-node-resolve\": \"^13.0.4\",\n  \"@types/semver\": \"^7.3.8\",\n  \"@wessberg/rollup-plugin-ts\": \"^1.3.14\",\n  auto: \"^10.32.0\",\n  \"browser-sync\": \"^2.27.5\",\n  concurrently: \"^6.2.1\",\n  \"del-cli\": \"^4.0.1\",\n  \"jest-canvas-mock\": \"^2.3.1\",\n  \"node-sass\": \"^6.0.1\",\n  \"rollup-plugin-bundle-size\": \"^1.0.3\",\n  \"rollup-plugin-terser\": \"^7.0.2\",\n  rollup: \"2.58.1\",\n  typescript: \"^4.4.3\",\n  \"vega-lite-dev-config\": \"^0.18.0\",\n  \"vega-lite\": \"^5.0.0\",\n  vega: \"^5.19.1\"\n};\nvar peerDependencies = {\n  vega: \"^5.20.2\",\n  \"vega-lite\": \"*\"\n};\nvar dependencies = {\n  \"fast-json-patch\": \"^3.1.0\",\n  \"json-stringify-pretty-compact\": \"^3.0.0\",\n  semver: \"^7.3.5\",\n  tslib: \"^2.3.1\",\n  \"vega-interpreter\": \"^1.0.4\",\n  \"vega-schema-url-parser\": \"^2.2.0\",\n  \"vega-themes\": \"^2.10.0\",\n  \"vega-tooltip\": \"^0.27.0\"\n};\nvar scripts = {\n  prebuild: \"yarn clean && yarn build:style\",\n  build: \"rollup -c\",\n  \"build:style\": \"./build-style.sh\",\n  clean: \"del-cli build build-es5 src/style.ts\",\n  prepublishOnly: \"yarn clean && yarn build\",\n  preversion: \"yarn lint && yarn test\",\n  serve: \"browser-sync start --directory -s -f build *.html\",\n  start: \"yarn build && concurrently --kill-others -n Server,Rollup 'yarn serve' 'rollup -c -w'\",\n  pretest: \"yarn build:style\",\n  test: \"beemo jest --stdio stream\",\n  \"test:inspect\": \"node --inspect-brk ./node_modules/.bin/jest --runInBand\",\n  prepare: \"beemo create-config\",\n  prettierbase: \"beemo prettier '*.{css,scss,html}'\",\n  eslintbase: \"beemo eslint .\",\n  format: \"yarn eslintbase --fix && yarn prettierbase --write\",\n  lint: \"yarn eslintbase && yarn prettierbase --check\",\n  release: \"auto shipit\"\n};\nvar pkg = {\n  name: name,\n  version: version$1,\n  description: description,\n  keywords: keywords,\n  repository: repository,\n  author: author,\n  contributors: contributors,\n  bugs: bugs,\n  homepage: homepage,\n  license: license,\n  main: main,\n  module: module,\n  unpkg: unpkg,\n  jsdelivr: jsdelivr,\n  types: types,\n  files: files,\n  devDependencies: devDependencies,\n  peerDependencies: peerDependencies,\n  dependencies: dependencies,\n  scripts: scripts\n};\n\nvar _w$vl;\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar version = pkg.version;\nvar vega = vegaImport;\nvar _vegaLite = vegaLiteImport; // For backwards compatibility with Vega-Lite before v4.\n\nvar w = typeof window !== 'undefined' ? window : undefined;\n\nif (_vegaLite === undefined && w !== null && w !== void 0 && (_w$vl = w['vl']) !== null && _w$vl !== void 0 && _w$vl.compile) {\n  _vegaLite = w['vl'];\n}\n\nvar DEFAULT_ACTIONS = {\n  export: {\n    svg: true,\n    png: true\n  },\n  source: true,\n  compiled: true,\n  editor: true\n};\nvar I18N = {\n  CLICK_TO_VIEW_ACTIONS: 'Click to view actions',\n  COMPILED_ACTION: 'View Compiled Vega',\n  EDITOR_ACTION: 'Open in Vega Editor',\n  PNG_ACTION: 'Save as PNG',\n  SOURCE_ACTION: 'View Source',\n  SVG_ACTION: 'Save as SVG'\n};\nvar NAMES = {\n  vega: 'Vega',\n  'vega-lite': 'Vega-Lite'\n};\nvar VERSION = {\n  vega: vega.version,\n  'vega-lite': _vegaLite ? _vegaLite.version : 'not available'\n};\nvar PREPROCESSOR = {\n  vega: vgSpec => vgSpec,\n  'vega-lite': (vlSpec, config) => _vegaLite.compile(vlSpec, {\n    config: config\n  }).spec\n};\nvar SVG_CIRCLES = \"\\n<svg viewBox=\\\"0 0 16 16\\\" fill=\\\"currentColor\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\">\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"2\\\"></circle>\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"8\\\"></circle>\\n  <circle r=\\\"2\\\" cy=\\\"8\\\" cx=\\\"14\\\"></circle>\\n</svg>\";\nvar CHART_WRAPPER_CLASS = 'chart-wrapper';\n\nfunction isTooltipHandler(h) {\n  return typeof h === 'function';\n}\n\nfunction viewSource(source, sourceHeader, sourceFooter, mode) {\n  var header = \"<html><head>\".concat(sourceHeader, \"</head><body><pre><code class=\\\"json\\\">\");\n  var footer = \"</code></pre>\".concat(sourceFooter, \"</body></html>\"); // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\n  var win = window.open('');\n  win.document.write(header + source + footer);\n  win.document.title = \"\".concat(NAMES[mode], \" JSON Source\");\n}\n/**\n * Try to guess the type of spec.\n *\n * @param spec Vega or Vega-Lite spec.\n */\n\n\nfunction guessMode(spec, providedMode) {\n  // Decide mode\n  if (spec.$schema) {\n    var parsed = schemaParser(spec.$schema);\n\n    if (providedMode && providedMode !== parsed.library) {\n      var _NAMES$providedMode;\n\n      console.warn(\"The given visualization spec is written in \".concat(NAMES[parsed.library], \", but mode argument sets \").concat((_NAMES$providedMode = NAMES[providedMode]) !== null && _NAMES$providedMode !== void 0 ? _NAMES$providedMode : providedMode, \".\"));\n    }\n\n    var mode = parsed.library;\n\n    if (!satisfies(VERSION[mode], \"^\".concat(parsed.version.slice(1)))) {\n      console.warn(\"The input spec uses \".concat(NAMES[mode], \" \").concat(parsed.version, \", but the current version of \").concat(NAMES[mode], \" is v\").concat(VERSION[mode], \".\"));\n    }\n\n    return mode;\n  } // try to guess from the provided spec\n\n\n  if ('mark' in spec || 'encoding' in spec || 'layer' in spec || 'hconcat' in spec || 'vconcat' in spec || 'facet' in spec || 'repeat' in spec) {\n    return 'vega-lite';\n  }\n\n  if ('marks' in spec || 'signals' in spec || 'scales' in spec || 'axes' in spec) {\n    return 'vega';\n  }\n\n  return providedMode !== null && providedMode !== void 0 ? providedMode : 'vega';\n}\n\nfunction isLoader(o) {\n  return !!(o && 'load' in o);\n}\n\nfunction createLoader(opts) {\n  return isLoader(opts) ? opts : vega.loader(opts);\n}\n\nfunction embedOptionsFromUsermeta(parsedSpec) {\n  var _ref;\n\n  return (_ref = parsedSpec.usermeta && parsedSpec.usermeta['embedOptions']) !== null && _ref !== void 0 ? _ref : {};\n}\n/**\n * Embed a Vega visualization component in a web page. This function returns a promise.\n *\n * @param el        DOM element in which to place component (DOM node or CSS selector).\n * @param spec      String : A URL string from which to load the Vega specification.\n *                  Object : The Vega/Vega-Lite specification as a parsed JSON object.\n * @param opts       A JavaScript object containing options for embedding.\n */\n\n\nfunction embed(_x, _x2) {\n  return _embed2.apply(this, arguments);\n}\n\nfunction _embed2() {\n  _embed2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(el, spec) {\n    var _parsedOpts$config, _usermetaOpts$config;\n\n    var opts,\n        parsedSpec,\n        loader,\n        usermetaLoader,\n        _opts$loader,\n        usermetaOpts,\n        parsedOpts,\n        mergedOpts,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            opts = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n\n            if (!isString(spec)) {\n              _context.next = 10;\n              break;\n            }\n\n            loader = createLoader(opts.loader);\n            _context.t0 = JSON;\n            _context.next = 6;\n            return loader.load(spec);\n\n          case 6:\n            _context.t1 = _context.sent;\n            parsedSpec = _context.t0.parse.call(_context.t0, _context.t1);\n            _context.next = 11;\n            break;\n\n          case 10:\n            parsedSpec = spec;\n\n          case 11:\n            usermetaLoader = embedOptionsFromUsermeta(parsedSpec).loader; // either create the loader for the first time or create a new loader if the spec has new loader options\n\n            if (!loader || usermetaLoader) {\n              loader = createLoader((_opts$loader = opts.loader) !== null && _opts$loader !== void 0 ? _opts$loader : usermetaLoader);\n            }\n\n            _context.next = 15;\n            return loadOpts(embedOptionsFromUsermeta(parsedSpec), loader);\n\n          case 15:\n            usermetaOpts = _context.sent;\n            _context.next = 18;\n            return loadOpts(opts, loader);\n\n          case 18:\n            parsedOpts = _context.sent;\n            mergedOpts = _objectSpread(_objectSpread({}, mergeDeep(parsedOpts, usermetaOpts)), {}, {\n              config: mergeConfig((_parsedOpts$config = parsedOpts.config) !== null && _parsedOpts$config !== void 0 ? _parsedOpts$config : {}, (_usermetaOpts$config = usermetaOpts.config) !== null && _usermetaOpts$config !== void 0 ? _usermetaOpts$config : {})\n            });\n            _context.next = 22;\n            return _embed(el, parsedSpec, mergedOpts, loader);\n\n          case 22:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 23:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _embed2.apply(this, arguments);\n}\n\nfunction loadOpts(_x3, _x4) {\n  return _loadOpts.apply(this, arguments);\n}\n\nfunction _loadOpts() {\n  _loadOpts = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(opt, loader) {\n    var _opt$config;\n\n    var config, patch;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!isString(opt.config)) {\n              _context2.next = 8;\n              break;\n            }\n\n            _context2.t1 = JSON;\n            _context2.next = 4;\n            return loader.load(opt.config);\n\n          case 4:\n            _context2.t2 = _context2.sent;\n            _context2.t0 = _context2.t1.parse.call(_context2.t1, _context2.t2);\n            _context2.next = 9;\n            break;\n\n          case 8:\n            _context2.t0 = (_opt$config = opt.config) !== null && _opt$config !== void 0 ? _opt$config : {};\n\n          case 9:\n            config = _context2.t0;\n\n            if (!isString(opt.patch)) {\n              _context2.next = 18;\n              break;\n            }\n\n            _context2.t4 = JSON;\n            _context2.next = 14;\n            return loader.load(opt.patch);\n\n          case 14:\n            _context2.t5 = _context2.sent;\n            _context2.t3 = _context2.t4.parse.call(_context2.t4, _context2.t5);\n            _context2.next = 19;\n            break;\n\n          case 18:\n            _context2.t3 = opt.patch;\n\n          case 19:\n            patch = _context2.t3;\n            return _context2.abrupt(\"return\", _objectSpread(_objectSpread(_objectSpread({}, opt), patch ? {\n              patch\n            } : {}), config ? {\n              config\n            } : {}));\n\n          case 21:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _loadOpts.apply(this, arguments);\n}\n\nfunction getRoot(el) {\n  var possibleRoot = el.getRootNode ? el.getRootNode() : document;\n\n  if (possibleRoot instanceof ShadowRoot) {\n    return {\n      root: possibleRoot,\n      rootContainer: possibleRoot\n    };\n  } else {\n    var _document$head;\n\n    return {\n      root: document,\n      rootContainer: (_document$head = document.head) !== null && _document$head !== void 0 ? _document$head : document.body\n    };\n  }\n}\n\nfunction _embed(_x5, _x6) {\n  return _embed3.apply(this, arguments);\n}\n\nfunction _embed3() {\n  _embed3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(el, spec) {\n    var _opts$config, _opts$actions, _opts$renderer, _opts$logLevel, _opts$downloadFileNam, _ref2, _vega$expressionInter;\n\n    var opts,\n        loader,\n        config,\n        actions,\n        i18n,\n        renderer,\n        logLevel,\n        downloadFileName,\n        element,\n        ID,\n        _getRoot,\n        root,\n        rootContainer,\n        style,\n        mode,\n        vgSpec,\n        parsed,\n        container,\n        chartWrapper,\n        patch,\n        ast,\n        runtime,\n        view,\n        handler,\n        hover,\n        _ref3,\n        hoverSet,\n        updateSet,\n        documentClickHandler,\n        wrapper,\n        details,\n        summary,\n        ctrl,\n        _loop,\n        _i,\n        _arr,\n        viewSourceLink,\n        compileLink,\n        _opts$editorUrl,\n        editorUrl,\n        editorLink,\n        finalize,\n        _args4 = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            finalize = function _finalize() {\n              if (documentClickHandler) {\n                document.removeEventListener('click', documentClickHandler);\n              }\n\n              view.finalize();\n            };\n\n            opts = _args4.length > 2 && _args4[2] !== undefined ? _args4[2] : {};\n            loader = _args4.length > 3 ? _args4[3] : undefined;\n            config = opts.theme ? mergeConfig(themes[opts.theme], (_opts$config = opts.config) !== null && _opts$config !== void 0 ? _opts$config : {}) : opts.config;\n            actions = isBoolean(opts.actions) ? opts.actions : mergeDeep({}, DEFAULT_ACTIONS, (_opts$actions = opts.actions) !== null && _opts$actions !== void 0 ? _opts$actions : {});\n            i18n = _objectSpread(_objectSpread({}, I18N), opts.i18n);\n            renderer = (_opts$renderer = opts.renderer) !== null && _opts$renderer !== void 0 ? _opts$renderer : 'canvas';\n            logLevel = (_opts$logLevel = opts.logLevel) !== null && _opts$logLevel !== void 0 ? _opts$logLevel : vega.Warn;\n            downloadFileName = (_opts$downloadFileNam = opts.downloadFileName) !== null && _opts$downloadFileNam !== void 0 ? _opts$downloadFileNam : 'visualization';\n            element = typeof el === 'string' ? document.querySelector(el) : el;\n\n            if (element) {\n              _context4.next = 12;\n              break;\n            }\n\n            throw new Error(\"\".concat(el, \" does not exist\"));\n\n          case 12:\n            if (opts.defaultStyle !== false) {\n              // Add a default stylesheet to the head of the document.\n              ID = 'vega-embed-style';\n              _getRoot = getRoot(element), root = _getRoot.root, rootContainer = _getRoot.rootContainer;\n\n              if (!root.getElementById(ID)) {\n                style = document.createElement('style');\n                style.id = ID;\n                style.innerText = opts.defaultStyle === undefined || opts.defaultStyle === true ? embedStyle.toString() : opts.defaultStyle;\n                rootContainer.appendChild(style);\n              }\n            }\n\n            mode = guessMode(spec, opts.mode);\n            vgSpec = PREPROCESSOR[mode](spec, config);\n\n            if (mode === 'vega-lite') {\n              if (vgSpec.$schema) {\n                parsed = schemaParser(vgSpec.$schema);\n\n                if (!satisfies(VERSION.vega, \"^\".concat(parsed.version.slice(1)))) {\n                  console.warn(\"The compiled spec uses Vega \".concat(parsed.version, \", but current version is v\").concat(VERSION.vega, \".\"));\n                }\n              }\n            }\n\n            element.classList.add('vega-embed');\n\n            if (actions) {\n              element.classList.add('has-actions');\n            }\n\n            element.innerHTML = ''; // clear container\n\n            container = element;\n\n            if (actions) {\n              chartWrapper = document.createElement('div');\n              chartWrapper.classList.add(CHART_WRAPPER_CLASS);\n              element.appendChild(chartWrapper);\n              container = chartWrapper;\n            }\n\n            patch = opts.patch;\n\n            if (patch) {\n              if (patch instanceof Function) {\n                vgSpec = patch(vgSpec);\n              } else {\n                vgSpec = applyPatch(vgSpec, patch, true, false).newDocument;\n              }\n            } // Set locale. Note that this is a global setting.\n\n\n            if (opts.formatLocale) {\n              vega.formatLocale(opts.formatLocale);\n            }\n\n            if (opts.timeFormatLocale) {\n              vega.timeFormatLocale(opts.timeFormatLocale);\n            }\n\n            ast = opts.ast; // Do not apply the config to Vega when we have already applied it to Vega-Lite.\n            // This call may throw an Error if parsing fails.\n\n            runtime = vega.parse(vgSpec, mode === 'vega-lite' ? {} : config, {\n              ast\n            });\n            view = new (opts.viewClass || vega.View)(runtime, _objectSpread({\n              loader,\n              logLevel,\n              renderer\n            }, ast ? {\n              expr: (_ref2 = (_vega$expressionInter = vega.expressionInterpreter) !== null && _vega$expressionInter !== void 0 ? _vega$expressionInter : opts.expr) !== null && _ref2 !== void 0 ? _ref2 : expressionInterpreter\n            } : {}));\n            view.addSignalListener('autosize', (_, autosize) => {\n              var type = autosize.type;\n\n              if (type == 'fit-x') {\n                container.classList.add('fit-x');\n                container.classList.remove('fit-y');\n              } else if (type == 'fit-y') {\n                container.classList.remove('fit-x');\n                container.classList.add('fit-y');\n              } else if (type == 'fit') {\n                container.classList.add('fit-x', 'fit-y');\n              } else {\n                container.classList.remove('fit-x', 'fit-y');\n              }\n            });\n\n            if (opts.tooltip !== false) {\n              if (isTooltipHandler(opts.tooltip)) {\n                handler = opts.tooltip;\n              } else {\n                // user provided boolean true or tooltip options\n                handler = new Handler(opts.tooltip === true ? {} : opts.tooltip).call;\n              }\n\n              view.tooltip(handler);\n            }\n\n            hover = opts.hover;\n\n            if (hover === undefined) {\n              hover = mode === 'vega';\n            }\n\n            if (hover) {\n              _ref3 = typeof hover === 'boolean' ? {} : hover, hoverSet = _ref3.hoverSet, updateSet = _ref3.updateSet;\n              view.hover(hoverSet, updateSet);\n            }\n\n            if (opts) {\n              if (opts.width != null) {\n                view.width(opts.width);\n              }\n\n              if (opts.height != null) {\n                view.height(opts.height);\n              }\n\n              if (opts.padding != null) {\n                view.padding(opts.padding);\n              }\n            }\n\n            _context4.next = 36;\n            return view.initialize(container, opts.bind).runAsync();\n\n          case 36:\n            if (actions !== false) {\n              wrapper = element;\n\n              if (opts.defaultStyle !== false) {\n                details = document.createElement('details');\n                details.title = i18n.CLICK_TO_VIEW_ACTIONS;\n                element.append(details);\n                wrapper = details;\n                summary = document.createElement('summary');\n                summary.innerHTML = SVG_CIRCLES;\n                details.append(summary);\n\n                documentClickHandler = ev => {\n                  if (!details.contains(ev.target)) {\n                    details.removeAttribute('open');\n                  }\n                };\n\n                document.addEventListener('click', documentClickHandler);\n              }\n\n              ctrl = document.createElement('div');\n              wrapper.append(ctrl);\n              ctrl.classList.add('vega-actions'); // add 'Export' action\n\n              if (actions === true || actions.export !== false) {\n                _loop = function _loop() {\n                  var ext = _arr[_i];\n\n                  if (actions === true || actions.export === true || actions.export[ext]) {\n                    var i18nExportAction = i18n[\"\".concat(ext.toUpperCase(), \"_ACTION\")];\n                    var exportLink = document.createElement('a');\n                    exportLink.text = i18nExportAction;\n                    exportLink.href = '#';\n                    exportLink.target = '_blank';\n                    exportLink.download = \"\".concat(downloadFileName, \".\").concat(ext); // add link on mousedown so that it's correct when the click happens\n\n                    exportLink.addEventListener('mousedown', /*#__PURE__*/function () {\n                      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n                        var url;\n                        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                          while (1) {\n                            switch (_context3.prev = _context3.next) {\n                              case 0:\n                                e.preventDefault();\n                                _context3.next = 3;\n                                return view.toImageURL(ext, opts.scaleFactor);\n\n                              case 3:\n                                url = _context3.sent;\n                                this.href = url;\n\n                              case 5:\n                              case \"end\":\n                                return _context3.stop();\n                            }\n                          }\n                        }, _callee3, this);\n                      }));\n\n                      return function (_x7) {\n                        return _ref4.apply(this, arguments);\n                      };\n                    }());\n                    ctrl.append(exportLink);\n                  }\n                };\n\n                for (_i = 0, _arr = ['svg', 'png']; _i < _arr.length; _i++) {\n                  _loop();\n                }\n              } // add 'View Source' action\n\n\n              if (actions === true || actions.source !== false) {\n                viewSourceLink = document.createElement('a');\n                viewSourceLink.text = i18n.SOURCE_ACTION;\n                viewSourceLink.href = '#';\n                viewSourceLink.addEventListener('click', function (e) {\n                  var _opts$sourceHeader, _opts$sourceFooter;\n\n                  viewSource(stringify(spec), (_opts$sourceHeader = opts.sourceHeader) !== null && _opts$sourceHeader !== void 0 ? _opts$sourceHeader : '', (_opts$sourceFooter = opts.sourceFooter) !== null && _opts$sourceFooter !== void 0 ? _opts$sourceFooter : '', mode);\n                  e.preventDefault();\n                });\n                ctrl.append(viewSourceLink);\n              } // add 'View Compiled' action\n\n\n              if (mode === 'vega-lite' && (actions === true || actions.compiled !== false)) {\n                compileLink = document.createElement('a');\n                compileLink.text = i18n.COMPILED_ACTION;\n                compileLink.href = '#';\n                compileLink.addEventListener('click', function (e) {\n                  var _opts$sourceHeader2, _opts$sourceFooter2;\n\n                  viewSource(stringify(vgSpec), (_opts$sourceHeader2 = opts.sourceHeader) !== null && _opts$sourceHeader2 !== void 0 ? _opts$sourceHeader2 : '', (_opts$sourceFooter2 = opts.sourceFooter) !== null && _opts$sourceFooter2 !== void 0 ? _opts$sourceFooter2 : '', 'vega');\n                  e.preventDefault();\n                });\n                ctrl.append(compileLink);\n              } // add 'Open in Vega Editor' action\n\n\n              if (actions === true || actions.editor !== false) {\n                editorUrl = (_opts$editorUrl = opts.editorUrl) !== null && _opts$editorUrl !== void 0 ? _opts$editorUrl : 'https://vega.github.io/editor/';\n                editorLink = document.createElement('a');\n                editorLink.text = i18n.EDITOR_ACTION;\n                editorLink.href = '#';\n                editorLink.addEventListener('click', function (e) {\n                  post(window, editorUrl, {\n                    config: config,\n                    mode,\n                    renderer,\n                    spec: stringify(spec)\n                  });\n                  e.preventDefault();\n                });\n                ctrl.append(editorLink);\n              }\n            }\n\n            return _context4.abrupt(\"return\", {\n              view,\n              spec,\n              vgSpec,\n              finalize\n            });\n\n          case 38:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _embed3.apply(this, arguments);\n}\n\nexport { DEFAULT_ACTIONS, embed as default, guessMode, vega, _vegaLite as vegaLite, version };","map":{"version":3,"sources":["../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","../node_modules/@babel/runtime/regenerator/index.js","../src/post.ts","../src/style.ts","../src/util.ts","../src/embed.ts"],"names":["Op","Object","hasOwn","$Symbol","iteratorSymbol","asyncIteratorSymbol","toStringTagSymbol","protoGenerator","outerFn","generator","context","tryLocsList","makeInvokeMethod","type","arg","fn","err","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","IteratorPrototype","getProto","NativeIteratorPrototype","values","Gp","GeneratorFunctionPrototype","Generator","GeneratorFunction","prototype","ctor","genFun","__await","record","tryCatch","reject","result","value","invoke","resolve","previousPromise","callInvokeWithMethodAndArg","defineIteratorMethods","AsyncIterator","PromiseImpl","iter","wrap","state","method","doneResult","delegate","delegateResult","maybeInvokeDelegate","done","info","entry","tryLoc","locs","keys","key","next","iteratorMethod","iterable","isNaN","i","Context","constructor","reset","name","stop","rootEntry","rootRecord","dispatchException","handle","hasCatch","hasFinally","abrupt","finallyEntry","complete","finish","resetTryEntry","thrown","delegateYield","iterator","resultName","nextLoc"],"mappings":";;;;;;;;;;;AAAe,SAAS,eAAT,CAAyB,GAAzB,EAA8B,GAA9B,EAAmC,KAAnC,EAA0C;AACvD,MAAI,GAAG,IAAI,GAAX,EAAgB;AACd,IAAA,MAAM,CAAC,cAAP,CAAsB,GAAtB,EAA2B,GAA3B,EAAgC;AAC9B,MAAA,KAAK,EAAE,KADuB;AAE9B,MAAA,UAAU,EAAE,IAFkB;AAG9B,MAAA,YAAY,EAAE,IAHgB;AAI9B,MAAA,QAAQ,EAAE;AAJoB,KAAhC;AAMD,GAPD,MAOO;AACL,IAAA,GAAG,CAAC,GAAD,CAAH,GAAW,KAAX;AACD;;AAED,SAAO,GAAP;AACF;;ACbA,SAAS,kBAAT,CAA4B,GAA5B,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,KAAlD,EAAyD,MAAzD,EAAiE,GAAjE,EAAsE,GAAtE,EAA2E;AACzE,MAAI;AACF,QAAI,IAAI,GAAG,GAAG,CAAC,GAAD,CAAH,CAAS,GAAT,CAAX;AACA,QAAI,KAAK,GAAG,IAAI,CAAC,KAAjB;AACD,GAHD,CAGE,OAAO,KAAP,EAAc;AACd,IAAA,MAAM,CAAC,KAAD,CAAN;AACA;AACD;;AAED,MAAI,IAAI,CAAC,IAAT,EAAe;AACb,IAAA,OAAO,CAAC,KAAD,CAAP;AACD,GAFD,MAEO;AACL,IAAA,OAAO,CAAC,OAAR,CAAgB,KAAhB,EAAuB,IAAvB,CAA4B,KAA5B,EAAmC,MAAnC;AACD;AACF;;AAEc,SAAS,iBAAT,CAA2B,EAA3B,EAA+B;AAC5C,SAAO,YAAY;AACjB,QAAI,IAAI,GAAG,IAAX;AAAA,QACI,IAAI,GAAG,SADX;AAEA,WAAO,IAAI,OAAJ,CAAY,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AAC5C,UAAI,GAAG,GAAG,EAAE,CAAC,KAAH,CAAS,IAAT,EAAe,IAAf,CAAV;;AAEA,eAAS,KAAT,CAAe,KAAf,EAAsB;AACpB,QAAA,kBAAkB,CAAC,GAAD,EAAM,OAAN,EAAe,MAAf,EAAuB,KAAvB,EAA8B,MAA9B,EAAsC,MAAtC,EAA8C,KAA9C,CAAlB;AACD;;AAED,eAAS,MAAT,CAAgB,GAAhB,EAAqB;AACnB,QAAA,kBAAkB,CAAC,GAAD,EAAM,OAAN,EAAe,MAAf,EAAuB,KAAvB,EAA8B,MAA9B,EAAsC,OAAtC,EAA+C,GAA/C,CAAlB;AACD;;AAED,MAAA,KAAK,CAAC,SAAD,CAAL;AACD,KAZM,CAAP;AAaD,GAhBD;AAiBF;AClCA;;;;;;;;AAQA,IAAIA,EAAE,GAAGC,MAAM,CAAf,SAAA;AACA,IAAIC,MAAM,GAAGF,EAAE,CAAf,cAAA;AACA,IAAA,WAAA,C,CAAA;;AACA,IAAIG,OAAO,GAAG,OAAA,MAAA,KAAA,UAAA,GAAA,MAAA,GAAd,EAAA;AACA,IAAIC,cAAc,GAAGD,OAAO,CAAPA,QAAAA,IAArB,YAAA;AACA,IAAIE,mBAAmB,GAAGF,OAAO,CAAPA,aAAAA,IAA1B,iBAAA;AACA,IAAIG,iBAAiB,GAAGH,OAAO,CAAPA,WAAAA,IAAxB,eAAA;;AAEA,SAAA,IAAA,CAAA,OAAA,EAAA,OAAA,EAAA,IAAA,EAAA,WAAA,EAAmD;AACjD;AACA,MAAII,cAAc,GAAGC,OAAO,IAAIA,OAAO,CAAPA,SAAAA,YAAXA,SAAAA,GAAAA,OAAAA,GAArB,SAAA;AACA,MAAIC,SAAS,GAAGR,MAAM,CAANA,MAAAA,CAAcM,cAAc,CAA5C,SAAgBN,CAAhB;AACA,MAAIS,OAAO,GAAG,IAAA,OAAA,CAAYC,WAAW,IAJY,EAInC,CAAd,CAJiD,CAAA;AAOjD;;AACAF,EAAAA,SAAS,CAATA,OAAAA,GAAoBG,gBAAgB,CAAA,OAAA,EAAA,IAAA,EAApCH,OAAoC,CAApCA;AAEA,SAAA,SAAA;AACD,C,CAAA;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAAA,QAAA,CAAA,EAAA,EAAA,GAAA,EAAA,GAAA,EAAgC;AAC9B,MAAI;AACF,WAAO;AAAEI,MAAAA,IAAI,EAAN,QAAA;AAAkBC,MAAAA,GAAG,EAAEC,EAAE,CAAFA,IAAAA,CAAAA,GAAAA,EAAAA,GAAAA;AAAvB,KAAP;AADF,GAAA,CAEE,OAAA,GAAA,EAAY;AACZ,WAAO;AAAEF,MAAAA,IAAI,EAAN,OAAA;AAAiBC,MAAAA,GAAG,EAAEE;AAAtB,KAAP;AACD;AACF;;AAED,IAAIC,sBAAsB,GAA1B,gBAAA;AACA,IAAIC,sBAAsB,GAA1B,gBAAA;AACA,IAAIC,iBAAiB,GAArB,WAAA;AACA,IAAIC,iBAAiB,GAArB,WAAA,C,CAAA;AAGA;;AACA,IAAIC,gBAAgB,GAApB,EAAA,C,CAAA;AAGA;AACA;AACA;;AACA,SAAA,SAAA,GAAqB,CAAA;;AACrB,SAAA,iBAAA,GAA6B,CAAA;;AAC7B,SAAA,0BAAA,GAAsC,CAAA,C,CAAA;AAGtC;;;AACA,IAAIC,iBAAiB,GAArB,EAAA;;AACAA,iBAAiB,CAAjBA,cAAiB,CAAjBA,GAAoC,YAAY;AAC9C,SAAA,IAAA;AADFA,CAAAA;;AAIA,IAAIC,QAAQ,GAAGtB,MAAM,CAArB,cAAA;AACA,IAAIuB,uBAAuB,GAAGD,QAAQ,IAAIA,QAAQ,CAACA,QAAQ,CAACE,MAAM,CAAlE,EAAkE,CAAP,CAAT,CAAlD;;AACA,IAAID,uBAAuB,IACzBA,uBAAuB,KADrBA,EAAAA,IAEFtB,MAAM,CAANA,IAAAA,CAAAA,uBAAAA,EAFF,cAEEA,CAFF,EAEwD;AACtD;AACA;AACAoB,EAAAA,iBAAiB,GAAjBA,uBAAAA;AACD;;AAED,IAAII,EAAE,GAAGC,0BAA0B,CAA1BA,SAAAA,GACPC,SAAS,CAATA,SAAAA,GAAsB3B,MAAM,CAANA,MAAAA,CADxB,iBACwBA,CADxB;AAEA4B,iBAAiB,CAAjBA,SAAAA,GAA8BH,EAAE,CAAFA,WAAAA,GAA9BG,0BAAAA;AACAF,0BAA0B,CAA1BA,WAAAA,GAAAA,iBAAAA;AACAA,0BAA0B,CAA1BA,iBAA0B,CAA1BA,GACEE,iBAAiB,CAAjBA,WAAAA,GADFF,mBAAAA,C,CAAAA;AAIA;;AACA,SAAA,qBAAA,CAAA,SAAA,EAA0C;AACxC,GAAA,MAAA,EAAA,OAAA,EAAA,QAAA,EAAA,OAAA,CAAoC,UAAA,MAAA,EAAiB;AACnDG,IAAAA,SAAS,CAATA,MAAS,CAATA,GAAoB,UAAA,GAAA,EAAc;AAChC,aAAO,KAAA,OAAA,CAAA,MAAA,EAAP,GAAO,CAAP;AADFA,KAAAA;AADF,GAAA;AAKD;;AAED,SAAA,mBAAA,CAAA,MAAA,EAAsC;AACpC,MAAIC,IAAI,GAAG,OAAA,MAAA,KAAA,UAAA,IAAgCC,MAAM,CAAjD,WAAA;AACA,SAAOD,IAAI,GACPA,IAAI,KAAJA,iBAAAA,IAAAA;AAEF;AACA,GAACA,IAAI,CAAJA,WAAAA,IAAoBA,IAAI,CAAzB,IAAA,MAJS,mBAAA,GAAX,KAAA;AAMD;;AAED,SAAA,IAAA,CAAA,MAAA,EAAuB;AACrB,MAAI9B,MAAM,CAAV,cAAA,EAA2B;AACzBA,IAAAA,MAAM,CAANA,cAAAA,CAAAA,MAAAA,EAAAA,0BAAAA;AADF,GAAA,MAEO;AACL+B,IAAAA,MAAM,CAANA,SAAAA,GAAAA,0BAAAA;;AACA,QAAI,EAAE1B,iBAAiB,IAAvB,MAAI,CAAJ,EAAoC;AAClC0B,MAAAA,MAAM,CAANA,iBAAM,CAANA,GAAAA,mBAAAA;AACD;AACF;;AACDA,EAAAA,MAAM,CAANA,SAAAA,GAAmB/B,MAAM,CAANA,MAAAA,CAAnB+B,EAAmB/B,CAAnB+B;AACA,SAAA,MAAA;AACD,C,CAGD;AACA;AACA;;;AACA,SAAA,KAAA,CAAA,GAAA,EAAqB;AACnB,SAAO;AAAEC,IAAAA,OAAO,EAAEnB;AAAX,GAAP;AACD;;AAED,SAAA,aAAA,CAAA,SAAA,EAAA,WAAA,EAA+C;AAC7C,WAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAAA,OAAA,EAAA,MAAA,EAA8C;AAC5C,QAAIoB,MAAM,GAAGC,QAAQ,CAAC1B,SAAS,CAAV,MAAU,CAAV,EAAA,SAAA,EAArB,GAAqB,CAArB;;AACA,QAAIyB,MAAM,CAANA,IAAAA,KAAJ,OAAA,EAA6B;AAC3BE,MAAAA,MAAM,CAACF,MAAM,CAAbE,GAAM,CAANA;AADF,KAAA,MAEO;AACL,UAAIC,MAAM,GAAGH,MAAM,CAAnB,GAAA;AACA,UAAII,KAAK,GAAGD,MAAM,CAAlB,KAAA;;AACA,UAAIC,KAAK,IACP,OAAA,KAAA,KADEA,QAAAA,IAEFpC,MAAM,CAANA,IAAAA,CAAAA,KAAAA,EAFF,SAEEA,CAFF,EAEiC;AAC/B,eAAO,WAAW,CAAX,OAAA,CAAoBoC,KAAK,CAAzB,OAAA,EAAA,IAAA,CAAwC,UAAA,KAAA,EAAgB;AAC7DC,UAAAA,MAAM,CAAA,MAAA,EAAA,KAAA,EAAA,OAAA,EAANA,MAAM,CAANA;AADK,SAAA,EAEJ,UAAA,GAAA,EAAc;AACfA,UAAAA,MAAM,CAAA,OAAA,EAAA,GAAA,EAAA,OAAA,EAANA,MAAM,CAANA;AAHF,SAAO,CAAP;AAKD;;AAED,aAAO,WAAW,CAAX,OAAA,CAAA,KAAA,EAAA,IAAA,CAAgC,UAAA,SAAA,EAAoB;AACzD;AACA;AACA;AACAF,QAAAA,MAAM,CAANA,KAAAA,GAAAA,SAAAA;AACAG,QAAAA,OAAO,CAAPA,MAAO,CAAPA;AALK,OAAA,EAMJ,UAAA,KAAA,EAAgB;AACjB;AACA;AACA,eAAOD,MAAM,CAAA,OAAA,EAAA,KAAA,EAAA,OAAA,EAAb,MAAa,CAAb;AATF,OAAO,CAAP;AAWD;AACF;;AAED,MAAA,eAAA;;AAEA,WAAA,OAAA,CAAA,MAAA,EAAA,GAAA,EAA8B;AAC5B,aAAA,0BAAA,GAAsC;AACpC,aAAO,IAAA,WAAA,CAAgB,UAAA,OAAA,EAAA,MAAA,EAA0B;AAC/CA,QAAAA,MAAM,CAAA,MAAA,EAAA,GAAA,EAAA,OAAA,EAANA,MAAM,CAANA;AADF,OAAO,CAAP;AAGD;;AAED,WAAOE,eAAe,GAAA;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,IAAAA,eAAe,GAAGA,eAAe,CAAfA,IAAAA,CAAAA,0BAAAA,EAAAA;AAGhB;AAHa,IAAA,0BAAGA,CAAH,GAKXC,0BAlBN,EAAA;AAzC2C,GAAA,CAAA;AA+D7C;;;AACA,OAAA,OAAA,GAAA,OAAA;AACD;;AAEDC,qBAAqB,CAACC,aAAa,CAAnCD,SAAqB,CAArBA;;AACAC,aAAa,CAAbA,SAAAA,CAAAA,mBAAAA,IAA+C,YAAY;AACzD,SAAA,IAAA;AADFA,CAAAA,C,CAAAA;AAKA;AACA;;;AACC,SAAA,KAAA,CAAA,OAAA,EAAA,OAAA,EAAA,IAAA,EAAA,WAAA,EAAA,WAAA,EAAkE;AACjE,MAAIC,WAAW,KAAK,KAApB,CAAA,EAA4BA,WAAW,GAAXA,OAAAA;AAE5B,MAAIC,IAAI,GAAG,IAAA,aAAA,CACTC,IAAI,CAAA,OAAA,EAAA,OAAA,EAAA,IAAA,EADK,WACL,CADK,EAAX,WAAW,CAAX;AAKA,SAAO,mBAAmB,CAAnB,OAAmB,CAAnB,GAAA,IAAA,CAAA;AAAA,IAEH,IAAI,CAAJ,IAAA,GAAA,IAAA,CAAiB,UAAA,MAAA,EAAiB;AAClC,WAAOV,MAAM,CAANA,IAAAA,GAAcA,MAAM,CAApBA,KAAAA,GAA6BS,IAAI,CAAxC,IAAoCA,EAApC;AAHJ,GAEI,CAFJ;AAKD;;AAED,SAAA,gBAAA,CAAA,OAAA,EAAA,IAAA,EAAA,OAAA,EAAkD;AAChD,MAAIE,KAAK,GAAT,sBAAA;AAEA,SAAO,SAAA,MAAA,CAAA,MAAA,EAAA,GAAA,EAA6B;AAClC,QAAIA,KAAK,KAAT,iBAAA,EAAiC;AAC/B,YAAM,IAAA,KAAA,CAAN,8BAAM,CAAN;AACD;;AAED,QAAIA,KAAK,KAAT,iBAAA,EAAiC;AAC/B,UAAIC,MAAM,KAAV,OAAA,EAAwB;AACtB,cAAA,GAAA;AAF6B,OAAA,CAAA;AAM/B;;;AACA,aAAOC,UAAP,EAAA;AACD;;AAEDxC,IAAAA,OAAO,CAAPA,MAAAA,GAAAA,MAAAA;AACAA,IAAAA,OAAO,CAAPA,GAAAA,GAAAA,GAAAA;;AAEA,WAAA,IAAA,EAAa;AACX,UAAIyC,QAAQ,GAAGzC,OAAO,CAAtB,QAAA;;AACA,UAAA,QAAA,EAAc;AACZ,YAAI0C,cAAc,GAAGC,mBAAmB,CAAA,QAAA,EAAxC,OAAwC,CAAxC;;AACA,YAAA,cAAA,EAAoB;AAClB,cAAID,cAAc,KAAlB,gBAAA,EAAyC;AACzC,iBAAA,cAAA;AACD;AACF;;AAED,UAAI1C,OAAO,CAAPA,MAAAA,KAAJ,MAAA,EAA+B;AAC7B;AACA;AACAA,QAAAA,OAAO,CAAPA,IAAAA,GAAeA,OAAO,CAAPA,KAAAA,GAAgBA,OAAO,CAAtCA,GAAAA;AAHF,OAAA,MAKO,IAAIA,OAAO,CAAPA,MAAAA,KAAJ,OAAA,EAAgC;AACrC,YAAIsC,KAAK,KAAT,sBAAA,EAAsC;AACpCA,UAAAA,KAAK,GAALA,iBAAAA;AACA,gBAAMtC,OAAO,CAAb,GAAA;AACD;;AAEDA,QAAAA,OAAO,CAAPA,iBAAAA,CAA0BA,OAAO,CAAjCA,GAAAA;AANK,OAAA,MAQA,IAAIA,OAAO,CAAPA,MAAAA,KAAJ,QAAA,EAAiC;AACtCA,QAAAA,OAAO,CAAPA,MAAAA,CAAAA,QAAAA,EAAyBA,OAAO,CAAhCA,GAAAA;AACD;;AAEDsC,MAAAA,KAAK,GAALA,iBAAAA;AAEA,UAAId,MAAM,GAAGC,QAAQ,CAAA,OAAA,EAAA,IAAA,EAArB,OAAqB,CAArB;;AACA,UAAID,MAAM,CAANA,IAAAA,KAAJ,QAAA,EAA8B;AAC5B;AACA;AACAc,QAAAA,KAAK,GAAGtC,OAAO,CAAPA,IAAAA,GAAAA,iBAAAA,GAARsC,sBAAAA;;AAIA,YAAId,MAAM,CAANA,GAAAA,KAAJ,gBAAA,EAAqC;AACnC;AACD;;AAED,eAAO;AACLI,UAAAA,KAAK,EAAEJ,MAAM,CADR,GAAA;AAELoB,UAAAA,IAAI,EAAE5C,OAAO,CAAC4C;AAFT,SAAP;AAXF,OAAA,MAgBO,IAAIpB,MAAM,CAANA,IAAAA,KAAJ,OAAA,EAA6B;AAClCc,QAAAA,KAAK,GAD6B,iBAClCA,CADkC,CAAA;AAGlC;;AACAtC,QAAAA,OAAO,CAAPA,MAAAA,GAAAA,OAAAA;AACAA,QAAAA,OAAO,CAAPA,GAAAA,GAAcwB,MAAM,CAApBxB,GAAAA;AACD;AACF;AAvEH,GAAA;AAyED,C,CAAA;AAGD;AACA;AACA;;;AACA,SAAA,mBAAA,CAAA,QAAA,EAAA,OAAA,EAAgD;AAC9C,MAAIuC,MAAM,GAAGE,QAAQ,CAARA,QAAAA,CAAkBzC,OAAO,CAAtC,MAAayC,CAAb;;AACA,MAAIF,MAAM,KAAV,WAAA,EAA0B;AACxB;AACA;AACAvC,IAAAA,OAAO,CAAPA,QAAAA,GAAAA,IAAAA;;AAEA,QAAIA,OAAO,CAAPA,MAAAA,KAAJ,OAAA,EAAgC;AAC9B;AACA,UAAIyC,QAAQ,CAARA,QAAAA,CAAJ,QAAIA,CAAJ,EAAiC;AAC/B;AACA;AACAzC,QAAAA,OAAO,CAAPA,MAAAA,GAAAA,QAAAA;AACAA,QAAAA,OAAO,CAAPA,GAAAA,GAAAA,WAAAA;AACA2C,QAAAA,mBAAmB,CAAA,QAAA,EAAnBA,OAAmB,CAAnBA;;AAEA,YAAI3C,OAAO,CAAPA,MAAAA,KAAJ,OAAA,EAAgC;AAC9B;AACA;AACA,iBAAA,gBAAA;AACD;AACF;;AAEDA,MAAAA,OAAO,CAAPA,MAAAA,GAAAA,OAAAA;AACAA,MAAAA,OAAO,CAAPA,GAAAA,GAAc,IAAA,SAAA,CAAdA,gDAAc,CAAdA;AAED;;AAED,WAAA,gBAAA;AACD;;AAED,MAAIwB,MAAM,GAAGC,QAAQ,CAAA,MAAA,EAASgB,QAAQ,CAAjB,QAAA,EAA4BzC,OAAO,CAAxD,GAAqB,CAArB;;AAEA,MAAIwB,MAAM,CAANA,IAAAA,KAAJ,OAAA,EAA6B;AAC3BxB,IAAAA,OAAO,CAAPA,MAAAA,GAAAA,OAAAA;AACAA,IAAAA,OAAO,CAAPA,GAAAA,GAAcwB,MAAM,CAApBxB,GAAAA;AACAA,IAAAA,OAAO,CAAPA,QAAAA,GAAAA,IAAAA;AACA,WAAA,gBAAA;AACD;;AAED,MAAI6C,IAAI,GAAGrB,MAAM,CAAjB,GAAA;;AAEA,MAAI,CAAJ,IAAA,EAAY;AACVxB,IAAAA,OAAO,CAAPA,MAAAA,GAAAA,OAAAA;AACAA,IAAAA,OAAO,CAAPA,GAAAA,GAAc,IAAA,SAAA,CAAdA,kCAAc,CAAdA;AACAA,IAAAA,OAAO,CAAPA,QAAAA,GAAAA,IAAAA;AACA,WAAA,gBAAA;AACD;;AAED,MAAI6C,IAAI,CAAR,IAAA,EAAe;AACb;AACA;AACA7C,IAAAA,OAAO,CAACyC,QAAQ,CAAhBzC,UAAO,CAAPA,GAA+B6C,IAAI,CAHtB,KAGb7C,CAHa,CAAA;;AAMbA,IAAAA,OAAO,CAAPA,IAAAA,GAAeyC,QAAQ,CANV,OAMbzC,CANa,CAAA;AASb;AACA;AACA;AACA;AACA;;AACA,QAAIA,OAAO,CAAPA,MAAAA,KAAJ,QAAA,EAAiC;AAC/BA,MAAAA,OAAO,CAAPA,MAAAA,GAAAA,MAAAA;AACAA,MAAAA,OAAO,CAAPA,GAAAA,GAAAA,WAAAA;AACD;AAjBH,GAAA,MAmBO;AACL;AACA,WAAA,IAAA;AAtE4C,GAAA,CAAA;AA0E9C;;;AACAA,EAAAA,OAAO,CAAPA,QAAAA,GAAAA,IAAAA;AACA,SAAA,gBAAA;AACD,C,CAAA;AAGD;;;AACAiC,qBAAqB,CAArBA,EAAqB,CAArBA;AAEAjB,EAAE,CAAFA,iBAAE,CAAFA,GAAAA,WAAAA,C,CAAAA;AAGA;AACA;AACA;AACA;;AACAA,EAAE,CAAFA,cAAE,CAAFA,GAAqB,YAAW;AAC9B,SAAA,IAAA;AADFA,CAAAA;;AAIAA,EAAE,CAAFA,QAAAA,GAAc,YAAW;AACvB,SAAA,oBAAA;AADFA,CAAAA;;AAIA,SAAA,YAAA,CAAA,IAAA,EAA4B;AAC1B,MAAI8B,KAAK,GAAG;AAAEC,IAAAA,MAAM,EAAEC,IAAI,CAAA,CAAA;AAAd,GAAZ;;AAEA,MAAI,KAAJ,IAAA,EAAe;AACbF,IAAAA,KAAK,CAALA,QAAAA,GAAiBE,IAAI,CAArBF,CAAqB,CAArBA;AACD;;AAED,MAAI,KAAJ,IAAA,EAAe;AACbA,IAAAA,KAAK,CAALA,UAAAA,GAAmBE,IAAI,CAAvBF,CAAuB,CAAvBA;AACAA,IAAAA,KAAK,CAALA,QAAAA,GAAiBE,IAAI,CAArBF,CAAqB,CAArBA;AACD;;AAED,OAAA,UAAA,CAAA,IAAA,CAAA,KAAA;AACD;;AAED,SAAA,aAAA,CAAA,KAAA,EAA8B;AAC5B,MAAItB,MAAM,GAAGsB,KAAK,CAALA,UAAAA,IAAb,EAAA;AACAtB,EAAAA,MAAM,CAANA,IAAAA,GAAAA,QAAAA;AACA,SAAOA,MAAM,CAAb,GAAA;AACAsB,EAAAA,KAAK,CAALA,UAAAA,GAAAA,MAAAA;AACD;;AAED,SAAA,OAAA,CAAA,WAAA,EAA8B;AAC5B;AACA;AACA;AACA,OAAA,UAAA,GAAkB,CAAC;AAAEC,IAAAA,MAAM,EAAE;AAAV,GAAD,CAAlB;AACA9C,EAAAA,WAAW,CAAXA,OAAAA,CAAAA,YAAAA,EAAAA,IAAAA;AACA,OAAA,KAAA,CAAA,IAAA;AACD;;AAED,SAAA,IAAA,CAAA,MAAA,EAAuB;AACrB,MAAIgD,IAAI,GAAR,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,MAAA,EAAwB;AACtBA,IAAAA,IAAI,CAAJA,IAAAA,CAAAA,GAAAA;AACD;;AACDA,EAAAA,IAAI,CALiB,OAKrBA,GALqB,CAAA;AAQrB;;AACA,SAAO,SAAA,IAAA,GAAgB;AACrB,WAAOA,IAAI,CAAX,MAAA,EAAoB;AAClB,UAAIC,GAAG,GAAGD,IAAI,CAAd,GAAUA,EAAV;;AACA,UAAIC,GAAG,IAAP,MAAA,EAAmB;AACjBC,QAAAA,IAAI,CAAJA,KAAAA,GAAAA,GAAAA;AACAA,QAAAA,IAAI,CAAJA,IAAAA,GAAAA,KAAAA;AACA,eAAA,IAAA;AACD;AAPkB,KAAA,CAAA;AAWrB;AACA;;;AACAA,IAAAA,IAAI,CAAJA,IAAAA,GAAAA,IAAAA;AACA,WAAA,IAAA;AAdF,GAAA;AAgBD;;AAED,SAAA,MAAA,CAAA,QAAA,EAA0B;AACxB,MAAA,QAAA,EAAc;AACZ,QAAIC,cAAc,GAAGC,QAAQ,CAA7B,cAA6B,CAA7B;;AACA,QAAA,cAAA,EAAoB;AAClB,aAAOD,cAAc,CAAdA,IAAAA,CAAP,QAAOA,CAAP;AACD;;AAED,QAAI,OAAOC,QAAQ,CAAf,IAAA,KAAJ,UAAA,EAAyC;AACvC,aAAA,QAAA;AACD;;AAED,QAAI,CAACC,KAAK,CAACD,QAAQ,CAAnB,MAAU,CAAV,EAA6B;AAC3B,UAAIE,CAAC,GAAG,CAAR,CAAA;AAAA,UAAYJ,IAAI,GAAG,SAAA,IAAA,GAAgB;AACjC,eAAO,EAAA,CAAA,GAAME,QAAQ,CAArB,MAAA,EAA8B;AAC5B,cAAI7D,MAAM,CAANA,IAAAA,CAAAA,QAAAA,EAAJ,CAAIA,CAAJ,EAA8B;AAC5B2D,YAAAA,IAAI,CAAJA,KAAAA,GAAaE,QAAQ,CAArBF,CAAqB,CAArBA;AACAA,YAAAA,IAAI,CAAJA,IAAAA,GAAAA,KAAAA;AACA,mBAAA,IAAA;AACD;AACF;;AAEDA,QAAAA,IAAI,CAAJA,KAAAA,GAAAA,WAAAA;AACAA,QAAAA,IAAI,CAAJA,IAAAA,GAAAA,IAAAA;AAEA,eAAA,IAAA;AAZF,OAAA;;AAeA,aAAOA,IAAI,CAAJA,IAAAA,GAAP,IAAA;AACD;AA5BqB,GAAA,CAAA;;;AAgCxB,SAAO;AAAEA,IAAAA,IAAI,EAAEX;AAAR,GAAP;AACD;;AAED,SAAA,UAAA,GAAsB;AACpB,SAAO;AAAEZ,IAAAA,KAAK,EAAP,WAAA;AAAoBgB,IAAAA,IAAI,EAAE;AAA1B,GAAP;AACD;;AAEDY,OAAO,CAAPA,SAAAA,GAAoB;AAClBC,EAAAA,WAAW,EADO,OAAA;AAGlBC,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,aAAA,EAAwB;AAC7B,SAAA,IAAA,GAAA,CAAA;AACA,SAAA,IAAA,GAF6B,CAE7B,CAF6B,CAAA;AAI7B;;AACA,SAAA,IAAA,GAAY,KAAA,KAAA,GAAZ,WAAA;AACA,SAAA,IAAA,GAAA,KAAA;AACA,SAAA,QAAA,GAAA,IAAA;AAEA,SAAA,MAAA,GAAA,MAAA;AACA,SAAA,GAAA,GAAA,WAAA;AAEA,SAAA,UAAA,CAAA,OAAA,CAAA,aAAA;;AAEA,QAAI,CAAJ,aAAA,EAAoB;AAClB,WAAK,IAAL,IAAA,IAAA,IAAA,EAAuB;AACrB;AACA,YAAIC,IAAI,CAAJA,MAAAA,CAAAA,CAAAA,MAAAA,GAAAA,IACFnE,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EADEmE,IACFnE,CADEmE,IAEF,CAACL,KAAK,CAAC,CAACK,IAAI,CAAJA,KAAAA,CAFV,CAEUA,CAAF,CAFR,EAE0B;AACxB,eAAA,IAAA,IAAA,WAAA;AACD;AACF;AACF;AA1Be,GAAA;AA6BlBC,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACf,SAAA,IAAA,GAAA,IAAA;AAEA,QAAIC,SAAS,GAAG,KAAA,UAAA,CAAhB,CAAgB,CAAhB;AACA,QAAIC,UAAU,GAAGD,SAAS,CAA1B,UAAA;;AACA,QAAIC,UAAU,CAAVA,IAAAA,KAAJ,OAAA,EAAiC;AAC/B,YAAMA,UAAU,CAAhB,GAAA;AACD;;AAED,WAAO,KAAP,IAAA;AAtCgB,GAAA;AAyClBC,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,CAAA,SAAA,EAAoB;AACrC,QAAI,KAAJ,IAAA,EAAe;AACb,YAAA,SAAA;AACD;;AAED,QAAI/D,OAAO,GAAX,IAAA;;AACA,aAAA,MAAA,CAAA,GAAA,EAAA,MAAA,EAA6B;AAC3BwB,MAAAA,MAAM,CAANA,IAAAA,GAAAA,OAAAA;AACAA,MAAAA,MAAM,CAANA,GAAAA,GAAAA,SAAAA;AACAxB,MAAAA,OAAO,CAAPA,IAAAA,GAAAA,GAAAA;;AAEA,UAAA,MAAA,EAAY;AACV;AACA;AACAA,QAAAA,OAAO,CAAPA,MAAAA,GAAAA,MAAAA;AACAA,QAAAA,OAAO,CAAPA,GAAAA,GAAAA,WAAAA;AACD;;AAED,aAAO,CAAC,CAAR,MAAA;AACD;;AAED,SAAK,IAAIuD,CAAC,GAAG,KAAA,UAAA,CAAA,MAAA,GAAb,CAAA,EAAyCA,CAAC,IAA1C,CAAA,EAAiD,EAAjD,CAAA,EAAsD;AACpD,UAAIT,KAAK,GAAG,KAAA,UAAA,CAAZ,CAAY,CAAZ;AACA,UAAItB,MAAM,GAAGsB,KAAK,CAAlB,UAAA;;AAEA,UAAIA,KAAK,CAALA,MAAAA,KAAJ,MAAA,EAA6B;AAC3B;AACA;AACA;AACA,eAAOkB,MAAM,CAAb,KAAa,CAAb;AACD;;AAED,UAAIlB,KAAK,CAALA,MAAAA,IAAgB,KAApB,IAAA,EAA+B;AAC7B,YAAImB,QAAQ,GAAGzE,MAAM,CAANA,IAAAA,CAAAA,KAAAA,EAAf,UAAeA,CAAf;AACA,YAAI0E,UAAU,GAAG1E,MAAM,CAANA,IAAAA,CAAAA,KAAAA,EAAjB,YAAiBA,CAAjB;;AAEA,YAAIyE,QAAQ,IAAZ,UAAA,EAA4B;AAC1B,cAAI,KAAA,IAAA,GAAYnB,KAAK,CAArB,QAAA,EAAgC;AAC9B,mBAAOkB,MAAM,CAAClB,KAAK,CAAN,QAAA,EAAb,IAAa,CAAb;AADF,WAAA,MAEO,IAAI,KAAA,IAAA,GAAYA,KAAK,CAArB,UAAA,EAAkC;AACvC,mBAAOkB,MAAM,CAAClB,KAAK,CAAnB,UAAa,CAAb;AACD;AALH,SAAA,MAOO,IAAA,QAAA,EAAc;AACnB,cAAI,KAAA,IAAA,GAAYA,KAAK,CAArB,QAAA,EAAgC;AAC9B,mBAAOkB,MAAM,CAAClB,KAAK,CAAN,QAAA,EAAb,IAAa,CAAb;AACD;AAHI,SAAA,MAKA,IAAA,UAAA,EAAgB;AACrB,cAAI,KAAA,IAAA,GAAYA,KAAK,CAArB,UAAA,EAAkC;AAChC,mBAAOkB,MAAM,CAAClB,KAAK,CAAnB,UAAa,CAAb;AACD;AAHI,SAAA,MAKA;AACL,gBAAM,IAAA,KAAA,CAAN,wCAAM,CAAN;AACD;AACF;AACF;AAlGe,GAAA;AAqGlBqB,EAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,IAAA,EAAA,GAAA,EAAoB;AAC1B,SAAK,IAAIZ,CAAC,GAAG,KAAA,UAAA,CAAA,MAAA,GAAb,CAAA,EAAyCA,CAAC,IAA1C,CAAA,EAAiD,EAAjD,CAAA,EAAsD;AACpD,UAAIT,KAAK,GAAG,KAAA,UAAA,CAAZ,CAAY,CAAZ;;AACA,UAAIA,KAAK,CAALA,MAAAA,IAAgB,KAAhBA,IAAAA,IACFtD,MAAM,CAANA,IAAAA,CAAAA,KAAAA,EADEsD,YACFtD,CADEsD,IAEF,KAAA,IAAA,GAAYA,KAAK,CAFnB,UAAA,EAEgC;AAC9B,YAAIsB,YAAY,GAAhB,KAAA;AACA;AACD;AACF;;AAED,QAAIA,YAAY,KACbjE,IAAI,KAAJA,OAAAA,IACCA,IAAI,KAFJiE,UAAY,CAAZA,IAGFA,YAAY,CAAZA,MAAAA,IAHEA,GAAAA,IAIFhE,GAAG,IAAIgE,YAAY,CAJrB,UAAA,EAIkC;AAChC;AACA;AACAA,MAAAA,YAAY,GAAZA,IAAAA;AACD;;AAED,QAAI5C,MAAM,GAAG4C,YAAY,GAAGA,YAAY,CAAf,UAAA,GAAzB,EAAA;AACA5C,IAAAA,MAAM,CAANA,IAAAA,GAAAA,IAAAA;AACAA,IAAAA,MAAM,CAANA,GAAAA,GAAAA,GAAAA;;AAEA,QAAA,YAAA,EAAkB;AAChB,WAAA,MAAA,GAAA,MAAA;AACA,WAAA,IAAA,GAAY4C,YAAY,CAAxB,UAAA;AACA,aAAA,gBAAA;AACD;;AAED,WAAO,KAAA,QAAA,CAAP,MAAO,CAAP;AApIgB,GAAA;AAuIlBC,EAAAA,QAAQ,EAAE,SAAA,QAAA,CAAA,MAAA,EAAA,QAAA,EAA2B;AACnC,QAAI7C,MAAM,CAANA,IAAAA,KAAJ,OAAA,EAA6B;AAC3B,YAAMA,MAAM,CAAZ,GAAA;AACD;;AAED,QAAIA,MAAM,CAANA,IAAAA,KAAAA,OAAAA,IACFA,MAAM,CAANA,IAAAA,KADF,UAAA,EAC8B;AAC5B,WAAA,IAAA,GAAYA,MAAM,CAAlB,GAAA;AAFF,KAAA,MAGO,IAAIA,MAAM,CAANA,IAAAA,KAAJ,QAAA,EAA8B;AACnC,WAAA,IAAA,GAAY,KAAA,GAAA,GAAWA,MAAM,CAA7B,GAAA;AACA,WAAA,MAAA,GAAA,QAAA;AACA,WAAA,IAAA,GAAA,KAAA;AAHK,KAAA,MAIA,IAAIA,MAAM,CAANA,IAAAA,KAAAA,QAAAA,IAAJ,QAAA,EAA0C;AAC/C,WAAA,IAAA,GAAA,QAAA;AACD;;AAED,WAAA,gBAAA;AAvJgB,GAAA;AA0JlB8C,EAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,UAAA,EAAqB;AAC3B,SAAK,IAAIf,CAAC,GAAG,KAAA,UAAA,CAAA,MAAA,GAAb,CAAA,EAAyCA,CAAC,IAA1C,CAAA,EAAiD,EAAjD,CAAA,EAAsD;AACpD,UAAIT,KAAK,GAAG,KAAA,UAAA,CAAZ,CAAY,CAAZ;;AACA,UAAIA,KAAK,CAALA,UAAAA,KAAJ,UAAA,EAAqC;AACnC,aAAA,QAAA,CAAcA,KAAK,CAAnB,UAAA,EAAgCA,KAAK,CAArC,QAAA;AACAyB,QAAAA,aAAa,CAAbA,KAAa,CAAbA;AACA,eAAA,gBAAA;AACD;AACF;AAlKe,GAAA;AAqKlB,WAAS,SAAA,MAAA,CAAA,MAAA,EAAiB;AACxB,SAAK,IAAIhB,CAAC,GAAG,KAAA,UAAA,CAAA,MAAA,GAAb,CAAA,EAAyCA,CAAC,IAA1C,CAAA,EAAiD,EAAjD,CAAA,EAAsD;AACpD,UAAIT,KAAK,GAAG,KAAA,UAAA,CAAZ,CAAY,CAAZ;;AACA,UAAIA,KAAK,CAALA,MAAAA,KAAJ,MAAA,EAA6B;AAC3B,YAAItB,MAAM,GAAGsB,KAAK,CAAlB,UAAA;;AACA,YAAItB,MAAM,CAANA,IAAAA,KAAJ,OAAA,EAA6B;AAC3B,cAAIgD,MAAM,GAAGhD,MAAM,CAAnB,GAAA;AACA+C,UAAAA,aAAa,CAAbA,KAAa,CAAbA;AACD;;AACD,eAAA,MAAA;AACD;AAVqB,KAAA,CAAA;AAcxB;;;AACA,UAAM,IAAA,KAAA,CAAN,uBAAM,CAAN;AApLgB,GAAA;AAuLlBE,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,QAAA,EAAA,UAAA,EAAA,OAAA,EAAwC;AACrD,SAAA,QAAA,GAAgB;AACdC,MAAAA,QAAQ,EAAE3D,MAAM,CADF,QACE,CADF;AAEd4D,MAAAA,UAAU,EAFI,UAAA;AAGdC,MAAAA,OAAO,EAAEA;AAHK,KAAhB;;AAMA,QAAI,KAAA,MAAA,KAAJ,MAAA,EAA4B;AAC1B;AACA;AACA,WAAA,GAAA,GAAA,WAAA;AACD;;AAED,WAAA,gBAAA;AACD;AArMiB,CAApBpB,C,CAAAA;;AAyMA,IAAA,mBAAA,GAAe;AAAA,EAAA,IAAA;AAAA,EAAA,mBAAA;AAAA,EAAA,aAAA;AAAA,EAAA,IAAA;AAAA,EAAA,KAAA;AAAA,EAAA,KAAA;AAAA,EAAA,IAAA;AAQbzC,EAAAA;AARa,CAAf;ACvrBA;;;;AAGc,SAAA,IAAA,CAAA,MAAA,EAAA,GAAA,EAAA,IAAA,EAAyD;AACrE;AACA,MAAM,MAAM,GAAG,MAAM,CAAN,IAAA,CAAf,GAAe,CAAf;AACA,MAAM,IAAI,GAAV,KAAA;AACA,MAAM,IAAI,GAAV,GAAA;;AACA,MAAA,IAAA,GAAiB,IAAA,GAAA,CAAjB,GAAiB,CAAjB;AAAA,MAAO,MAAP,GAAA,IAAA,CALqE,MAKrE,CALqE,CAAA;;;AAOrE,MAAI,KAAK,GAAG,CAAC,EAAE,IAAI,GAAnB,IAAa,CAAb;;AAEA,WAAA,MAAA,CAAA,GAAA,EAAiC;AAC/B,QAAI,GAAG,CAAH,MAAA,KAAJ,MAAA,EAA2B;AACzB,MAAA,KAAK,GAAL,CAAA;AACA,MAAA,MAAM,CAAN,mBAAA,CAAA,SAAA,EAAA,MAAA,EAAA,KAAA;AACD;AACF;;AACD,EAAA,MAAM,CAAN,gBAAA,CAAA,SAAA,EAAA,MAAA,EAfqE,KAerE,EAfqE,CAAA;AAkBrE;;AACA,WAAA,IAAA,GAAa;AACX,QAAI,KAAK,IAAT,CAAA,EAAgB;AACd;AACD;;AACD,IAAA,MAAM,CAAN,WAAA,CAAA,IAAA,EAAA,MAAA;AACA,IAAA,UAAU,CAAA,IAAA,EAAV,IAAU,CAAV;AACA,IAAA,KAAK,IAAL,CAAA;AACD;;AACD,EAAA,UAAU,CAAA,IAAA,EAAV,IAAU,CAAV;AACD,C,CCjCD;;;AACA,IAAA,UAAA,GAAA,wqFAAA;;ACEA,IAAI,CAAC,MAAM,CAAN,SAAA,CAAL,UAAA,EAAkC;AAChC;AACA,EAAA,MAAM,CAAN,SAAA,CAAA,UAAA,GAA8B,UAAA,MAAA,EAAA,GAAA,EAAqB;AACjD,WAAO,KAAA,MAAA,CAAY,CAAA,GAAA,IAAQ,GAAG,GAAX,CAAA,GAAA,CAAA,GAAsB,CAAlC,GAAA,EAAwC,MAAM,CAA9C,MAAA,MAAP,MAAA;AADF,GAAA;AAGD;;AAQK,SAAA,SAAA,CAAA,IAAA,EAAiE;AAAA,OAAA,IAAA,IAAA,GAAA,SAAA,CAAA,MAAA,EAA9B,GAA8B,GAAA,IAAA,KAAA,CAAA,IAAA,GAAA,CAAA,GAAA,IAAA,GAAA,CAAA,GAAA,CAAA,CAAA,EAAA,IAAA,GAAA,CAAA,EAAA,IAAA,GAAA,IAAA,EAAA,IAAA,EAAA,EAAA;AAA9B,IAAA,GAA8B,CAAA,IAAA,GAAA,CAAA,CAA9B,GAA8B,SAAA,CAAA,IAAA,CAA9B;AAA8B;;AACrE,OAAA,IAAA,EAAA,GAAA,CAAA,EAAA,IAAA,GAAA,GAAA,EAAA,EAAA,GAAA,IAAA,CAAA,MAAA,EAAA,EAAA,EAAA,EAAqB;AAAhB,QAAM,CAAC,GAAA,IAAA,CAAP,EAAO,CAAP;AACH,IAAA,UAAU,CAAA,IAAA,EAAV,CAAU,CAAV;AACD;;AACD,SAAA,IAAA;AACD;;AAED,SAAA,UAAA,CAAA,IAAA,EAAA,GAAA,EAAuC;AACrC,OAAA,IAAA,GAAA,GAAA,CAAA,EAAA,YAAA,GAAuB,MAAM,CAAN,IAAA,CAAvB,GAAuB,CAAvB,EAAA,GAAA,GAAA,YAAA,CAAA,MAAA,EAAA,GAAA,EAAA,EAAyC;AAApC,QAAM,QAAQ,GAAA,YAAA,CAAd,GAAc,CAAd;AACH,IAAA,WAAW,CAAA,IAAA,EAAA,QAAA,EAAiB,GAAG,CAApB,QAAoB,CAApB,EAAX,IAAW,CAAX;AACD;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ICGY,OAAO,GAAG,GAAG,CAAC,O;IAId,IAAI,GAAG,U;IACT,SAAQ,GAAG,c,EAAA;;AAGtB,IAAM,CAAC,GAAI,OAAA,MAAA,KAAA,WAAA,GAAA,MAAA,GAAX,SAAA;;AACA,IAAI,SAAQ,KAAR,SAAA,IAA0B,CAA1B,KAAA,IAAA,IAA0B,CAA1B,KAAA,KAAA,CAAA,IAAA,CAAA,KAAA,GAA0B,CAAC,CAA3B,IAA2B,CAA3B,MAAA,IAAA,IAAA,KAAA,KAAA,KAAA,CAAA,IAA0B,KAAA,CAA9B,OAAA,EAAkD;AAChD,EAAA,SAAQ,GAAG,CAAC,CAAZ,IAAY,CAAZ;AACD;;IASY,eAAe,GAAG;AAAC,EAAA,MAAM,EAAE;AAAC,IAAA,GAAG,EAAJ,IAAA;AAAY,IAAA,GAAG,EAAE;AAAjB,GAAT;AAAiC,EAAA,MAAM,EAAvC,IAAA;AAA+C,EAAA,QAAQ,EAAvD,IAAA;AAA+D,EAAA,MAAM,EAAE;AAAvE,C;AAS/B,IAAM,IAAI,GAAG;AACX,EAAA,qBAAqB,EADV,uBAAA;AAEX,EAAA,eAAe,EAFJ,oBAAA;AAGX,EAAA,aAAa,EAHF,qBAAA;AAIX,EAAA,UAAU,EAJC,aAAA;AAKX,EAAA,aAAa,EALF,aAAA;AAMX,EAAA,UAAU,EAAE;AAND,CAAb;AAsCA,IAAM,KAAK,GAA4B;AACrC,EAAA,IAAI,EADiC,MAAA;AAErC,eAAa;AAFwB,CAAvC;AAKA,IAAM,OAAO,GAAG;AACd,EAAA,IAAI,EAAE,IAAI,CADI,OAAA;AAEd,eAAa,SAAQ,GAAG,SAAQ,CAAX,OAAA,GAAsB;AAF7B,CAAhB;AAKA,IAAM,YAAY,GAA6D;AAC7E,EAAA,IAAI,EAAG,MAAD,IADuE,MAAA;AAE7E,eAAa,CAAA,MAAA,EAAA,MAAA,KAAoB,SAAQ,CAAR,OAAA,CAAA,MAAA,EAAmC;AAAC,IAAA,MAAM,EAAE;AAAT,GAAnC,EAAiE;AAFrB,CAA/E;AAKA,IAAM,WAAW,GAAjB,iSAAA;AAOA,IAAM,mBAAmB,GAAzB,eAAA;;AAkBA,SAAA,gBAAA,CAAA,CAAA,EAAuE;AACrE,SAAO,OAAA,CAAA,KAAP,UAAA;AACD;;AAED,SAAA,UAAA,CAAA,MAAA,EAAA,YAAA,EAAA,YAAA,EAAA,IAAA,EAA0F;AACxF,MAAM,MAAM,GAAA,eAAA,MAAA,CAAA,YAAA,EAAZ,yCAAY,CAAZ;AACA,MAAM,MAAM,GAAA,gBAAA,MAAA,CAAA,YAAA,EAF4E,gBAE5E,CAAZ,CAFwF,CAAA;;AAIxF,MAAM,GAAG,GAAG,MAAM,CAAN,IAAA,CAAZ,EAAY,CAAZ;AACA,EAAA,GAAG,CAAH,QAAA,CAAA,KAAA,CAAmB,MAAM,GAAN,MAAA,GAAnB,MAAA;AACA,EAAA,GAAG,CAAH,QAAA,CAAA,KAAA,GAAA,GAAA,MAAA,CAAwB,KAAK,CAA7B,IAA6B,CAA7B,EAAA,cAAA,CAAA;AACD;AAED;;;;;;;AAKM,SAAA,SAAA,CAAA,IAAA,EAAA,YAAA,EAAgE;AACpE;AACA,MAAI,IAAI,CAAR,OAAA,EAAkB;AAChB,QAAM,MAAM,GAAG,YAAY,CAAC,IAAI,CAAhC,OAA2B,CAA3B;;AACA,QAAI,YAAY,IAAI,YAAY,KAAK,MAAM,CAA3C,OAAA,EAAqD;AAAA,UAAA,mBAAA;;AACnD,MAAA,OAAO,CAAP,IAAA,CAAA,8CAAA,MAAA,CACgD,KAAK,CAAC,MAAM,CAD5D,OACqD,CADrD,EAAA,2BAAA,EAAA,MAAA,CAAA,CAAA,mBAAA,GAEI,KAAK,CAFT,YAES,CAFT,MAAA,IAAA,IAAA,mBAAA,KAAA,KAAA,CAAA,GAAA,mBAAA,GAAA,YAAA,EAAA,GAAA,CAAA;AAKD;;AAED,QAAM,IAAI,GAAG,MAAM,CAAnB,OAAA;;AAEA,QAAI,CAAC,SAAS,CAAC,OAAO,CAAR,IAAQ,CAAR,EAAA,IAAA,MAAA,CAAoB,MAAM,CAAN,OAAA,CAAA,KAAA,CAAlC,CAAkC,CAApB,CAAA,CAAd,EAA8D;AAC5D,MAAA,OAAO,CAAP,IAAA,CAAA,uBAAA,MAAA,CACyB,KAAK,CAD9B,IAC8B,CAD9B,EAAA,GAAA,EAAA,MAAA,CACwC,MAAM,CAD9C,OAAA,EAAA,+BAAA,EAAA,MAAA,CACsF,KAAK,CAD3F,IAC2F,CAD3F,EAAA,OAAA,EAAA,MAAA,CACyG,OAAO,CADhH,IACgH,CADhH,EAAA,GAAA,CAAA;AAGD;;AAED,WAAA,IAAA;AApBkE,GAAA,CAAA;;;AAwBpE,MACE,UAAA,IAAA,IACA,cADA,IAAA,IAEA,WAFA,IAAA,IAGA,aAHA,IAAA,IAIA,aAJA,IAAA,IAKA,WALA,IAAA,IAMA,YAPF,IAAA,EAQE;AACA,WAAA,WAAA;AACD;;AAED,MAAI,WAAA,IAAA,IAAmB,aAAnB,IAAA,IAAwC,YAAxC,IAAA,IAA4D,UAAhE,IAAA,EAAgF;AAC9E,WAAA,MAAA;AACD;;AAED,SAAO,YAAP,KAAA,IAAO,IAAA,YAAP,KAAA,KAAA,CAAO,GAAP,YAAO,GAAP,MAAA;AACD;;AAED,SAAA,QAAA,CAAA,CAAA,EAA4C;AAC1C,SAAO,CAAC,EAAE,CAAC,IAAI,UAAf,CAAQ,CAAR;AACD;;AAED,SAAA,YAAA,CAAA,IAAA,EAAmD;AACjD,SAAO,QAAQ,CAAR,IAAQ,CAAR,GAAA,IAAA,GAAwB,IAAI,CAAJ,MAAA,CAA/B,IAA+B,CAA/B;AACD;;AAED,SAAA,wBAAA,CAAA,UAAA,EAA+D;AAAA,MAAA,IAAA;;AAC7D,SAAA,CAAA,IAAA,GAAQ,UAAU,CAAV,QAAA,IAAwB,UAAU,CAAV,QAAA,CAAhC,cAAgC,CAAhC,MAAA,IAAA,IAAA,IAAA,KAAA,KAAA,CAAA,GAAA,IAAA,GAAA,EAAA;AACD;AAED;;;;;;;;;;SAQA,K,CAAA,E,EAAA,G,EAAA;AAAA,SAAA,OAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA;AAAA;;;qEAAe,SAAA,OAAA,CAAA,EAAA,EAAA,IAAA,EAAA;AAAA,QAAA,kBAAA,EAAA,oBAAA;;AAAA,QAAA,IAAA;AAAA,QAAA,UAAA;AAAA,QAAA,MAAA;AAAA,QAAA,cAAA;AAAA,QAAA,YAAA;AAAA,QAAA,YAAA;AAAA,QAAA,UAAA;AAAA,QAAA,UAAA;AAAA,QAAA,KAAA,GAAA,SAAA;;AAAA,WAAA,mBAAA,CAAA,IAAA,CAAA,SAAA,QAAA,CAAA,QAAA,EAAA;AAAA,aAAA,CAAA,EAAA;AAAA,gBAAA,QAAA,CAAA,IAAA,GAAA,QAAA,CAAA,IAAA;AAAA,eAAA,CAAA;AAGb,YAAA,IAHa,GAAA,KAAA,CAAA,MAAA,GAAA,CAAA,IAAA,KAAA,CAAA,CAAA,CAAA,KAAA,SAAA,GAAA,KAAA,CAAA,CAAA,CAAA,GAAA,EAGb;;AAHa,gBAAA,CAQT,QAAQ,CARC,IAQD,CARC,EAAA;AAAA,cAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AAAA;AAAA;;AASX,YAAA,MAAM,GAAG,YAAY,CAAC,IAAI,CAA1B,MAAqB,CAArB;AATW,YAAA,QAAA,CAAA,EAAA,GAAA,IAAA;AAAA,YAAA,QAAA,CAAA,IAAA,GAAA,CAAA;AAAA,mBAUmB,MAAM,CAAN,IAAA,CAVnB,IAUmB,CAVnB;;AAAA,eAAA,CAAA;AAAA,YAAA,QAAA,CAAA,EAAA,GAAA,QAAA,CAAA,IAAA;AAUX,YAAA,UAVW,GAAA,QAAA,CAAA,EAAA,CAAA,KAAA,CAAA,IAAA,CAAA,QAAA,CAAA,EAAA,EAAA,QAAA,CAAA,EAAA,CAUX;AAVW,YAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AAAA;;AAAA,eAAA,EAAA;AAYX,YAAA,UAAU,GAAV,IAAA;;AAZW,eAAA,EAAA;AAeP,YAAA,cAfO,GAeU,wBAAwB,CAAxB,UAAwB,CAAxB,CAfV,MAeP,CAfO,CAAA;;AAkBb,gBAAI,CAAA,MAAA,IAAJ,cAAA,EAA+B;AAC7B,cAAA,MAAM,GAAG,YAAY,CAAA,CAAA,YAAA,GAAC,IAAI,CAAL,MAAA,MAAA,IAAA,IAAA,YAAA,KAAA,KAAA,CAAA,GAAA,YAAA,GAArB,cAAqB,CAArB;AACD;;AApBY,YAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AAAA,mBAsBc,QAAQ,CAAC,wBAAwB,CAAzB,UAAyB,CAAzB,EAtBtB,MAsBsB,CAtBtB;;AAAA,eAAA,EAAA;AAsBP,YAAA,YAtBO,GAAA,QAAA,CAAA,IAsBP;AAtBO,YAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AAAA,mBAuBY,QAAQ,CAAA,IAAA,EAvBpB,MAuBoB,CAvBpB;;AAAA,eAAA,EAAA;AAuBP,YAAA,UAvBO,GAAA,QAAA,CAAA,IAuBP;AAEA,YAAA,UAzBO,GAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EA0BR,SAAS,CAAA,UAAA,EA1BD,YA0BC,CA1BD,CAAA,EAAA,EAAA,EAAA;AA2BX,cAAA,MAAM,EAAE,WAAW,CAAA,CAAA,kBAAA,GAAC,UAAU,CAAX,MAAA,MAAA,IAAA,IAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,kBAAA,GAAA,EAAA,EAAA,CAAA,oBAAA,GAA0B,YAAY,CAAtC,MAAA,MAAA,IAAA,IAAA,oBAAA,KAAA,KAAA,CAAA,GAAA,oBAAA,GAAA,EAAA;AA3BR,aAAA,CAyBP;AAzBO,YAAA,QAAA,CAAA,IAAA,GAAA,EAAA;AAAA,mBA8BA,MAAM,CAAA,EAAA,EAAA,UAAA,EAAA,UAAA,EA9BN,MA8BM,CA9BN;;AAAA,eAAA,EAAA;AAAA,mBAAA,QAAA,CAAA,MAAA,CAAA,QAAA,EAAA,QAAA,CAAA,IAAA,CAAA;;AAAA,eAAA,EAAA;AAAA,eAAA,KAAA;AAAA,mBAAA,QAAA,CAAA,IAAA,EAAA;AAAA;AAAA;AAAA,KAAA,EAAA,OAAA,CAAA;AAAA,G;;;;SAiCA,Q,CAAA,G,EAAA,G,EAAA;;;;;uEAAf,SAAA,QAAA,CAAA,GAAA,EAAA,MAAA,EAAA;AAAA,QAAA,WAAA;;AAAA,QAAA,MAAA,EAAA,KAAA;AAAA,WAAA,mBAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,aAAA,CAAA,EAAA;AAAA,gBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,eAAA,CAAA;AAAA,gBAAA,CACyB,QAAQ,CAAC,GAAG,CADrC,MACiC,CADjC,EAAA;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,CAAA;AAAA;AAAA;;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,IAAA;AAAA,YAAA,SAAA,CAAA,IAAA,GAAA,CAAA;AAAA,mBACiE,MAAM,CAAN,IAAA,CAAY,GAAG,CADhF,MACiE,CADjE;;AAAA,eAAA,CAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,SAAA,CAAA,IAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,SAAA,CAAA,EAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,EAAA,EAAA,SAAA,CAAA,EAAA,CAAA;AAAA,YAAA,SAAA,CAAA,IAAA,GAAA,CAAA;AAAA;;AAAA,eAAA,CAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,CAAA,WAAA,GAC4F,GAAG,CAD/F,MAAA,MAAA,IAAA,IAAA,WAAA,KAAA,KAAA,CAAA,GAAA,WAAA,GAAA,EAAA;;AAAA,eAAA,CAAA;AACQ,YAAA,MADR,GAAA,SAAA,CAAA,EACQ;;AADR,gBAAA,CAEyC,QAAQ,CAAC,GAAG,CAFrD,KAEiD,CAFjD,EAAA;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,EAAA;AAAA;AAAA;;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,IAAA;AAAA,YAAA,SAAA,CAAA,IAAA,GAAA,EAAA;AAAA,mBAEgF,MAAM,CAAN,IAAA,CAAY,GAAG,CAF/F,KAEgF,CAFhF;;AAAA,eAAA,EAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,SAAA,CAAA,IAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAAA,SAAA,CAAA,EAAA,CAAA,KAAA,CAAA,IAAA,CAAA,SAAA,CAAA,EAAA,EAAA,SAAA,CAAA,EAAA,CAAA;AAAA,YAAA,SAAA,CAAA,IAAA,GAAA,EAAA;AAAA;;AAAA,eAAA,EAAA;AAAA,YAAA,SAAA,CAAA,EAAA,GAE0G,GAAG,CAF7G,KAAA;;AAAA,eAAA,EAAA;AAEQ,YAAA,KAFR,GAAA,SAAA,CAAA,EAEQ;AAFR,mBAAA,SAAA,CAAA,MAAA,CAAA,QAAA,EAAA,aAAA,CAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EAAA,GAAA,CAAA,EAKQ,KAAK,GAAG;AAAC,cAAA;AAAD,aAAH,GALb,EAAA,CAAA,EAMQ,MAAM,GAAG;AAAC,cAAA;AAAD,aAAH,GANd,EAAA,CAAA,CAAA;;AAAA,eAAA,EAAA;AAAA,eAAA,KAAA;AAAA,mBAAA,SAAA,CAAA,IAAA,EAAA;AAAA;AAAA;AAAA,KAAA,EAAA,QAAA,CAAA;AAAA,G;;;;AAUA,SAAA,OAAA,CAAA,EAAA,EAA4B;AAC1B,MAAM,YAAY,GAAG,EAAE,CAAF,WAAA,GAAiB,EAAE,CAAnB,WAAiB,EAAjB,GAArB,QAAA;;AACA,MAAI,YAAY,YAAhB,UAAA,EAAwC;AACtC,WAAO;AAAC,MAAA,IAAI,EAAL,YAAA;AAAqB,MAAA,aAAa,EAAE;AAApC,KAAP;AADF,GAAA,MAEO;AAAA,QAAA,cAAA;;AACL,WAAO;AAAC,MAAA,IAAI,EAAL,QAAA;AAAiB,MAAA,aAAa,EAAA,CAAA,cAAA,GAAE,QAAQ,CAAV,IAAA,MAAA,IAAA,IAAA,cAAA,KAAA,KAAA,CAAA,GAAA,cAAA,GAAmB,QAAQ,CAAC;AAA1D,KAAP;AACD;AACF;;SAEc,M,CAAA,G,EAAA,G,EAAA;;;;;qEAAf,SAAA,QAAA,CAAA,EAAA,EAAA,IAAA,EAAA;AAAA,QAAA,YAAA,EAAA,aAAA,EAAA,cAAA,EAAA,cAAA,EAAA,qBAAA,EAAA,KAAA,EAAA,qBAAA;;AAAA,QAAA,IAAA;AAAA,QAAA,MAAA;AAAA,QAAA,MAAA;AAAA,QAAA,OAAA;AAAA,QAAA,IAAA;AAAA,QAAA,QAAA;AAAA,QAAA,QAAA;AAAA,QAAA,gBAAA;AAAA,QAAA,OAAA;AAAA,QAAA,EAAA;AAAA,QAAA,QAAA;AAAA,QAAA,IAAA;AAAA,QAAA,aAAA;AAAA,QAAA,KAAA;AAAA,QAAA,IAAA;AAAA,QAAA,MAAA;AAAA,QAAA,MAAA;AAAA,QAAA,SAAA;AAAA,QAAA,YAAA;AAAA,QAAA,KAAA;AAAA,QAAA,GAAA;AAAA,QAAA,OAAA;AAAA,QAAA,IAAA;AAAA,QAAA,OAAA;AAAA,QAAA,KAAA;AAAA,QAAA,KAAA;AAAA,QAAA,QAAA;AAAA,QAAA,SAAA;AAAA,QAAA,oBAAA;AAAA,QAAA,OAAA;AAAA,QAAA,OAAA;AAAA,QAAA,OAAA;AAAA,QAAA,IAAA;AAAA,QAAA,KAAA;AAAA,QAAA,EAAA;AAAA,QAAA,IAAA;AAAA,QAAA,cAAA;AAAA,QAAA,WAAA;AAAA,QAAA,eAAA;AAAA,QAAA,SAAA;AAAA,QAAA,UAAA;AAAA,QAAA,QAAA;AAAA,QAAA,MAAA,GAAA,SAAA;;AAAA,WAAA,mBAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,aAAA,CAAA,EAAA;AAAA,gBAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,eAAA,CAAA;AAuPW,YAAA,QAvPX,GAAA,SAAA,SAAA,GAuPmB;AACf,kBAAA,oBAAA,EAA0B;AACxB,gBAAA,QAAQ,CAAR,mBAAA,CAAA,OAAA,EAAA,oBAAA;AACD;;AACD,cAAA,IAAI,CAAJ,QAAA;AA3PJ,aAuPW;;AApPT,YAAA,IAHF,GAAA,MAAA,CAAA,MAAA,GAAA,CAAA,IAAA,MAAA,CAAA,CAAA,CAAA,KAAA,SAAA,GAAA,MAAA,CAAA,CAAA,CAAA,GAAA,EAGE;AACA,YAAA,MAJF,GAAA,MAAA,CAAA,MAAA,GAAA,CAAA,GAAA,MAAA,CAAA,CAAA,CAAA,GAAA,SAIE;AAEM,YAAA,MANR,GAMiB,IAAI,CAAJ,KAAA,GAAa,WAAW,CAAC,MAAM,CAAC,IAAI,CAAZ,KAAO,CAAP,EAAA,CAAA,YAAA,GAAqB,IAAI,CAAzB,MAAA,MAAA,IAAA,IAAA,YAAA,KAAA,KAAA,CAAA,GAAA,YAAA,GAAxB,EAAwB,CAAxB,GAAkE,IAAI,CANvF,MAMQ;AAEA,YAAA,OARR,GAQkB,SAAS,CAAC,IAAI,CAAd,OAAS,CAAT,GAA0B,IAAI,CAA9B,OAAA,GAAyC,SAAS,CAAA,EAAA,EAAA,eAAA,EAAA,CAAA,aAAA,GAA+B,IAAI,CAAnC,OAAA,MAAA,IAAA,IAAA,aAAA,KAAA,KAAA,CAAA,GAAA,aAAA,GARpE,EAQoE,CAA5D;AACA,YAAA,IATR,GAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EAAA,IAAA,CAAA,EAS4B,IAAI,CAThC,IAAA,CASQ;AAEA,YAAA,QAXR,GAAA,CAAA,cAAA,GAWmB,IAAI,CAXvB,QAAA,MAAA,IAAA,IAAA,cAAA,KAAA,KAAA,CAAA,GAAA,cAAA,GAAA,QAWQ;AACA,YAAA,QAZR,GAAA,CAAA,cAAA,GAYmB,IAAI,CAZvB,QAAA,MAAA,IAAA,IAAA,cAAA,KAAA,KAAA,CAAA,GAAA,cAAA,GAYoC,IAAI,CAZxC,IAYQ;AACA,YAAA,gBAbR,GAAA,CAAA,qBAAA,GAa2B,IAAI,CAb/B,gBAAA,MAAA,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,qBAAA,GAAA,eAaQ;AAEA,YAAA,OAfR,GAekB,OAAA,EAAA,KAAA,QAAA,GAAyB,QAAQ,CAAR,aAAA,CAAzB,EAAyB,CAAzB,GAflB,EAeQ;;AAfR,gBAAA,OAAA,EAAA;AAAA,cAAA,SAAA,CAAA,IAAA,GAAA,EAAA;AAAA;AAAA;;AAAA,kBAiBU,IAAA,KAAA,CAAA,GAAA,MAAA,CAAA,EAAA,EAjBV,iBAiBU,CAAA,CAjBV;;AAAA,eAAA,EAAA;AAoBE,gBAAI,IAAI,CAAJ,YAAA,KAAJ,KAAA,EAAiC;AAC/B;AACM,cAAA,EAFyB,GAAA,kBAEzB;AAFyB,cAAA,QAAA,GAGD,OAAO,CAHN,OAGM,CAHN,EAGxB,IAHwB,GAAA,QAAA,CAAA,IAAA,EAGlB,aAHkB,GAAA,QAAA,CAAA,aAAA;;AAI/B,kBAAI,CAAC,IAAI,CAAJ,cAAA,CAAL,EAAK,CAAL,EAA8B;AACtB,gBAAA,KADsB,GACd,QAAQ,CAAR,aAAA,CADc,OACd,CAAR;AACN,gBAAA,KAAK,CAAL,EAAA,GAAA,EAAA;AACA,gBAAA,KAAK,CAAL,SAAA,GACE,IAAI,CAAJ,YAAA,KAAA,SAAA,IAAmC,IAAI,CAAJ,YAAA,KAAnC,IAAA,GACI,UAAA,CADJ,QACI,EADJ,GAEI,IAAI,CAHV,YAAA;AAIA,gBAAA,aAAa,CAAb,WAAA,CAAA,KAAA;AACD;AACF;;AAEK,YAAA,IAnCR,GAmCe,SAAS,CAAA,IAAA,EAAO,IAAI,CAnCnC,IAmCwB,CAAhB;AAEF,YAAA,MArCN,GAqCuB,YAAY,CAAZ,IAAY,CAAZ,CAAA,IAAA,EArCvB,MAqCuB,CAAjB;;AAEJ,gBAAI,IAAI,KAAR,WAAA,EAA0B;AACxB,kBAAI,MAAM,CAAV,OAAA,EAAoB;AACZ,gBAAA,MADY,GACH,YAAY,CAAC,MAAM,CADhB,OACS,CAArB;;AAEN,oBAAI,CAAC,SAAS,CAAC,OAAO,CAAR,IAAA,EAAA,IAAA,MAAA,CAAmB,MAAM,CAAN,OAAA,CAAA,KAAA,CAAjC,CAAiC,CAAnB,CAAA,CAAd,EAA6D;AAC3D,kBAAA,OAAO,CAAP,IAAA,CAAA,+BAAA,MAAA,CAA4C,MAAM,CAAlD,OAAA,EAAA,4BAAA,EAAA,MAAA,CAAuF,OAAO,CAA9F,IAAA,EAAA,GAAA,CAAA;AACD;AACF;AACF;;AAED,YAAA,OAAO,CAAP,SAAA,CAAA,GAAA,CAAA,YAAA;;AACA,gBAAA,OAAA,EAAa;AACX,cAAA,OAAO,CAAP,SAAA,CAAA,GAAA,CAAA,aAAA;AACD;;AACD,YAAA,OAAO,CAAP,SAAA,GArDF,EAqDE,CArDF,CAAA;;AAuDM,YAAA,SAvDN,GAAA,OAuDM;;AACJ,gBAAA,OAAA,EAAa;AACL,cAAA,YADK,GACU,QAAQ,CAAR,aAAA,CADV,KACU,CAAf;AACN,cAAA,YAAY,CAAZ,SAAA,CAAA,GAAA,CAAA,mBAAA;AACA,cAAA,OAAO,CAAP,WAAA,CAAA,YAAA;AACA,cAAA,SAAS,GAAT,YAAA;AACD;;AAEK,YAAA,KA/DR,GA+DgB,IAAI,CA/DpB,KA+DQ;;AACN,gBAAA,KAAA,EAAW;AACT,kBAAI,KAAK,YAAT,QAAA,EAA+B;AAC7B,gBAAA,MAAM,GAAG,KAAK,CAAd,MAAc,CAAd;AADF,eAAA,MAEO;AACL,gBAAA,MAAM,GAAG,UAAU,CAAA,MAAA,EAAA,KAAA,EAAA,IAAA,EAAV,KAAU,CAAV,CAAT,WAAA;AACD;AArEL,aAAA,CAAA;;;AAyEE,gBAAI,IAAI,CAAR,YAAA,EAAuB;AACrB,cAAA,IAAI,CAAJ,YAAA,CAAkB,IAAI,CAAtB,YAAA;AACD;;AAED,gBAAI,IAAI,CAAR,gBAAA,EAA2B;AACzB,cAAA,IAAI,CAAJ,gBAAA,CAAsB,IAAI,CAA1B,gBAAA;AACD;;AAEM,YAAA,GAjFT,GAiFgB,IAjFhB,CAAA,GAiFS,CAjFT,CAAA;AAoFE;;AACM,YAAA,OArFR,GAqFkB,IAAI,CAAJ,KAAA,CAAA,MAAA,EAAmB,IAAI,KAAJ,WAAA,GAAA,EAAA,GAAnB,MAAA,EAAqE;AAAC,cAAA;AAAD,aAArE,CAAV;AAEA,YAAA,IAvFR,GAuFe,KAAK,IAAI,CAAJ,SAAA,IAAkB,IAAI,CAA3B,IAAA,EAAA,OAAA,EAAA,aAAA,CAAA;AAAA,cAAA,MAAA;AAAA,cAAA,QAAA;AAGX,cAAA;AAHW,aAAA,EAIP,GAAG,GAAG;AAAC,cAAA,IAAI,EAAA,CAAA,KAAA,GAAA,CAAA,qBAAA,GAAG,IAAY,CAAf,qBAAA,MAAA,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,qBAAA,GAAyC,IAAI,CAA7C,IAAA,MAAA,IAAA,IAAA,KAAA,KAAA,KAAA,CAAA,GAAA,KAAA,GAAsD;AAA3D,aAAH,GA3FX,EAuFe,CAAA,CAAP;AAON,YAAA,IAAI,CAAJ,iBAAA,CAAA,UAAA,EAAmC,CAAA,CAAA,EAAA,QAAA,KAA2C;AAC5E,kBAAO,IAAP,GAAe,QAAf,CAAA,IAAA;;AACA,kBAAI,IAAI,IAAR,OAAA,EAAqB;AACnB,gBAAA,SAAS,CAAT,SAAA,CAAA,GAAA,CAAA,OAAA;AACA,gBAAA,SAAS,CAAT,SAAA,CAAA,MAAA,CAAA,OAAA;AAFF,eAAA,MAGO,IAAI,IAAI,IAAR,OAAA,EAAqB;AAC1B,gBAAA,SAAS,CAAT,SAAA,CAAA,MAAA,CAAA,OAAA;AACA,gBAAA,SAAS,CAAT,SAAA,CAAA,GAAA,CAAA,OAAA;AAFK,eAAA,MAGA,IAAI,IAAI,IAAR,KAAA,EAAmB;AACxB,gBAAA,SAAS,CAAT,SAAA,CAAA,GAAA,CAAA,OAAA,EAAA,OAAA;AADK,eAAA,MAEA;AACL,gBAAA,SAAS,CAAT,SAAA,CAAA,MAAA,CAAA,OAAA,EAAA,OAAA;AACD;AAZH,aAAA;;AAeA,gBAAI,IAAI,CAAJ,OAAA,KAAJ,KAAA,EAA4B;AAE1B,kBAAI,gBAAgB,CAAC,IAAI,CAAzB,OAAoB,CAApB,EAAoC;AAClC,gBAAA,OAAO,GAAG,IAAI,CAAd,OAAA;AADF,eAAA,MAEO;AACL;AACA,gBAAA,OAAO,GAAG,IAAA,OAAA,CAAY,IAAI,CAAJ,OAAA,KAAA,IAAA,GAAA,EAAA,GAA6B,IAAI,CAA7C,OAAA,EAAV,IAAA;AACD;;AAED,cAAA,IAAI,CAAJ,OAAA,CAAA,OAAA;AACD;;AAEI,YAAA,KAzHP,GAyHgB,IAzHhB,CAAA,KAyHO;;AAEL,gBAAI,KAAK,KAAT,SAAA,EAAyB;AACvB,cAAA,KAAK,GAAG,IAAI,KAAZ,MAAA;AACD;;AAED,gBAAA,KAAA,EAAW;AAAA,cAAA,KAAA,GACsB,OAAA,KAAA,KAAA,SAAA,GAAA,EAAA,GADtB,KAAA,EACF,QADE,GAAA,KAAA,CAAA,QAAA,EACQ,SADR,GAAA,KAAA,CAAA,SAAA;AAGT,cAAA,IAAI,CAAJ,KAAA,CAAA,QAAA,EAAA,SAAA;AACD;;AAED,gBAAA,IAAA,EAAU;AACR,kBAAI,IAAI,CAAJ,KAAA,IAAJ,IAAA,EAAwB;AACtB,gBAAA,IAAI,CAAJ,KAAA,CAAW,IAAI,CAAf,KAAA;AACD;;AACD,kBAAI,IAAI,CAAJ,MAAA,IAAJ,IAAA,EAAyB;AACvB,gBAAA,IAAI,CAAJ,MAAA,CAAY,IAAI,CAAhB,MAAA;AACD;;AACD,kBAAI,IAAI,CAAJ,OAAA,IAAJ,IAAA,EAA0B;AACxB,gBAAA,IAAI,CAAJ,OAAA,CAAa,IAAI,CAAjB,OAAA;AACD;AACF;;AA/IH,YAAA,SAAA,CAAA,IAAA,GAAA,EAAA;AAAA,mBAiJQ,IAAI,CAAJ,UAAA,CAAA,SAAA,EAA2B,IAAI,CAA/B,IAAA,EAjJR,QAiJQ,EAjJR;;AAAA,eAAA,EAAA;AAqJE,gBAAI,OAAO,KAAX,KAAA,EAAuB;AACjB,cAAA,OADiB,GAAA,OACjB;;AAEJ,kBAAI,IAAI,CAAJ,YAAA,KAAJ,KAAA,EAAiC;AACzB,gBAAA,OADyB,GACf,QAAQ,CAAR,aAAA,CADe,SACf,CAAV;AACN,gBAAA,OAAO,CAAP,KAAA,GAAgB,IAAI,CAApB,qBAAA;AACA,gBAAA,OAAO,CAAP,MAAA,CAAA,OAAA;AAEA,gBAAA,OAAO,GAAP,OAAA;AACM,gBAAA,OANyB,GAMf,QAAQ,CAAR,aAAA,CANe,SAMf,CAAV;AACN,gBAAA,OAAO,CAAP,SAAA,GAAA,WAAA;AAEA,gBAAA,OAAO,CAAP,MAAA,CAAA,OAAA;;AAEA,gBAAA,oBAAoB,GAAI,EAAD,IAAmB;AACxC,sBAAI,CAAC,OAAO,CAAP,QAAA,CAAiB,EAAE,CAAxB,MAAK,CAAL,EAAyC;AACvC,oBAAA,OAAO,CAAP,eAAA,CAAA,MAAA;AACD;AAHH,iBAAA;;AAKA,gBAAA,QAAQ,CAAR,gBAAA,CAAA,OAAA,EAAA,oBAAA;AACD;;AAEK,cAAA,IAtBe,GAsBR,QAAQ,CAAR,aAAA,CAtBQ,KAsBR,CAAP;AACN,cAAA,OAAO,CAAP,MAAA,CAAA,IAAA;AACA,cAAA,IAAI,CAAJ,SAAA,CAAA,GAAA,CAxBqB,cAwBrB,EAxBqB,CAAA;;AA2BrB,kBAAI,OAAO,KAAP,IAAA,IAAoB,OAAO,CAAP,MAAA,KAAxB,KAAA,EAAkD;AAAA,gBAAA,KAAA,GAAA,SAAA,KAAA,GAAA;AAC3C,sBAAM,GAAG,GAAA,IAAA,CAAT,EAAS,CAAT;;AACH,sBAAI,OAAO,KAAP,IAAA,IAAoB,OAAO,CAAP,MAAA,KAApB,IAAA,IAAgD,OAAO,CAAP,MAAA,CAApD,GAAoD,CAApD,EAA4G;AAC1G,wBAAM,gBAAgB,GAAI,IAAgC,CAAA,GAAA,MAAA,CAAI,GAAG,CAAP,WAAI,EAAJ,EAA1D,SAA0D,CAAA,CAA1D;AACA,wBAAM,UAAU,GAAG,QAAQ,CAAR,aAAA,CAAnB,GAAmB,CAAnB;AAEA,oBAAA,UAAU,CAAV,IAAA,GAAA,gBAAA;AACA,oBAAA,UAAU,CAAV,IAAA,GAAA,GAAA;AACA,oBAAA,UAAU,CAAV,MAAA,GAAA,QAAA;AACA,oBAAA,UAAU,CAAV,QAAA,GAAA,GAAA,MAAA,CAAA,gBAAA,EAAA,GAAA,EAAA,MAAA,CAP0G,GAO1G,CAAA,CAP0G,CAAA;;AAS1G,oBAAA,UAAU,CAAV,gBAAA,CAAA,WAAA,EAAA,aAAA,YAAA;AAAA,0BAAA,KAAA,GAAA,iBAAA,EAAA,aAAA,mBAAA,CAAA,IAAA,CAAyC,SAAA,QAAA,CAAA,CAAA,EAAA;AAAA,4BAAA,GAAA;AAAA,+BAAA,mBAAA,CAAA,IAAA,CAAA,SAAA,SAAA,CAAA,SAAA,EAAA;AAAA,iCAAA,CAAA,EAAA;AAAA,oCAAA,SAAA,CAAA,IAAA,GAAA,SAAA,CAAA,IAAA;AAAA,mCAAA,CAAA;AACvC,gCAAA,CAAC,CAAD,cAAA;AADuC,gCAAA,SAAA,CAAA,IAAA,GAAA,CAAA;AAAA,uCAErB,IAAI,CAAJ,UAAA,CAAA,GAAA,EAAqB,IAAI,CAFJ,WAErB,CAFqB;;AAAA,mCAAA,CAAA;AAEjC,gCAAA,GAFiC,GAAA,SAAA,CAAA,IAEjC;AACN,qCAAA,IAAA,GAAA,GAAA;;AAHuC,mCAAA,CAAA;AAAA,mCAAA,KAAA;AAAA,uCAAA,SAAA,CAAA,IAAA,EAAA;AAAA;AAAA;AAAA,yBAAA,EAAA,QAAA,EAAA,IAAA,CAAA;AAAzC,uBAAA,CAAA,CAAA;;AAAA,6BAAA,UAAA,GAAA,EAAA;AAAA,+BAAA,KAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,CAAA;AAAA,uBAAA;AAAA,qBAAA,EAAA;AAMA,oBAAA,IAAI,CAAJ,MAAA,CAAA,UAAA;AACD;AAlB6C,iBAAA;;AAChD,qBAAA,EAAA,GAAA,CAAA,EAAA,IAAA,GAAkB,CAAA,KAAA,EAAlB,KAAkB,CAAlB,EAAA,EAAA,GAAA,IAAA,CAAA,MAAA,EAAA,EAAA,EAAA,EAA2C;AAAA,kBAAA,KAAA;AAkB1C;AA9CkB,eAAA,CAAA;;;AAkDrB,kBAAI,OAAO,KAAP,IAAA,IAAoB,OAAO,CAAP,MAAA,KAAxB,KAAA,EAAkD;AAC1C,gBAAA,cAD0C,GACzB,QAAQ,CAAR,aAAA,CADyB,GACzB,CAAjB;AAEN,gBAAA,cAAc,CAAd,IAAA,GAAsB,IAAI,CAA1B,aAAA;AACA,gBAAA,cAAc,CAAd,IAAA,GAAA,GAAA;AACA,gBAAA,cAAc,CAAd,gBAAA,CAAA,OAAA,EAAyC,UAAA,CAAA,EAAiB;AAAA,sBAAA,kBAAA,EAAA,kBAAA;;AACxD,kBAAA,UAAU,CAAC,SAAS,CAAV,IAAU,CAAV,EAAA,CAAA,kBAAA,GAAkB,IAAI,CAAtB,YAAA,MAAA,IAAA,IAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,kBAAA,GAAA,EAAA,EAAA,CAAA,kBAAA,GAA2C,IAAI,CAA/C,YAAA,MAAA,IAAA,IAAA,kBAAA,KAAA,KAAA,CAAA,GAAA,kBAAA,GAAA,EAAA,EAAV,IAAU,CAAV;AACA,kBAAA,CAAC,CAAD,cAAA;AAFF,iBAAA;AAKA,gBAAA,IAAI,CAAJ,MAAA,CAAA,cAAA;AA5DmB,eAAA,CAAA;;;AAgErB,kBAAI,IAAI,KAAJ,WAAA,KAAyB,OAAO,KAAP,IAAA,IAAoB,OAAO,CAAP,QAAA,KAAjD,KAAI,CAAJ,EAA8E;AACtE,gBAAA,WADsE,GACxD,QAAQ,CAAR,aAAA,CADwD,GACxD,CAAd;AAEN,gBAAA,WAAW,CAAX,IAAA,GAAmB,IAAI,CAAvB,eAAA;AACA,gBAAA,WAAW,CAAX,IAAA,GAAA,GAAA;AACA,gBAAA,WAAW,CAAX,gBAAA,CAAA,OAAA,EAAsC,UAAA,CAAA,EAAiB;AAAA,sBAAA,mBAAA,EAAA,mBAAA;;AACrD,kBAAA,UAAU,CAAC,SAAS,CAAV,MAAU,CAAV,EAAA,CAAA,mBAAA,GAAoB,IAAI,CAAxB,YAAA,MAAA,IAAA,IAAA,mBAAA,KAAA,KAAA,CAAA,GAAA,mBAAA,GAAA,EAAA,EAAA,CAAA,mBAAA,GAA6C,IAAI,CAAjD,YAAA,MAAA,IAAA,IAAA,mBAAA,KAAA,KAAA,CAAA,GAAA,mBAAA,GAAA,EAAA,EAAV,MAAU,CAAV;AACA,kBAAA,CAAC,CAAD,cAAA;AAFF,iBAAA;AAKA,gBAAA,IAAI,CAAJ,MAAA,CAAA,WAAA;AA1EmB,eAAA,CAAA;;;AA8ErB,kBAAI,OAAO,KAAP,IAAA,IAAoB,OAAO,CAAP,MAAA,KAAxB,KAAA,EAAkD;AAC1C,gBAAA,SAD0C,GAAA,CAAA,eAAA,GAC9B,IAAI,CAD0B,SAAA,MAAA,IAAA,IAAA,eAAA,KAAA,KAAA,CAAA,GAAA,eAAA,GAAA,gCAC1C;AACA,gBAAA,UAF0C,GAE7B,QAAQ,CAAR,aAAA,CAF6B,GAE7B,CAAb;AAEN,gBAAA,UAAU,CAAV,IAAA,GAAkB,IAAI,CAAtB,aAAA;AACA,gBAAA,UAAU,CAAV,IAAA,GAAA,GAAA;AACA,gBAAA,UAAU,CAAV,gBAAA,CAAA,OAAA,EAAqC,UAAA,CAAA,EAAiB;AACpD,kBAAA,IAAI,CAAA,MAAA,EAAA,SAAA,EAAoB;AACtB,oBAAA,MAAM,EADgB,MAAA;AAAA,oBAAA,IAAA;AAAA,oBAAA,QAAA;AAItB,oBAAA,IAAI,EAAE,SAAS,CAAA,IAAA;AAJO,mBAApB,CAAJ;AAMA,kBAAA,CAAC,CAAD,cAAA;AAPF,iBAAA;AAUA,gBAAA,IAAI,CAAJ,MAAA,CAAA,UAAA;AACD;AACF;;AArPH,mBAAA,SAAA,CAAA,MAAA,CAAA,QAAA,EA8PS;AAAA,cAAA,IAAA;AAAA,cAAA,IAAA;AAAA,cAAA,MAAA;AAAqB,cAAA;AAArB,aA9PT,CAAA;;AAAA,eAAA,EAAA;AAAA,eAAA,KAAA;AAAA,mBAAA,SAAA,CAAA,IAAA,EAAA;AAAA;AAAA;AAAA,KAAA,EAAA,QAAA,CAAA;AAAA,G","sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\"use strict\";\n\nvar Op = Object.prototype;\nvar hasOwn = Op.hasOwnProperty;\nvar undefined; // More compressible than void 0.\nvar $Symbol = typeof Symbol === \"function\" ? Symbol : {};\nvar iteratorSymbol = $Symbol.iterator || \"@@iterator\";\nvar asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\nvar toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\nfunction wrap(innerFn, outerFn, self, tryLocsList) {\n  // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n  var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n  var generator = Object.create(protoGenerator.prototype);\n  var context = new Context(tryLocsList || []);\n\n  // The ._invoke method unifies the implementations of the .next,\n  // .throw, and .return methods.\n  generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n  return generator;\n}\n\n// Try/catch helper to minimize deoptimizations. Returns a completion\n// record like context.tryEntries[i].completion. This interface could\n// have been (and was previously) designed to take a closure to be\n// invoked without arguments, but in all the cases we care about we\n// already have an existing method we want to call, so there's no need\n// to create a new function object. We can even get away with assuming\n// the method takes exactly one argument, since that happens to be true\n// in every case, so we don't have to touch the arguments object. The\n// only additional allocation required is the completion record, which\n// has a stable shape and so hopefully should be cheap to allocate.\nfunction tryCatch(fn, obj, arg) {\n  try {\n    return { type: \"normal\", arg: fn.call(obj, arg) };\n  } catch (err) {\n    return { type: \"throw\", arg: err };\n  }\n}\n\nvar GenStateSuspendedStart = \"suspendedStart\";\nvar GenStateSuspendedYield = \"suspendedYield\";\nvar GenStateExecuting = \"executing\";\nvar GenStateCompleted = \"completed\";\n\n// Returning this object from the innerFn has the same effect as\n// breaking out of the dispatch switch statement.\nvar ContinueSentinel = {};\n\n// Dummy constructor functions that we use as the .constructor and\n// .constructor.prototype properties for functions that return Generator\n// objects. For full spec compliance, you may wish to configure your\n// minifier not to mangle the names of these two functions.\nfunction Generator() {}\nfunction GeneratorFunction() {}\nfunction GeneratorFunctionPrototype() {}\n\n// This is a polyfill for %IteratorPrototype% for environments that\n// don't natively support it.\nvar IteratorPrototype = {};\nIteratorPrototype[iteratorSymbol] = function () {\n  return this;\n};\n\nvar getProto = Object.getPrototypeOf;\nvar NativeIteratorPrototype = getProto && getProto(getProto(values([])));\nif (NativeIteratorPrototype &&\n  NativeIteratorPrototype !== Op &&\n  hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n  // This environment has a native %IteratorPrototype%; use it instead\n  // of the polyfill.\n  IteratorPrototype = NativeIteratorPrototype;\n}\n\nvar Gp = GeneratorFunctionPrototype.prototype =\n  Generator.prototype = Object.create(IteratorPrototype);\nGeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\nGeneratorFunctionPrototype.constructor = GeneratorFunction;\nGeneratorFunctionPrototype[toStringTagSymbol] =\n  GeneratorFunction.displayName = \"GeneratorFunction\";\n\n// Helper for defining the .next, .throw, and .return methods of the\n// Iterator interface in terms of a single ._invoke method.\nfunction defineIteratorMethods(prototype) {\n  [\"next\", \"throw\", \"return\"].forEach(function(method) {\n    prototype[method] = function(arg) {\n      return this._invoke(method, arg);\n    };\n  });\n}\n\nfunction isGeneratorFunction (genFun) {\n  var ctor = typeof genFun === \"function\" && genFun.constructor;\n  return ctor\n    ? ctor === GeneratorFunction ||\n    // For the native GeneratorFunction constructor, the best we can\n    // do is to check its .name property.\n    (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n    : false;\n};\n\nfunction mark (genFun) {\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n  } else {\n    genFun.__proto__ = GeneratorFunctionPrototype;\n    if (!(toStringTagSymbol in genFun)) {\n      genFun[toStringTagSymbol] = \"GeneratorFunction\";\n    }\n  }\n  genFun.prototype = Object.create(Gp);\n  return genFun;\n};\n\n// Within the body of any async function, `await x` is transformed to\n// `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n// `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n// meant to be awaited.\nfunction awrap (arg) {\n  return { __await: arg };\n};\n\nfunction AsyncIterator(generator, PromiseImpl) {\n  function invoke(method, arg, resolve, reject) {\n    var record = tryCatch(generator[method], generator, arg);\n    if (record.type === \"throw\") {\n      reject(record.arg);\n    } else {\n      var result = record.arg;\n      var value = result.value;\n      if (value &&\n        typeof value === \"object\" &&\n        hasOwn.call(value, \"__await\")) {\n        return PromiseImpl.resolve(value.__await).then(function(value) {\n          invoke(\"next\", value, resolve, reject);\n        }, function(err) {\n          invoke(\"throw\", err, resolve, reject);\n        });\n      }\n\n      return PromiseImpl.resolve(value).then(function(unwrapped) {\n        // When a yielded Promise is resolved, its final value becomes\n        // the .value of the Promise<{value,done}> result for the\n        // current iteration.\n        result.value = unwrapped;\n        resolve(result);\n      }, function(error) {\n        // If a rejected Promise was yielded, throw the rejection back\n        // into the async generator function so it can be handled there.\n        return invoke(\"throw\", error, resolve, reject);\n      });\n    }\n  }\n\n  var previousPromise;\n\n  function enqueue(method, arg) {\n    function callInvokeWithMethodAndArg() {\n      return new PromiseImpl(function(resolve, reject) {\n        invoke(method, arg, resolve, reject);\n      });\n    }\n\n    return previousPromise =\n      // If enqueue has been called before, then we want to wait until\n      // all previous Promises have been resolved before calling invoke,\n      // so that results are always delivered in the correct order. If\n      // enqueue has not been called before, then it is important to\n      // call invoke immediately, without waiting on a callback to fire,\n      // so that the async generator function has the opportunity to do\n      // any necessary setup in a predictable way. This predictability\n      // is why the Promise constructor synchronously invokes its\n      // executor callback, and why async functions synchronously\n      // execute code before the first await. Since we implement simple\n      // async functions in terms of async generators, it is especially\n      // important to get this right, even though it requires care.\n      previousPromise ? previousPromise.then(\n        callInvokeWithMethodAndArg,\n        // Avoid propagating failures to Promises returned by later\n        // invocations of the iterator.\n        callInvokeWithMethodAndArg\n      ) : callInvokeWithMethodAndArg();\n  }\n\n  // Define the unified helper method that is used to implement .next,\n  // .throw, and .return (see defineIteratorMethods).\n  this._invoke = enqueue;\n}\n\ndefineIteratorMethods(AsyncIterator.prototype);\nAsyncIterator.prototype[asyncIteratorSymbol] = function () {\n  return this;\n};\n\n// Note that simple async functions are implemented on top of\n// AsyncIterator objects; they just return a Promise for the value of\n// the final result produced by the iterator.\n function async (innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n  if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n  var iter = new AsyncIterator(\n    wrap(innerFn, outerFn, self, tryLocsList),\n    PromiseImpl\n  );\n\n  return isGeneratorFunction(outerFn)\n    ? iter // If outerFn is a generator, return the full iterator.\n    : iter.next().then(function(result) {\n      return result.done ? result.value : iter.next();\n    });\n};\n\nfunction makeInvokeMethod(innerFn, self, context) {\n  var state = GenStateSuspendedStart;\n\n  return function invoke(method, arg) {\n    if (state === GenStateExecuting) {\n      throw new Error(\"Generator is already running\");\n    }\n\n    if (state === GenStateCompleted) {\n      if (method === \"throw\") {\n        throw arg;\n      }\n\n      // Be forgiving, per 25.3.3.3.3 of the spec:\n      // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n      return doneResult();\n    }\n\n    context.method = method;\n    context.arg = arg;\n\n    while (true) {\n      var delegate = context.delegate;\n      if (delegate) {\n        var delegateResult = maybeInvokeDelegate(delegate, context);\n        if (delegateResult) {\n          if (delegateResult === ContinueSentinel) continue;\n          return delegateResult;\n        }\n      }\n\n      if (context.method === \"next\") {\n        // Setting context._sent for legacy support of Babel's\n        // function.sent implementation.\n        context.sent = context._sent = context.arg;\n\n      } else if (context.method === \"throw\") {\n        if (state === GenStateSuspendedStart) {\n          state = GenStateCompleted;\n          throw context.arg;\n        }\n\n        context.dispatchException(context.arg);\n\n      } else if (context.method === \"return\") {\n        context.abrupt(\"return\", context.arg);\n      }\n\n      state = GenStateExecuting;\n\n      var record = tryCatch(innerFn, self, context);\n      if (record.type === \"normal\") {\n        // If an exception is thrown from innerFn, we leave state ===\n        // GenStateExecuting and loop back for another invocation.\n        state = context.done\n          ? GenStateCompleted\n          : GenStateSuspendedYield;\n\n        if (record.arg === ContinueSentinel) {\n          continue;\n        }\n\n        return {\n          value: record.arg,\n          done: context.done\n        };\n\n      } else if (record.type === \"throw\") {\n        state = GenStateCompleted;\n        // Dispatch the exception by looping back around to the\n        // context.dispatchException(context.arg) call above.\n        context.method = \"throw\";\n        context.arg = record.arg;\n      }\n    }\n  };\n}\n\n// Call delegate.iterator[context.method](context.arg) and handle the\n// result, either by returning a { value, done } result from the\n// delegate iterator, or by modifying context.method and context.arg,\n// setting context.delegate to null, and returning the ContinueSentinel.\nfunction maybeInvokeDelegate(delegate, context) {\n  var method = delegate.iterator[context.method];\n  if (method === undefined) {\n    // A .throw or .return when the delegate iterator has no .throw\n    // method always terminates the yield* loop.\n    context.delegate = null;\n\n    if (context.method === \"throw\") {\n      // Note: [\"return\"] must be used for ES3 parsing compatibility.\n      if (delegate.iterator[\"return\"]) {\n        // If the delegate iterator has a return method, give it a\n        // chance to clean up.\n        context.method = \"return\";\n        context.arg = undefined;\n        maybeInvokeDelegate(delegate, context);\n\n        if (context.method === \"throw\") {\n          // If maybeInvokeDelegate(context) changed context.method from\n          // \"return\" to \"throw\", let that override the TypeError below.\n          return ContinueSentinel;\n        }\n      }\n\n      context.method = \"throw\";\n      context.arg = new TypeError(\n        \"The iterator does not provide a 'throw' method\");\n    }\n\n    return ContinueSentinel;\n  }\n\n  var record = tryCatch(method, delegate.iterator, context.arg);\n\n  if (record.type === \"throw\") {\n    context.method = \"throw\";\n    context.arg = record.arg;\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  var info = record.arg;\n\n  if (! info) {\n    context.method = \"throw\";\n    context.arg = new TypeError(\"iterator result is not an object\");\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  if (info.done) {\n    // Assign the result of the finished delegate to the temporary\n    // variable specified by delegate.resultName (see delegateYield).\n    context[delegate.resultName] = info.value;\n\n    // Resume execution at the desired location (see delegateYield).\n    context.next = delegate.nextLoc;\n\n    // If context.method was \"throw\" but the delegate handled the\n    // exception, let the outer generator proceed normally. If\n    // context.method was \"next\", forget context.arg since it has been\n    // \"consumed\" by the delegate iterator. If context.method was\n    // \"return\", allow the original .return call to continue in the\n    // outer generator.\n    if (context.method !== \"return\") {\n      context.method = \"next\";\n      context.arg = undefined;\n    }\n\n  } else {\n    // Re-yield the result returned by the delegate method.\n    return info;\n  }\n\n  // The delegate iterator is finished, so forget it and continue with\n  // the outer generator.\n  context.delegate = null;\n  return ContinueSentinel;\n}\n\n// Define Generator.prototype.{next,throw,return} in terms of the\n// unified ._invoke helper method.\ndefineIteratorMethods(Gp);\n\nGp[toStringTagSymbol] = \"Generator\";\n\n// A Generator should always return itself as the iterator object when the\n// @@iterator function is called on it. Some browsers' implementations of the\n// iterator prototype chain incorrectly implement this, causing the Generator\n// object to not be returned from this call. This ensures that doesn't happen.\n// See https://github.com/facebook/regenerator/issues/274 for more details.\nGp[iteratorSymbol] = function() {\n  return this;\n};\n\nGp.toString = function() {\n  return \"[object Generator]\";\n};\n\nfunction pushTryEntry(locs) {\n  var entry = { tryLoc: locs[0] };\n\n  if (1 in locs) {\n    entry.catchLoc = locs[1];\n  }\n\n  if (2 in locs) {\n    entry.finallyLoc = locs[2];\n    entry.afterLoc = locs[3];\n  }\n\n  this.tryEntries.push(entry);\n}\n\nfunction resetTryEntry(entry) {\n  var record = entry.completion || {};\n  record.type = \"normal\";\n  delete record.arg;\n  entry.completion = record;\n}\n\nfunction Context(tryLocsList) {\n  // The root entry object (effectively a try statement without a catch\n  // or a finally block) gives us a place to store values thrown from\n  // locations where there is no enclosing try statement.\n  this.tryEntries = [{ tryLoc: \"root\" }];\n  tryLocsList.forEach(pushTryEntry, this);\n  this.reset(true);\n}\n\nfunction keys (object) {\n  var keys = [];\n  for (var key in object) {\n    keys.push(key);\n  }\n  keys.reverse();\n\n  // Rather than returning an object with a next method, we keep\n  // things simple and return the next function itself.\n  return function next() {\n    while (keys.length) {\n      var key = keys.pop();\n      if (key in object) {\n        next.value = key;\n        next.done = false;\n        return next;\n      }\n    }\n\n    // To avoid creating an additional object, we just hang the .value\n    // and .done properties off the next function object itself. This\n    // also ensures that the minifier will not anonymize the function.\n    next.done = true;\n    return next;\n  };\n};\n\nfunction values(iterable) {\n  if (iterable) {\n    var iteratorMethod = iterable[iteratorSymbol];\n    if (iteratorMethod) {\n      return iteratorMethod.call(iterable);\n    }\n\n    if (typeof iterable.next === \"function\") {\n      return iterable;\n    }\n\n    if (!isNaN(iterable.length)) {\n      var i = -1, next = function next() {\n        while (++i < iterable.length) {\n          if (hasOwn.call(iterable, i)) {\n            next.value = iterable[i];\n            next.done = false;\n            return next;\n          }\n        }\n\n        next.value = undefined;\n        next.done = true;\n\n        return next;\n      };\n\n      return next.next = next;\n    }\n  }\n\n  // Return an iterator with no values.\n  return { next: doneResult };\n}\n\nfunction doneResult() {\n  return { value: undefined, done: true };\n}\n\nContext.prototype = {\n  constructor: Context,\n\n  reset: function(skipTempReset) {\n    this.prev = 0;\n    this.next = 0;\n    // Resetting context._sent for legacy support of Babel's\n    // function.sent implementation.\n    this.sent = this._sent = undefined;\n    this.done = false;\n    this.delegate = null;\n\n    this.method = \"next\";\n    this.arg = undefined;\n\n    this.tryEntries.forEach(resetTryEntry);\n\n    if (!skipTempReset) {\n      for (var name in this) {\n        // Not sure about the optimal order of these conditions:\n        if (name.charAt(0) === \"t\" &&\n          hasOwn.call(this, name) &&\n          !isNaN(+name.slice(1))) {\n          this[name] = undefined;\n        }\n      }\n    }\n  },\n\n  stop: function() {\n    this.done = true;\n\n    var rootEntry = this.tryEntries[0];\n    var rootRecord = rootEntry.completion;\n    if (rootRecord.type === \"throw\") {\n      throw rootRecord.arg;\n    }\n\n    return this.rval;\n  },\n\n  dispatchException: function(exception) {\n    if (this.done) {\n      throw exception;\n    }\n\n    var context = this;\n    function handle(loc, caught) {\n      record.type = \"throw\";\n      record.arg = exception;\n      context.next = loc;\n\n      if (caught) {\n        // If the dispatched exception was caught by a catch block,\n        // then let that catch block handle the exception normally.\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n      return !! caught;\n    }\n\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n      var record = entry.completion;\n\n      if (entry.tryLoc === \"root\") {\n        // Exception thrown outside of any try block that could handle\n        // it, so set the completion value of the entire function to\n        // throw the exception.\n        return handle(\"end\");\n      }\n\n      if (entry.tryLoc <= this.prev) {\n        var hasCatch = hasOwn.call(entry, \"catchLoc\");\n        var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n        if (hasCatch && hasFinally) {\n          if (this.prev < entry.catchLoc) {\n            return handle(entry.catchLoc, true);\n          } else if (this.prev < entry.finallyLoc) {\n            return handle(entry.finallyLoc);\n          }\n\n        } else if (hasCatch) {\n          if (this.prev < entry.catchLoc) {\n            return handle(entry.catchLoc, true);\n          }\n\n        } else if (hasFinally) {\n          if (this.prev < entry.finallyLoc) {\n            return handle(entry.finallyLoc);\n          }\n\n        } else {\n          throw new Error(\"try statement without catch or finally\");\n        }\n      }\n    }\n  },\n\n  abrupt: function(type, arg) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n      if (entry.tryLoc <= this.prev &&\n        hasOwn.call(entry, \"finallyLoc\") &&\n        this.prev < entry.finallyLoc) {\n        var finallyEntry = entry;\n        break;\n      }\n    }\n\n    if (finallyEntry &&\n      (type === \"break\" ||\n        type === \"continue\") &&\n      finallyEntry.tryLoc <= arg &&\n      arg <= finallyEntry.finallyLoc) {\n      // Ignore the finally entry if control is not jumping to a\n      // location outside the try/catch block.\n      finallyEntry = null;\n    }\n\n    var record = finallyEntry ? finallyEntry.completion : {};\n    record.type = type;\n    record.arg = arg;\n\n    if (finallyEntry) {\n      this.method = \"next\";\n      this.next = finallyEntry.finallyLoc;\n      return ContinueSentinel;\n    }\n\n    return this.complete(record);\n  },\n\n  complete: function(record, afterLoc) {\n    if (record.type === \"throw\") {\n      throw record.arg;\n    }\n\n    if (record.type === \"break\" ||\n      record.type === \"continue\") {\n      this.next = record.arg;\n    } else if (record.type === \"return\") {\n      this.rval = this.arg = record.arg;\n      this.method = \"return\";\n      this.next = \"end\";\n    } else if (record.type === \"normal\" && afterLoc) {\n      this.next = afterLoc;\n    }\n\n    return ContinueSentinel;\n  },\n\n  finish: function(finallyLoc) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n      if (entry.finallyLoc === finallyLoc) {\n        this.complete(entry.completion, entry.afterLoc);\n        resetTryEntry(entry);\n        return ContinueSentinel;\n      }\n    }\n  },\n\n  \"catch\": function(tryLoc) {\n    for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n      var entry = this.tryEntries[i];\n      if (entry.tryLoc === tryLoc) {\n        var record = entry.completion;\n        if (record.type === \"throw\") {\n          var thrown = record.arg;\n          resetTryEntry(entry);\n        }\n        return thrown;\n      }\n    }\n\n    // The context.catch method must only be called with a location\n    // argument that corresponds to a known catch block.\n    throw new Error(\"illegal catch attempt\");\n  },\n\n  delegateYield: function(iterable, resultName, nextLoc) {\n    this.delegate = {\n      iterator: values(iterable),\n      resultName: resultName,\n      nextLoc: nextLoc\n    };\n\n    if (this.method === \"next\") {\n      // Deliberately forget the last sent value so that we don't\n      // accidentally pass it on to the delegate.\n      this.arg = undefined;\n    }\n\n    return ContinueSentinel;\n  }\n};\n\n// Export a default namespace that plays well with Rollup\nexport default {\n  wrap,\n  isGeneratorFunction,\n  AsyncIterator,\n  mark,\n  awrap,\n  async,\n  keys,\n  values\n};\n","import {MessageData} from './types';\n\n/**\n * Open editor url in a new window, and pass a message.\n */\nexport default function (window: Window, url: string, data: MessageData) {\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const editor = window.open(url)!;\n  const wait = 10000;\n  const step = 250;\n  const {origin} = new URL(url);\n  // eslint-disable-next-line no-bitwise\n  let count = ~~(wait / step);\n\n  function listen(evt: MessageEvent) {\n    if (evt.source === editor) {\n      count = 0;\n      window.removeEventListener('message', listen, false);\n    }\n  }\n  window.addEventListener('message', listen, false);\n\n  // send message\n  // periodically resend until ack received or timeout\n  function send() {\n    if (count <= 0) {\n      return;\n    }\n    editor.postMessage(data, origin);\n    setTimeout(send, step);\n    count -= 1;\n  }\n  setTimeout(send, step);\n}\n","// generated with build-style.sh\nexport default `.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: \"\";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper.fit-x {\n    width: 100%; }\n  .vega-embed .chart-wrapper.fit-y {\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n`;\n","import {writeConfig} from 'vega';\n\n// polyfill for IE\nif (!String.prototype.startsWith) {\n  // eslint-disable-next-line no-extend-native,func-names\n  String.prototype.startsWith = function (search, pos) {\n    return this.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n  };\n}\n\nexport function isURL(s: string): boolean {\n  return s.startsWith('http://') || s.startsWith('https://') || s.startsWith('//');\n}\n\nexport type DeepPartial<T> = {[P in keyof T]?: P extends unknown ? unknown : DeepPartial<T[P]>};\n\nexport function mergeDeep<T>(dest: T, ...src: readonly DeepPartial<T>[]): T {\n  for (const s of src) {\n    deepMerge_(dest, s);\n  }\n  return dest;\n}\n\nfunction deepMerge_(dest: any, src: any) {\n  for (const property of Object.keys(src)) {\n    writeConfig(dest, property, src[property], true);\n  }\n}\n","import {applyPatch, Operation} from 'fast-json-patch';\nimport stringify from 'json-stringify-pretty-compact';\nimport {satisfies} from 'semver';\nimport * as vegaImport from 'vega';\nimport {\n  AutoSize,\n  Config as VgConfig,\n  EncodeEntryName,\n  isBoolean,\n  isString,\n  Loader,\n  LoaderOptions,\n  mergeConfig,\n  Renderers,\n  Spec as VgSpec,\n  TooltipHandler,\n  View,\n} from 'vega';\nimport {expressionInterpreter} from 'vega-interpreter';\nimport * as vegaLiteImport from 'vega-lite';\nimport {Config as VlConfig, TopLevelSpec as VlSpec} from 'vega-lite';\nimport schemaParser from 'vega-schema-url-parser';\nimport * as themes from 'vega-themes';\nimport {Handler, Options as TooltipOptions} from 'vega-tooltip';\nimport post from './post';\nimport embedStyle from './style';\nimport {Config, Mode} from './types';\nimport {mergeDeep} from './util';\nimport pkg from '../package.json';\n\nexport const version = pkg.version;\n\nexport * from './types';\n\nexport const vega = vegaImport;\nexport let vegaLite = vegaLiteImport;\n\n// For backwards compatibility with Vega-Lite before v4.\nconst w = (typeof window !== 'undefined' ? window : undefined) as any;\nif (vegaLite === undefined && w?.['vl']?.compile) {\n  vegaLite = w['vl'];\n}\n\nexport interface Actions {\n  export?: boolean | {svg?: boolean; png?: boolean};\n  source?: boolean;\n  compiled?: boolean;\n  editor?: boolean;\n}\n\nexport const DEFAULT_ACTIONS = {export: {svg: true, png: true}, source: true, compiled: true, editor: true};\n\nexport interface Hover {\n  hoverSet?: EncodeEntryName;\n  updateSet?: EncodeEntryName;\n}\n\nexport type PatchFunc = (spec: VgSpec) => VgSpec;\n\nconst I18N = {\n  CLICK_TO_VIEW_ACTIONS: 'Click to view actions',\n  COMPILED_ACTION: 'View Compiled Vega',\n  EDITOR_ACTION: 'Open in Vega Editor',\n  PNG_ACTION: 'Save as PNG',\n  SOURCE_ACTION: 'View Source',\n  SVG_ACTION: 'Save as SVG',\n};\n\nexport interface EmbedOptions<S = string, R = Renderers> {\n  bind?: HTMLElement | string;\n  actions?: boolean | Actions;\n  mode?: Mode;\n  theme?: 'excel' | 'ggplot2' | 'quartz' | 'vox' | 'dark';\n  defaultStyle?: boolean | string;\n  logLevel?: number;\n  loader?: Loader | LoaderOptions;\n  renderer?: R;\n  tooltip?: TooltipHandler | TooltipOptions | boolean;\n  patch?: S | PatchFunc | Operation[];\n  width?: number;\n  height?: number;\n  padding?: number | {left?: number; right?: number; top?: number; bottom?: number};\n  scaleFactor?: number;\n  config?: S | Config;\n  sourceHeader?: string;\n  sourceFooter?: string;\n  editorUrl?: string;\n  hover?: boolean | Hover;\n  i18n?: Partial<typeof I18N>;\n  downloadFileName?: string;\n  formatLocale?: Record<string, unknown>;\n  timeFormatLocale?: Record<string, unknown>;\n  ast?: boolean;\n  expr?: typeof expressionInterpreter;\n  viewClass?: typeof View;\n}\n\nconst NAMES: {[key in Mode]: string} = {\n  vega: 'Vega',\n  'vega-lite': 'Vega-Lite',\n};\n\nconst VERSION = {\n  vega: vega.version,\n  'vega-lite': vegaLite ? vegaLite.version : 'not available',\n};\n\nconst PREPROCESSOR: {[mode in Mode]: (spec: any, config?: Config) => VgSpec} = {\n  vega: (vgSpec: VgSpec) => vgSpec,\n  'vega-lite': (vlSpec, config) => vegaLite.compile(vlSpec as VlSpec, {config: config as VlConfig}).spec,\n};\n\nconst SVG_CIRCLES = `\n<svg viewBox=\"0 0 16 16\" fill=\"currentColor\" stroke=\"none\" stroke-width=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n  <circle r=\"2\" cy=\"8\" cx=\"2\"></circle>\n  <circle r=\"2\" cy=\"8\" cx=\"8\"></circle>\n  <circle r=\"2\" cy=\"8\" cx=\"14\"></circle>\n</svg>`;\n\nconst CHART_WRAPPER_CLASS = 'chart-wrapper';\n\nexport type VisualizationSpec = VlSpec | VgSpec;\n\nexport interface Result {\n  /** The Vega view. */\n  view: View;\n\n  /** The input specification. */\n  spec: VisualizationSpec;\n\n  /** The compiled and patched Vega specification. */\n  vgSpec: VgSpec;\n\n  /** Removes references to unwanted behaviors and memory leaks. Calls Vega's `view.finalize`.  */\n  finalize: () => void;\n}\n\nfunction isTooltipHandler(h?: boolean | TooltipOptions | TooltipHandler): h is TooltipHandler {\n  return typeof h === 'function';\n}\n\nfunction viewSource(source: string, sourceHeader: string, sourceFooter: string, mode: Mode) {\n  const header = `<html><head>${sourceHeader}</head><body><pre><code class=\"json\">`;\n  const footer = `</code></pre>${sourceFooter}</body></html>`;\n  // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n  const win = window.open('')!;\n  win.document.write(header + source + footer);\n  win.document.title = `${NAMES[mode]} JSON Source`;\n}\n\n/**\n * Try to guess the type of spec.\n *\n * @param spec Vega or Vega-Lite spec.\n */\nexport function guessMode(spec: VisualizationSpec, providedMode?: Mode): Mode {\n  // Decide mode\n  if (spec.$schema) {\n    const parsed = schemaParser(spec.$schema);\n    if (providedMode && providedMode !== parsed.library) {\n      console.warn(\n        `The given visualization spec is written in ${NAMES[parsed.library]}, but mode argument sets ${\n          NAMES[providedMode] ?? providedMode\n        }.`\n      );\n    }\n\n    const mode = parsed.library as Mode;\n\n    if (!satisfies(VERSION[mode], `^${parsed.version.slice(1)}`)) {\n      console.warn(\n        `The input spec uses ${NAMES[mode]} ${parsed.version}, but the current version of ${NAMES[mode]} is v${VERSION[mode]}.`\n      );\n    }\n\n    return mode;\n  }\n\n  // try to guess from the provided spec\n  if (\n    'mark' in spec ||\n    'encoding' in spec ||\n    'layer' in spec ||\n    'hconcat' in spec ||\n    'vconcat' in spec ||\n    'facet' in spec ||\n    'repeat' in spec\n  ) {\n    return 'vega-lite';\n  }\n\n  if ('marks' in spec || 'signals' in spec || 'scales' in spec || 'axes' in spec) {\n    return 'vega';\n  }\n\n  return providedMode ?? 'vega';\n}\n\nfunction isLoader(o?: LoaderOptions | Loader): o is Loader {\n  return !!(o && 'load' in o);\n}\n\nfunction createLoader(opts?: Loader | LoaderOptions) {\n  return isLoader(opts) ? opts : vega.loader(opts);\n}\n\nfunction embedOptionsFromUsermeta(parsedSpec: VisualizationSpec) {\n  return (parsedSpec.usermeta && (parsedSpec.usermeta as any)['embedOptions']) ?? {};\n}\n\n/**\n * Embed a Vega visualization component in a web page. This function returns a promise.\n *\n * @param el        DOM element in which to place component (DOM node or CSS selector).\n * @param spec      String : A URL string from which to load the Vega specification.\n *                  Object : The Vega/Vega-Lite specification as a parsed JSON object.\n * @param opts       A JavaScript object containing options for embedding.\n */\nexport default async function embed(\n  el: HTMLElement | string,\n  spec: VisualizationSpec | string,\n  opts: EmbedOptions = {}\n): Promise<Result> {\n  let parsedSpec: VisualizationSpec;\n  let loader: Loader | undefined;\n\n  if (isString(spec)) {\n    loader = createLoader(opts.loader);\n    parsedSpec = JSON.parse(await loader.load(spec));\n  } else {\n    parsedSpec = spec;\n  }\n\n  const usermetaLoader = embedOptionsFromUsermeta(parsedSpec).loader;\n\n  // either create the loader for the first time or create a new loader if the spec has new loader options\n  if (!loader || usermetaLoader) {\n    loader = createLoader(opts.loader ?? usermetaLoader);\n  }\n\n  const usermetaOpts = await loadOpts(embedOptionsFromUsermeta(parsedSpec), loader);\n  const parsedOpts = await loadOpts(opts, loader);\n\n  const mergedOpts = {\n    ...mergeDeep(parsedOpts, usermetaOpts),\n    config: mergeConfig(parsedOpts.config ?? {}, usermetaOpts.config ?? {}),\n  };\n\n  return await _embed(el, parsedSpec, mergedOpts, loader);\n}\n\nasync function loadOpts(opt: EmbedOptions, loader: Loader): Promise<EmbedOptions<never>> {\n  const config: Config = isString(opt.config) ? JSON.parse(await loader.load(opt.config)) : opt.config ?? {};\n  const patch: PatchFunc | Operation[] = isString(opt.patch) ? JSON.parse(await loader.load(opt.patch)) : opt.patch;\n  return {\n    ...(opt as any),\n    ...(patch ? {patch} : {}),\n    ...(config ? {config} : {}),\n  };\n}\n\nfunction getRoot(el: Element) {\n  const possibleRoot = el.getRootNode ? el.getRootNode() : document;\n  if (possibleRoot instanceof ShadowRoot) {\n    return {root: possibleRoot, rootContainer: possibleRoot};\n  } else {\n    return {root: document, rootContainer: document.head ?? document.body};\n  }\n}\n\nasync function _embed(\n  el: HTMLElement | string,\n  spec: VisualizationSpec,\n  opts: EmbedOptions<never> = {},\n  loader: Loader\n): Promise<Result> {\n  const config = opts.theme ? mergeConfig(themes[opts.theme], opts.config ?? {}) : opts.config;\n\n  const actions = isBoolean(opts.actions) ? opts.actions : mergeDeep<Actions>({}, DEFAULT_ACTIONS, opts.actions ?? {});\n  const i18n = {...I18N, ...opts.i18n};\n\n  const renderer = opts.renderer ?? 'canvas';\n  const logLevel = opts.logLevel ?? vega.Warn;\n  const downloadFileName = opts.downloadFileName ?? 'visualization';\n\n  const element = typeof el === 'string' ? document.querySelector(el) : el;\n  if (!element) {\n    throw new Error(`${el} does not exist`);\n  }\n\n  if (opts.defaultStyle !== false) {\n    // Add a default stylesheet to the head of the document.\n    const ID = 'vega-embed-style';\n    const {root, rootContainer} = getRoot(element);\n    if (!root.getElementById(ID)) {\n      const style = document.createElement('style');\n      style.id = ID;\n      style.innerText =\n        opts.defaultStyle === undefined || opts.defaultStyle === true\n          ? (embedStyle ?? '').toString()\n          : opts.defaultStyle;\n      rootContainer.appendChild(style);\n    }\n  }\n\n  const mode = guessMode(spec, opts.mode);\n\n  let vgSpec: VgSpec = PREPROCESSOR[mode](spec, config);\n\n  if (mode === 'vega-lite') {\n    if (vgSpec.$schema) {\n      const parsed = schemaParser(vgSpec.$schema);\n\n      if (!satisfies(VERSION.vega, `^${parsed.version.slice(1)}`)) {\n        console.warn(`The compiled spec uses Vega ${parsed.version}, but current version is v${VERSION.vega}.`);\n      }\n    }\n  }\n\n  element.classList.add('vega-embed');\n  if (actions) {\n    element.classList.add('has-actions');\n  }\n  element.innerHTML = ''; // clear container\n\n  let container = element;\n  if (actions) {\n    const chartWrapper = document.createElement('div');\n    chartWrapper.classList.add(CHART_WRAPPER_CLASS);\n    element.appendChild(chartWrapper);\n    container = chartWrapper;\n  }\n\n  const patch = opts.patch;\n  if (patch) {\n    if (patch instanceof Function) {\n      vgSpec = patch(vgSpec);\n    } else {\n      vgSpec = applyPatch(vgSpec, patch, true, false).newDocument;\n    }\n  }\n\n  // Set locale. Note that this is a global setting.\n  if (opts.formatLocale) {\n    vega.formatLocale(opts.formatLocale);\n  }\n\n  if (opts.timeFormatLocale) {\n    vega.timeFormatLocale(opts.timeFormatLocale);\n  }\n\n  const {ast} = opts;\n\n  // Do not apply the config to Vega when we have already applied it to Vega-Lite.\n  // This call may throw an Error if parsing fails.\n  const runtime = vega.parse(vgSpec, mode === 'vega-lite' ? {} : (config as VgConfig), {ast});\n\n  const view = new (opts.viewClass || vega.View)(runtime, {\n    loader,\n    logLevel,\n    renderer,\n    ...(ast ? {expr: (vega as any).expressionInterpreter ?? opts.expr ?? expressionInterpreter} : {}),\n  });\n\n  view.addSignalListener('autosize', (_, autosize: Exclude<AutoSize, string>) => {\n    const {type} = autosize;\n    if (type == 'fit-x') {\n      container.classList.add('fit-x');\n      container.classList.remove('fit-y');\n    } else if (type == 'fit-y') {\n      container.classList.remove('fit-x');\n      container.classList.add('fit-y');\n    } else if (type == 'fit') {\n      container.classList.add('fit-x', 'fit-y');\n    } else {\n      container.classList.remove('fit-x', 'fit-y');\n    }\n  });\n\n  if (opts.tooltip !== false) {\n    let handler: TooltipHandler;\n    if (isTooltipHandler(opts.tooltip)) {\n      handler = opts.tooltip;\n    } else {\n      // user provided boolean true or tooltip options\n      handler = new Handler(opts.tooltip === true ? {} : opts.tooltip).call;\n    }\n\n    view.tooltip(handler);\n  }\n\n  let {hover} = opts;\n\n  if (hover === undefined) {\n    hover = mode === 'vega';\n  }\n\n  if (hover) {\n    const {hoverSet, updateSet} = (typeof hover === 'boolean' ? {} : hover) as Hover;\n\n    view.hover(hoverSet, updateSet);\n  }\n\n  if (opts) {\n    if (opts.width != null) {\n      view.width(opts.width);\n    }\n    if (opts.height != null) {\n      view.height(opts.height);\n    }\n    if (opts.padding != null) {\n      view.padding(opts.padding);\n    }\n  }\n\n  await view.initialize(container, opts.bind).runAsync();\n\n  let documentClickHandler: ((this: Document, ev: MouseEvent) => void) | undefined;\n\n  if (actions !== false) {\n    let wrapper = element;\n\n    if (opts.defaultStyle !== false) {\n      const details = document.createElement('details');\n      details.title = i18n.CLICK_TO_VIEW_ACTIONS;\n      element.append(details);\n\n      wrapper = details;\n      const summary = document.createElement('summary');\n      summary.innerHTML = SVG_CIRCLES;\n\n      details.append(summary);\n\n      documentClickHandler = (ev: MouseEvent) => {\n        if (!details.contains(ev.target as any)) {\n          details.removeAttribute('open');\n        }\n      };\n      document.addEventListener('click', documentClickHandler);\n    }\n\n    const ctrl = document.createElement('div');\n    wrapper.append(ctrl);\n    ctrl.classList.add('vega-actions');\n\n    // add 'Export' action\n    if (actions === true || actions.export !== false) {\n      for (const ext of ['svg', 'png'] as const) {\n        if (actions === true || actions.export === true || (actions.export as {svg?: boolean; png?: boolean})[ext]) {\n          const i18nExportAction = (i18n as {[key: string]: string})[`${ext.toUpperCase()}_ACTION`];\n          const exportLink = document.createElement('a');\n\n          exportLink.text = i18nExportAction;\n          exportLink.href = '#';\n          exportLink.target = '_blank';\n          exportLink.download = `${downloadFileName}.${ext}`;\n          // add link on mousedown so that it's correct when the click happens\n          exportLink.addEventListener('mousedown', async function (this, e) {\n            e.preventDefault();\n            const url = await view.toImageURL(ext, opts.scaleFactor);\n            this.href = url;\n          });\n\n          ctrl.append(exportLink);\n        }\n      }\n    }\n\n    // add 'View Source' action\n    if (actions === true || actions.source !== false) {\n      const viewSourceLink = document.createElement('a');\n\n      viewSourceLink.text = i18n.SOURCE_ACTION;\n      viewSourceLink.href = '#';\n      viewSourceLink.addEventListener('click', function (this, e) {\n        viewSource(stringify(spec), opts.sourceHeader ?? '', opts.sourceFooter ?? '', mode);\n        e.preventDefault();\n      });\n\n      ctrl.append(viewSourceLink);\n    }\n\n    // add 'View Compiled' action\n    if (mode === 'vega-lite' && (actions === true || actions.compiled !== false)) {\n      const compileLink = document.createElement('a');\n\n      compileLink.text = i18n.COMPILED_ACTION;\n      compileLink.href = '#';\n      compileLink.addEventListener('click', function (this, e) {\n        viewSource(stringify(vgSpec), opts.sourceHeader ?? '', opts.sourceFooter ?? '', 'vega');\n        e.preventDefault();\n      });\n\n      ctrl.append(compileLink);\n    }\n\n    // add 'Open in Vega Editor' action\n    if (actions === true || actions.editor !== false) {\n      const editorUrl = opts.editorUrl ?? 'https://vega.github.io/editor/';\n      const editorLink = document.createElement('a');\n\n      editorLink.text = i18n.EDITOR_ACTION;\n      editorLink.href = '#';\n      editorLink.addEventListener('click', function (this, e) {\n        post(window, editorUrl, {\n          config: config as Config,\n          mode,\n          renderer,\n          spec: stringify(spec),\n        });\n        e.preventDefault();\n      });\n\n      ctrl.append(editorLink);\n    }\n  }\n\n  function finalize() {\n    if (documentClickHandler) {\n      document.removeEventListener('click', documentClickHandler);\n    }\n    view.finalize();\n  }\n\n  return {view, spec, vgSpec, finalize};\n}\n"]},"metadata":{},"sourceType":"module"}