{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import range from'lodash/range';import JsonLoader from'../../loaders/JsonLoader';import LoaderResult from'../../loaders/LoaderResult';import JsonSource from'../../loaders/data-sources/JsonSource';import{registerPluginFileType}from'../../app/plugins';import{fromEntries}from'../../utils';var numCells=60;var numGenes=90;var InMemoryCellsLoader=/*#__PURE__*/function(_JsonLoader){_inherits(InMemoryCellsLoader,_JsonLoader);var _super=_createSuper(InMemoryCellsLoader);function InMemoryCellsLoader(){_classCallCheck(this,InMemoryCellsLoader);return _super.apply(this,arguments);}_createClass(InMemoryCellsLoader,[{key:\"load\",// eslint-disable-next-line class-methods-use-this\nvalue:function(){var _load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:data=fromEntries(range(numCells).map(function(i){return[\"cell_\".concat(i),{mappings:{random:[Math.random(),Math.random()]},genes:{},xy:[Math.random(),Math.random()]}];}));return _context.abrupt(\"return\",Promise.resolve(new LoaderResult(data,null)));case 2:case\"end\":return _context.stop();}}},_callee);}));function load(){return _load.apply(this,arguments);}return load;}()}]);return InMemoryCellsLoader;}(JsonLoader);var InMemoryMatrixLoader=/*#__PURE__*/function(_JsonLoader2){_inherits(InMemoryMatrixLoader,_JsonLoader2);var _super2=_createSuper(InMemoryMatrixLoader);function InMemoryMatrixLoader(){_classCallCheck(this,InMemoryMatrixLoader);return _super2.apply(this,arguments);}_createClass(InMemoryMatrixLoader,[{key:\"load\",// eslint-disable-next-line class-methods-use-this\nvalue:function(){var _load2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data,rows,cols,matrix,attrs,shape,normalizedMatrix,tNormalizedMatrix,normalizedFlatMatrix,arr;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:data={rows:range(numGenes).map(function(j){return\"gene_\".concat(j);}),cols:range(numCells).map(function(j){return\"cell_\".concat(j);}),matrix:range(numGenes).map(function(i){return range(numCells).map(function(j){return i+j+1;});})};rows=data.rows,cols=data.cols,matrix=data.matrix;attrs={rows:cols,cols:rows};shape=[attrs.rows.length,attrs.cols.length];// Normalize values by converting to one-byte integers.\n// Normalize for each gene (column) independently.\nnormalizedMatrix=matrix.map(function(col){var min=0,max=1;var normalize=function normalize(d){return Math.floor((d-min)/(max-min)*255);};return col.map(normalize);});// Transpose the normalized matrix.\ntNormalizedMatrix=range(shape[0]).map(function(i){return range(shape[1]).map(function(j){return normalizedMatrix[j][i];});});// Flatten the transposed matrix.\nnormalizedFlatMatrix=tNormalizedMatrix.flat();// Need to wrap the NestedArray to mock the HTTPStore-based array\n// which returns promises.\narr={data:Uint8Array.from(normalizedFlatMatrix)};return _context2.abrupt(\"return\",Promise.resolve(new LoaderResult([attrs,arr],null)));case 9:case\"end\":return _context2.stop();}}},_callee2);}));function load(){return _load2.apply(this,arguments);}return load;}()}]);return InMemoryMatrixLoader;}(JsonLoader);registerPluginFileType('in-memory-cells','cells',InMemoryCellsLoader,JsonSource);registerPluginFileType('in-memory-matrix','expression-matrix',InMemoryMatrixLoader,JsonSource);// Use the plugin file type in the configuration.\nexport var pluginFileType={name:'Test plugin file types',version:'1.0.9',description:'Demonstration of a basic plugin file type implementation.',public:false,datasets:[{uid:'plugin-test-dataset',name:'Plugin test dataset',files:[{type:'expression-matrix',fileType:'in-memory-matrix',url:''},{type:'cells',fileType:'in-memory-cells',url:''}]}],initStrategy:'auto',coordinationSpace:{spatialZoom:{A:-6.5}},layout:[{component:'description',props:{title:'Description'},x:0,y:0,w:2,h:2},{component:'heatmap',x:2,y:0,w:10,h:2}]};","map":{"version":3,"sources":["C:/Users/wkuo/Documents/vitessce-forked-v1.2.2/vitessce/src/demo/view-configs/plugin-file-type.js"],"names":["range","JsonLoader","LoaderResult","JsonSource","registerPluginFileType","fromEntries","numCells","numGenes","InMemoryCellsLoader","data","map","i","mappings","random","Math","genes","xy","Promise","resolve","InMemoryMatrixLoader","rows","j","cols","matrix","attrs","shape","length","normalizedMatrix","col","min","max","normalize","d","floor","tNormalizedMatrix","normalizedFlatMatrix","flat","arr","Uint8Array","from","pluginFileType","name","version","description","public","datasets","uid","files","type","fileType","url","initStrategy","coordinationSpace","spatialZoom","A","layout","component","props","title","x","y","w","h"],"mappings":"6jCAAA,MAAOA,CAAAA,KAAP,KAAkB,cAAlB,CACA,MAAOC,CAAAA,UAAP,KAAuB,0BAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,4BAAzB,CACA,MAAOC,CAAAA,UAAP,KAAuB,uCAAvB,CACA,OACEC,sBADF,KAEO,mBAFP,CAGA,OAASC,WAAT,KAA4B,aAA5B,CAEA,GAAMC,CAAAA,QAAQ,CAAG,EAAjB,CACA,GAAMC,CAAAA,QAAQ,CAAG,EAAjB,C,GAEMC,CAAAA,mB,wRACJ;+NAEQC,I,CAAOJ,WAAW,CAACL,KAAK,CAACM,QAAD,CAAL,CAAgBI,GAAhB,CAAoB,SAAAC,CAAC,QAAK,gBAASA,CAAT,EAAc,CAC/DC,QAAQ,CAAE,CACRC,MAAM,CAAE,CACNC,IAAI,CAACD,MAAL,EADM,CAENC,IAAI,CAACD,MAAL,EAFM,CADA,CADqD,CAO/DE,KAAK,CAAE,EAPwD,CAQ/DC,EAAE,CAAE,CACFF,IAAI,CAACD,MAAL,EADE,CAEFC,IAAI,CAACD,MAAL,EAFE,CAR2D,CAAd,CAAL,EAArB,CAAD,C,iCAcjBI,OAAO,CAACC,OAAR,CAAgB,GAAIhB,CAAAA,YAAJ,CAAiBO,IAAjB,CAAuB,IAAvB,CAAhB,C,+JAjBuBR,U,KAqB5BkB,CAAAA,oB,iSACJ;8TAEQV,I,CAAO,CACXW,IAAI,CAAEpB,KAAK,CAACO,QAAD,CAAL,CAAgBG,GAAhB,CAAoB,SAAAW,CAAC,uBAAYA,CAAZ,GAArB,CADK,CAEXC,IAAI,CAAEtB,KAAK,CAACM,QAAD,CAAL,CAAgBI,GAAhB,CAAoB,SAAAW,CAAC,uBAAYA,CAAZ,GAArB,CAFK,CAGXE,MAAM,CAAEvB,KAAK,CAACO,QAAD,CAAL,CAAgBG,GAAhB,CACN,SAAAC,CAAC,QAAIX,CAAAA,KAAK,CAACM,QAAD,CAAL,CAAgBI,GAAhB,CAAoB,SAAAW,CAAC,QAAIV,CAAAA,CAAC,CAAGU,CAAJ,CAAQ,CAAZ,EAArB,CAAJ,EADK,CAHG,C,CAOLD,I,CAAuBX,I,CAAvBW,I,CAAME,I,CAAiBb,I,CAAjBa,I,CAAMC,M,CAAWd,I,CAAXc,M,CACdC,K,CAAQ,CACZJ,IAAI,CAAEE,IADM,CAEZA,IAAI,CAAEF,IAFM,C,CAIRK,K,CAAQ,CAACD,KAAK,CAACJ,IAAN,CAAWM,MAAZ,CAAoBF,KAAK,CAACF,IAAN,CAAWI,MAA/B,C,CACd;AACA;AACMC,gB,CAAmBJ,MAAM,CAACb,GAAP,CAAW,SAACkB,GAAD,CAAS,IACpCC,CAAAA,GADoC,CACvB,CADuB,CAC/BC,GAD+B,CACpB,CADoB,CAE3C,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAC,CAAC,QAAIlB,CAAAA,IAAI,CAACmB,KAAL,CAAY,CAACD,CAAC,CAAGH,GAAL,GAAaC,GAAG,CAAGD,GAAnB,CAAD,CAA4B,GAAvC,CAAJ,EAAnB,CACA,MAAOD,CAAAA,GAAG,CAAClB,GAAJ,CAAQqB,SAAR,CAAP,CACD,CAJwB,C,CAKzB;AACMG,iB,CAAoBlC,KAAK,CAACyB,KAAK,CAAC,CAAD,CAAN,CAAL,CACvBf,GADuB,CACnB,SAAAC,CAAC,QAAIX,CAAAA,KAAK,CAACyB,KAAK,CAAC,CAAD,CAAN,CAAL,CAAgBf,GAAhB,CAAoB,SAAAW,CAAC,QAAIM,CAAAA,gBAAgB,CAACN,CAAD,CAAhB,CAAoBV,CAApB,CAAJ,EAArB,CAAJ,EADkB,C,CAE1B;AACMwB,oB,CAAuBD,iBAAiB,CAACE,IAAlB,E,CAC7B;AACA;AACMC,G,CAAM,CAAE5B,IAAI,CAAE6B,UAAU,CAACC,IAAX,CAAgBJ,oBAAhB,CAAR,C,kCACLlB,OAAO,CAACC,OAAR,CAAgB,GAAIhB,CAAAA,YAAJ,CAAiB,CAACsB,KAAD,CAAQa,GAAR,CAAjB,CAA+B,IAA/B,CAAhB,C,mKA/BwBpC,U,EAmCnCG,sBAAsB,CACpB,iBADoB,CACD,OADC,CAEpBI,mBAFoB,CAECL,UAFD,CAAtB,CAKAC,sBAAsB,CACpB,kBADoB,CACA,mBADA,CAEpBe,oBAFoB,CAEEhB,UAFF,CAAtB,CAKA;AACA,MAAO,IAAMqC,CAAAA,cAAc,CAAG,CAC5BC,IAAI,CAAE,wBADsB,CAE5BC,OAAO,CAAE,OAFmB,CAG5BC,WAAW,CAAE,2DAHe,CAI5BC,MAAM,CAAE,KAJoB,CAK5BC,QAAQ,CAAE,CACR,CACEC,GAAG,CAAE,qBADP,CAEEL,IAAI,CAAE,qBAFR,CAGEM,KAAK,CAAE,CACL,CACEC,IAAI,CAAE,mBADR,CAEEC,QAAQ,CAAE,kBAFZ,CAGEC,GAAG,CAAE,EAHP,CADK,CAML,CACEF,IAAI,CAAE,OADR,CAEEC,QAAQ,CAAE,iBAFZ,CAGEC,GAAG,CAAE,EAHP,CANK,CAHT,CADQ,CALkB,CAuB5BC,YAAY,CAAE,MAvBc,CAwB5BC,iBAAiB,CAAE,CACjBC,WAAW,CAAE,CACXC,CAAC,CAAE,CAAC,GADO,CADI,CAxBS,CA6B5BC,MAAM,CAAE,CACN,CACEC,SAAS,CAAE,aADb,CAEEC,KAAK,CAAE,CACLC,KAAK,CAAE,aADF,CAFT,CAKEC,CAAC,CAAE,CALL,CAMEC,CAAC,CAAE,CANL,CAOEC,CAAC,CAAE,CAPL,CAQEC,CAAC,CAAE,CARL,CADM,CAWN,CACEN,SAAS,CAAE,SADb,CAEEG,CAAC,CAAE,CAFL,CAGEC,CAAC,CAAE,CAHL,CAIEC,CAAC,CAAE,EAJL,CAKEC,CAAC,CAAE,CALL,CAXM,CA7BoB,CAAvB","sourcesContent":["import range from 'lodash/range';\nimport JsonLoader from '../../loaders/JsonLoader';\nimport LoaderResult from '../../loaders/LoaderResult';\nimport JsonSource from '../../loaders/data-sources/JsonSource';\nimport {\n  registerPluginFileType,\n} from '../../app/plugins';\nimport { fromEntries } from '../../utils';\n\nconst numCells = 60;\nconst numGenes = 90;\n\nclass InMemoryCellsLoader extends JsonLoader {\n  // eslint-disable-next-line class-methods-use-this\n  async load() {\n    const data = fromEntries(range(numCells).map(i => ([`cell_${i}`, {\n      mappings: {\n        random: [\n          Math.random(),\n          Math.random(),\n        ],\n      },\n      genes: {},\n      xy: [\n        Math.random(),\n        Math.random(),\n      ],\n    }])));\n\n    return Promise.resolve(new LoaderResult(data, null));\n  }\n}\n\nclass InMemoryMatrixLoader extends JsonLoader {\n  // eslint-disable-next-line class-methods-use-this\n  async load() {\n    const data = {\n      rows: range(numGenes).map(j => `gene_${j}`),\n      cols: range(numCells).map(j => `cell_${j}`),\n      matrix: range(numGenes).map(\n        i => range(numCells).map(j => i + j + 1),\n      ),\n    };\n    const { rows, cols, matrix } = data;\n    const attrs = {\n      rows: cols,\n      cols: rows,\n    };\n    const shape = [attrs.rows.length, attrs.cols.length];\n    // Normalize values by converting to one-byte integers.\n    // Normalize for each gene (column) independently.\n    const normalizedMatrix = matrix.map((col) => {\n      const [min, max] = [0, 1];\n      const normalize = d => Math.floor(((d - min) / (max - min)) * 255);\n      return col.map(normalize);\n    });\n    // Transpose the normalized matrix.\n    const tNormalizedMatrix = range(shape[0])\n      .map(i => range(shape[1]).map(j => normalizedMatrix[j][i]));\n    // Flatten the transposed matrix.\n    const normalizedFlatMatrix = tNormalizedMatrix.flat();\n    // Need to wrap the NestedArray to mock the HTTPStore-based array\n    // which returns promises.\n    const arr = { data: Uint8Array.from(normalizedFlatMatrix) };\n    return Promise.resolve(new LoaderResult([attrs, arr], null));\n  }\n}\n\nregisterPluginFileType(\n  'in-memory-cells', 'cells',\n  InMemoryCellsLoader, JsonSource,\n);\n\nregisterPluginFileType(\n  'in-memory-matrix', 'expression-matrix',\n  InMemoryMatrixLoader, JsonSource,\n);\n\n// Use the plugin file type in the configuration.\nexport const pluginFileType = {\n  name: 'Test plugin file types',\n  version: '1.0.9',\n  description: 'Demonstration of a basic plugin file type implementation.',\n  public: false,\n  datasets: [\n    {\n      uid: 'plugin-test-dataset',\n      name: 'Plugin test dataset',\n      files: [\n        {\n          type: 'expression-matrix',\n          fileType: 'in-memory-matrix',\n          url: '',\n        },\n        {\n          type: 'cells',\n          fileType: 'in-memory-cells',\n          url: '',\n        },\n      ],\n    },\n  ],\n  initStrategy: 'auto',\n  coordinationSpace: {\n    spatialZoom: {\n      A: -6.5,\n    },\n  },\n  layout: [\n    {\n      component: 'description',\n      props: {\n        title: 'Description',\n      },\n      x: 0,\n      y: 0,\n      w: 2,\n      h: 2,\n    },\n    {\n      component: 'heatmap',\n      x: 2,\n      y: 0,\n      w: 10,\n      h: 2,\n    },\n  ],\n};\n"]},"metadata":{},"sourceType":"module"}