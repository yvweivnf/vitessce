{"ast":null,"code":"// tslint:disable max-classes-per-file\nimport { getBundleURL } from \"./get-bundle-url.browser\";\nexport const defaultPoolSize = typeof navigator !== \"undefined\" && navigator.hardwareConcurrency ? navigator.hardwareConcurrency : 4;\n\nconst isAbsoluteURL = value => /^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(value);\n\nfunction createSourceBlobURL(code) {\n  const blob = new Blob([code], {\n    type: \"application/javascript\"\n  });\n  return URL.createObjectURL(blob);\n}\n\nfunction selectWorkerImplementation() {\n  if (typeof Worker === \"undefined\") {\n    // Might happen on Safari, for instance\n    // The idea is to only fail if the constructor is actually used\n    return class NoWebWorker {\n      constructor() {\n        throw Error(\"No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.\");\n      }\n\n    };\n  }\n\n  class WebWorker extends Worker {\n    constructor(url, options) {\n      var _a, _b;\n\n      if (typeof url === \"string\" && options && options._baseURL) {\n        url = new URL(url, options._baseURL);\n      } else if (typeof url === \"string\" && !isAbsoluteURL(url) && getBundleURL().match(/^file:\\/\\//i)) {\n        url = new URL(url, getBundleURL().replace(/\\/[^\\/]+$/, \"/\"));\n\n        if ((_a = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _a !== void 0 ? _a : true) {\n          url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n        }\n      }\n\n      if (typeof url === \"string\" && isAbsoluteURL(url)) {\n        // Create source code blob loading JS file via `importScripts()`\n        // to circumvent worker CORS restrictions\n        if ((_b = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _b !== void 0 ? _b : true) {\n          url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n        }\n      }\n\n      super(url, options);\n    }\n\n  }\n\n  class BlobWorker extends WebWorker {\n    constructor(blob, options) {\n      const url = window.URL.createObjectURL(blob);\n      super(url, options);\n    }\n\n    static fromText(source, options) {\n      const blob = new window.Blob([source], {\n        type: \"text/javascript\"\n      });\n      return new BlobWorker(blob, options);\n    }\n\n  }\n\n  return {\n    blob: BlobWorker,\n    default: WebWorker\n  };\n}\n\nlet implementation;\nexport function getWorkerImplementation() {\n  if (!implementation) {\n    implementation = selectWorkerImplementation();\n  }\n\n  return implementation;\n}\nexport function isWorkerRuntime() {\n  const isWindowContext = typeof self !== \"undefined\" && typeof Window !== \"undefined\" && self instanceof Window;\n  return typeof self !== \"undefined\" && self.postMessage && !isWindowContext ? true : false;\n}","map":{"version":3,"sources":["C:/Users/wkuo/Documents/vitessce-forked-v1.2.2/vitessce/node_modules/threads/dist-esm/master/implementation.browser.js"],"names":["getBundleURL","defaultPoolSize","navigator","hardwareConcurrency","isAbsoluteURL","value","test","createSourceBlobURL","code","blob","Blob","type","URL","createObjectURL","selectWorkerImplementation","Worker","NoWebWorker","constructor","Error","WebWorker","url","options","_a","_b","_baseURL","match","replace","CORSWorkaround","JSON","stringify","BlobWorker","window","fromText","source","default","implementation","getWorkerImplementation","isWorkerRuntime","isWindowContext","self","Window","postMessage"],"mappings":"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","sourcesContent":["// tslint:disable max-classes-per-file\nimport { getBundleURL } from \"./get-bundle-url.browser\";\nexport const defaultPoolSize = typeof navigator !== \"undefined\" && navigator.hardwareConcurrency\n    ? navigator.hardwareConcurrency\n    : 4;\nconst isAbsoluteURL = (value) => /^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(value);\nfunction createSourceBlobURL(code) {\n    const blob = new Blob([code], { type: \"application/javascript\" });\n    return URL.createObjectURL(blob);\n}\nfunction selectWorkerImplementation() {\n    if (typeof Worker === \"undefined\") {\n        // Might happen on Safari, for instance\n        // The idea is to only fail if the constructor is actually used\n        return class NoWebWorker {\n            constructor() {\n                throw Error(\"No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.\");\n            }\n        };\n    }\n    class WebWorker extends Worker {\n        constructor(url, options) {\n            var _a, _b;\n            if (typeof url === \"string\" && options && options._baseURL) {\n                url = new URL(url, options._baseURL);\n            }\n            else if (typeof url === \"string\" && !isAbsoluteURL(url) && getBundleURL().match(/^file:\\/\\//i)) {\n                url = new URL(url, getBundleURL().replace(/\\/[^\\/]+$/, \"/\"));\n                if ((_a = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _a !== void 0 ? _a : true) {\n                    url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n                }\n            }\n            if (typeof url === \"string\" && isAbsoluteURL(url)) {\n                // Create source code blob loading JS file via `importScripts()`\n                // to circumvent worker CORS restrictions\n                if ((_b = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _b !== void 0 ? _b : true) {\n                    url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n                }\n            }\n            super(url, options);\n        }\n    }\n    class BlobWorker extends WebWorker {\n        constructor(blob, options) {\n            const url = window.URL.createObjectURL(blob);\n            super(url, options);\n        }\n        static fromText(source, options) {\n            const blob = new window.Blob([source], { type: \"text/javascript\" });\n            return new BlobWorker(blob, options);\n        }\n    }\n    return {\n        blob: BlobWorker,\n        default: WebWorker\n    };\n}\nlet implementation;\nexport function getWorkerImplementation() {\n    if (!implementation) {\n        implementation = selectWorkerImplementation();\n    }\n    return implementation;\n}\nexport function isWorkerRuntime() {\n    const isWindowContext = typeof self !== \"undefined\" && typeof Window !== \"undefined\" && self instanceof Window;\n    return typeof self !== \"undefined\" && self.postMessage && !isWindowContext ? true : false;\n}\n"]},"metadata":{},"sourceType":"module"}