{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\wkuo\\\\Documents\\\\vitessce-forked-v1.2.2\\\\vitessce\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import{getChannelStats}from'@hms-dbmi/viv';import{Matrix4}from'math.gl';function getSingleSelectionStats2D(_x){return _getSingleSelectionStats2D.apply(this,arguments);}function _getSingleSelectionStats2D(){_getSingleSelectionStats2D=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref){var loader,selection,data,raster,selectionStats,domain,slider;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:loader=_ref.loader,selection=_ref.selection;data=Array.isArray(loader)?loader[loader.length-1]:loader;_context3.next=4;return data.getRaster({selection:selection});case 4:raster=_context3.sent;selectionStats=getChannelStats(raster.data);domain=selectionStats.domain,slider=selectionStats.contrastLimits;return _context3.abrupt(\"return\",{domain:domain,slider:slider});case 8:case\"end\":return _context3.stop();}}},_callee3);}));return _getSingleSelectionStats2D.apply(this,arguments);}function getSingleSelectionStats3D(_x2){return _getSingleSelectionStats3D.apply(this,arguments);}/**\n * Get bounding cube for a given loader i.e [[0, width], [0, height], [0, depth]]\n * @param {Object} loader PixelSource|PixelSource[]\n * @param {[]} selection Selection for stats.\n * @param {boolean} use3d Whether or not to get 3d stats.\n * @returns {Object} { domains, sliders }\n */function _getSingleSelectionStats3D(){_getSingleSelectionStats3D=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref2){var loader,selection,lowResSource,shape,labels,sizeZ,raster0,rasterMid,rasterTop,stats0,statsMid,statsTop;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:loader=_ref2.loader,selection=_ref2.selection;lowResSource=loader[loader.length-1];shape=lowResSource.shape,labels=lowResSource.labels;// eslint-disable-next-line no-bitwise\nsizeZ=shape[labels.indexOf('z')]>>loader.length-1;_context4.next=6;return lowResSource.getRaster({selection:_objectSpread({},selection,{z:0})});case 6:raster0=_context4.sent;_context4.next=9;return lowResSource.getRaster({selection:_objectSpread({},selection,{z:Math.floor(sizeZ/2)})});case 9:rasterMid=_context4.sent;_context4.next=12;return lowResSource.getRaster({selection:_objectSpread({},selection,{z:Math.max(0,sizeZ-1)})});case 12:rasterTop=_context4.sent;stats0=getChannelStats(raster0.data);statsMid=getChannelStats(rasterMid.data);statsTop=getChannelStats(rasterTop.data);return _context4.abrupt(\"return\",{domain:[Math.min(stats0.domain[0],statsMid.domain[0],statsTop.domain[0]),Math.max(stats0.domain[1],statsMid.domain[1],statsTop.domain[1])],slider:[Math.min(stats0.contrastLimits[0],statsMid.contrastLimits[0],statsTop.contrastLimits[0]),Math.max(stats0.contrastLimits[1],statsMid.contrastLimits[1],statsTop.contrastLimits[1])]});case 17:case\"end\":return _context4.stop();}}},_callee4);}));return _getSingleSelectionStats3D.apply(this,arguments);}export var getSingleSelectionStats=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref3){var loader,selection,use3d,getStats;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:loader=_ref3.loader,selection=_ref3.selection,use3d=_ref3.use3d;getStats=use3d?getSingleSelectionStats3D:getSingleSelectionStats2D;return _context.abrupt(\"return\",getStats({loader:loader,selection:selection}));case 3:case\"end\":return _context.stop();}}},_callee);}));return function getSingleSelectionStats(_x3){return _ref4.apply(this,arguments);};}();export var getMultiSelectionStats=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref5){var loader,selections,use3d,stats,domains,sliders;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:loader=_ref5.loader,selections=_ref5.selections,use3d=_ref5.use3d;_context2.next=3;return Promise.all(selections.map(function(selection){return getSingleSelectionStats({loader:loader,selection:selection,use3d:use3d});}));case 3:stats=_context2.sent;domains=stats.map(function(stat){return stat.domain;});sliders=stats.map(function(stat){return stat.slider;});return _context2.abrupt(\"return\",{domains:domains,sliders:sliders});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getMultiSelectionStats(_x4){return _ref6.apply(this,arguments);};}();/**\n * Get physical size scaling Matrix4\n * @param {Object} loader PixelSource\n * @returns {Object} matrix\n */export function getPhysicalSizeScalingMatrix(loader){var _loader$meta$physical,_loader$meta;var _ref7=(_loader$meta$physical=loader===null||loader===void 0?void 0:(_loader$meta=loader.meta)===null||_loader$meta===void 0?void 0:_loader$meta.physicalSizes)!==null&&_loader$meta$physical!==void 0?_loader$meta$physical:{},x=_ref7.x,y=_ref7.y,z=_ref7.z;if((x===null||x===void 0?void 0:x.size)&&(y===null||y===void 0?void 0:y.size)&&(z===null||z===void 0?void 0:z.size)){var min=Math.min(z.size,x.size,y.size);var ratio=[x.size/min,y.size/min,z.size/min];return new Matrix4().scale(ratio);}return new Matrix4().identity();}/**\n * Get bounding cube for a given loader\n * @param {Object} loader PixelSource|PixelSource[]\n * @returns {Array} [0, width], [0, height], [0, depth]]\n */export function getBoundingCube(loader){var source=Array.isArray(loader)?loader[0]:loader;var shape=source.shape,labels=source.labels;var physicalSizeScalingMatrix=getPhysicalSizeScalingMatrix(source);var xSlice=[0,physicalSizeScalingMatrix[0]*shape[labels.indexOf('x')]];var ySlice=[0,physicalSizeScalingMatrix[5]*shape[labels.indexOf('y')]];var zSlice=[0,physicalSizeScalingMatrix[10]*shape[labels.indexOf('z')]];return[xSlice,ySlice,zSlice];}export function abbreviateNumber(value){// Return an abbreviated representation of value, in 5 characters or less.\nvar maxLength=5;var maxNaiveDigits=maxLength;/* eslint-disable no-plusplus */if(!Number.isInteger(value)){--maxNaiveDigits;}// Wasted on \".\"\nif(value<1){--maxNaiveDigits;}// Wasted on \"0.\"\n/* eslint-disable no-plusplus */var naive=Intl.NumberFormat('en-US',{maximumSignificantDigits:maxNaiveDigits,useGrouping:false}).format(value);if(naive.length<=maxLength)return naive;// \"e+9\" consumes 3 characters, so if we even had two significant digits,\n// it would take take us to six characters, including the decimal point.\nreturn value.toExponential(0);}","map":{"version":3,"sources":["C:/Users/wkuo/Documents/vitessce-forked-v1.2.2/vitessce/src/components/layer-controller/utils.js"],"names":["getChannelStats","Matrix4","getSingleSelectionStats2D","loader","selection","data","Array","isArray","length","getRaster","raster","selectionStats","domain","slider","contrastLimits","getSingleSelectionStats3D","lowResSource","shape","labels","sizeZ","indexOf","z","raster0","Math","floor","rasterMid","max","rasterTop","stats0","statsMid","statsTop","min","getSingleSelectionStats","use3d","getStats","getMultiSelectionStats","selections","Promise","all","map","stats","domains","stat","sliders","getPhysicalSizeScalingMatrix","meta","physicalSizes","x","y","size","ratio","scale","identity","getBoundingCube","source","physicalSizeScalingMatrix","xSlice","ySlice","zSlice","abbreviateNumber","value","maxLength","maxNaiveDigits","Number","isInteger","naive","Intl","NumberFormat","maximumSignificantDigits","useGrouping","format","toExponential"],"mappings":"oiBAAA,OAASA,eAAT,KAAgC,eAAhC,CACA,OAASC,OAAT,KAAwB,SAAxB,C,QAEeC,CAAAA,yB,uLAAf,0MAA2CC,MAA3C,MAA2CA,MAA3C,CAAmDC,SAAnD,MAAmDA,SAAnD,CACQC,IADR,CACeC,KAAK,CAACC,OAAN,CAAcJ,MAAd,EAAwBA,MAAM,CAACA,MAAM,CAACK,MAAP,CAAgB,CAAjB,CAA9B,CAAoDL,MADnE,wBAEuBE,CAAAA,IAAI,CAACI,SAAL,CAAe,CAAEL,SAAS,CAATA,SAAF,CAAf,CAFvB,QAEQM,MAFR,gBAGQC,cAHR,CAGyBX,eAAe,CAACU,MAAM,CAACL,IAAR,CAHxC,CAIUO,MAJV,CAI6CD,cAJ7C,CAIUC,MAJV,CAIkCC,MAJlC,CAI6CF,cAJ7C,CAIkBG,cAJlB,kCAKS,CAAEF,MAAM,CAANA,MAAF,CAAUC,MAAM,CAANA,MAAV,CALT,0D,oEAQeE,CAAAA,yB,+DAqCf;;;;;;4HArCA,uPAA2CZ,MAA3C,OAA2CA,MAA3C,CAAmDC,SAAnD,OAAmDA,SAAnD,CACQY,YADR,CACuBb,MAAM,CAACA,MAAM,CAACK,MAAP,CAAgB,CAAjB,CAD7B,CAEUS,KAFV,CAE4BD,YAF5B,CAEUC,KAFV,CAEiBC,MAFjB,CAE4BF,YAF5B,CAEiBE,MAFjB,CAGE;AACMC,KAJR,CAIgBF,KAAK,CAACC,MAAM,CAACE,OAAP,CAAe,GAAf,CAAD,CAAL,EAA+BjB,MAAM,CAACK,MAAP,CAAgB,CAJ/D,wBAKwBQ,CAAAA,YAAY,CAACP,SAAb,CAAuB,CAC3CL,SAAS,kBAAOA,SAAP,EAAkBiB,CAAC,CAAE,CAArB,EADkC,CAAvB,CALxB,QAKQC,OALR,uCAQ0BN,CAAAA,YAAY,CAACP,SAAb,CAAuB,CAC7CL,SAAS,kBAAOA,SAAP,EAAkBiB,CAAC,CAAEE,IAAI,CAACC,KAAL,CAAWL,KAAK,CAAG,CAAnB,CAArB,EADoC,CAAvB,CAR1B,QAQQM,SARR,wCAW0BT,CAAAA,YAAY,CAACP,SAAb,CAAuB,CAC7CL,SAAS,kBAAOA,SAAP,EAAkBiB,CAAC,CAAEE,IAAI,CAACG,GAAL,CAAS,CAAT,CAAYP,KAAK,CAAG,CAApB,CAArB,EADoC,CAAvB,CAX1B,SAWQQ,SAXR,gBAcQC,MAdR,CAciB5B,eAAe,CAACsB,OAAO,CAACjB,IAAT,CAdhC,CAeQwB,QAfR,CAemB7B,eAAe,CAACyB,SAAS,CAACpB,IAAX,CAflC,CAgBQyB,QAhBR,CAgBmB9B,eAAe,CAAC2B,SAAS,CAACtB,IAAX,CAhBlC,kCAiBS,CACLO,MAAM,CAAE,CACNW,IAAI,CAACQ,GAAL,CAASH,MAAM,CAAChB,MAAP,CAAc,CAAd,CAAT,CAA2BiB,QAAQ,CAACjB,MAAT,CAAgB,CAAhB,CAA3B,CAA+CkB,QAAQ,CAAClB,MAAT,CAAgB,CAAhB,CAA/C,CADM,CAENW,IAAI,CAACG,GAAL,CAASE,MAAM,CAAChB,MAAP,CAAc,CAAd,CAAT,CAA2BiB,QAAQ,CAACjB,MAAT,CAAgB,CAAhB,CAA3B,CAA+CkB,QAAQ,CAAClB,MAAT,CAAgB,CAAhB,CAA/C,CAFM,CADH,CAKLC,MAAM,CAAE,CACNU,IAAI,CAACQ,GAAL,CACEH,MAAM,CAACd,cAAP,CAAsB,CAAtB,CADF,CAEEe,QAAQ,CAACf,cAAT,CAAwB,CAAxB,CAFF,CAGEgB,QAAQ,CAAChB,cAAT,CAAwB,CAAxB,CAHF,CADM,CAMNS,IAAI,CAACG,GAAL,CACEE,MAAM,CAACd,cAAP,CAAsB,CAAtB,CADF,CAEEe,QAAQ,CAACf,cAAT,CAAwB,CAAxB,CAFF,CAGEgB,QAAQ,CAAChB,cAAT,CAAwB,CAAxB,CAHF,CANM,CALH,CAjBT,2D,4DA4CA,MAAO,IAAMkB,CAAAA,uBAAuB,2FAAG,4KAAS7B,MAAT,OAASA,MAAT,CAAiBC,SAAjB,OAAiBA,SAAjB,CAA4B6B,KAA5B,OAA4BA,KAA5B,CAC/BC,QAD+B,CACpBD,KAAK,CAClBlB,yBADkB,CAElBb,yBAHiC,iCAI9BgC,QAAQ,CAAC,CAAE/B,MAAM,CAANA,MAAF,CAAUC,SAAS,CAATA,SAAV,CAAD,CAJsB,wDAAH,kBAAvB4B,CAAAA,uBAAuB,8CAA7B,CAOP,MAAO,IAAMG,CAAAA,sBAAsB,2FAAG,+LAAShC,MAAT,OAASA,MAAT,CAAiBiC,UAAjB,OAAiBA,UAAjB,CAA6BH,KAA7B,OAA6BA,KAA7B,wBAChBI,CAAAA,OAAO,CAACC,GAAR,CAClBF,UAAU,CAACG,GAAX,CAAe,SAAAnC,SAAS,QAAI4B,CAAAA,uBAAuB,CAAC,CAAE7B,MAAM,CAANA,MAAF,CAAUC,SAAS,CAATA,SAAV,CAAqB6B,KAAK,CAALA,KAArB,CAAD,CAA3B,EAAxB,CADkB,CADgB,QAC9BO,KAD8B,gBAI9BC,OAJ8B,CAIpBD,KAAK,CAACD,GAAN,CAAU,SAAAG,IAAI,QAAIA,CAAAA,IAAI,CAAC9B,MAAT,EAAd,CAJoB,CAK9B+B,OAL8B,CAKpBH,KAAK,CAACD,GAAN,CAAU,SAAAG,IAAI,QAAIA,CAAAA,IAAI,CAAC7B,MAAT,EAAd,CALoB,kCAM7B,CAAE4B,OAAO,CAAPA,OAAF,CAAWE,OAAO,CAAPA,OAAX,CAN6B,0DAAH,kBAAtBR,CAAAA,sBAAsB,8CAA5B,CASP;;;;GAKA,MAAO,SAASS,CAAAA,4BAAT,CAAsCzC,MAAtC,CAA8C,yEAC/BA,MAD+B,SAC/BA,MAD+B,+BAC/BA,MAAM,CAAE0C,IADuB,uCAC/B,aAAcC,aADiB,+DACA,EADA,CAC3CC,CAD2C,OAC3CA,CAD2C,CACxCC,CADwC,OACxCA,CADwC,CACrC3B,CADqC,OACrCA,CADqC,CAEnD,GAAI,CAAA0B,CAAC,OAAD,EAAAA,CAAC,SAAD,QAAAA,CAAC,CAAEE,IAAH,IAAWD,CAAX,SAAWA,CAAX,iBAAWA,CAAC,CAAEC,IAAd,IAAsB5B,CAAtB,SAAsBA,CAAtB,iBAAsBA,CAAC,CAAE4B,IAAzB,CAAJ,CAAmC,CACjC,GAAMlB,CAAAA,GAAG,CAAGR,IAAI,CAACQ,GAAL,CAASV,CAAC,CAAC4B,IAAX,CAAiBF,CAAC,CAACE,IAAnB,CAAyBD,CAAC,CAACC,IAA3B,CAAZ,CACA,GAAMC,CAAAA,KAAK,CAAG,CAACH,CAAC,CAACE,IAAF,CAASlB,GAAV,CAAeiB,CAAC,CAACC,IAAF,CAASlB,GAAxB,CAA6BV,CAAC,CAAC4B,IAAF,CAASlB,GAAtC,CAAd,CACA,MAAO,IAAI9B,CAAAA,OAAJ,GAAckD,KAAd,CAAoBD,KAApB,CAAP,CACD,CACD,MAAO,IAAIjD,CAAAA,OAAJ,GAAcmD,QAAd,EAAP,CACD,CAED;;;;GAKA,MAAO,SAASC,CAAAA,eAAT,CAAyBlD,MAAzB,CAAiC,CACtC,GAAMmD,CAAAA,MAAM,CAAGhD,KAAK,CAACC,OAAN,CAAcJ,MAAd,EAAwBA,MAAM,CAAC,CAAD,CAA9B,CAAoCA,MAAnD,CADsC,GAE9Bc,CAAAA,KAF8B,CAEZqC,MAFY,CAE9BrC,KAF8B,CAEvBC,MAFuB,CAEZoC,MAFY,CAEvBpC,MAFuB,CAGtC,GAAMqC,CAAAA,yBAAyB,CAAGX,4BAA4B,CAACU,MAAD,CAA9D,CACA,GAAME,CAAAA,MAAM,CAAG,CAAC,CAAD,CAAID,yBAAyB,CAAC,CAAD,CAAzB,CAA+BtC,KAAK,CAACC,MAAM,CAACE,OAAP,CAAe,GAAf,CAAD,CAAxC,CAAf,CACA,GAAMqC,CAAAA,MAAM,CAAG,CAAC,CAAD,CAAIF,yBAAyB,CAAC,CAAD,CAAzB,CAA+BtC,KAAK,CAACC,MAAM,CAACE,OAAP,CAAe,GAAf,CAAD,CAAxC,CAAf,CACA,GAAMsC,CAAAA,MAAM,CAAG,CACb,CADa,CAEbH,yBAAyB,CAAC,EAAD,CAAzB,CAAgCtC,KAAK,CAACC,MAAM,CAACE,OAAP,CAAe,GAAf,CAAD,CAFxB,CAAf,CAIA,MAAO,CAACoC,MAAD,CAASC,MAAT,CAAiBC,MAAjB,CAAP,CACD,CAED,MAAO,SAASC,CAAAA,gBAAT,CAA0BC,KAA1B,CAAiC,CACtC;AAEA,GAAMC,CAAAA,SAAS,CAAG,CAAlB,CACA,GAAIC,CAAAA,cAAc,CAAGD,SAArB,CAEA,gCACA,GAAI,CAACE,MAAM,CAACC,SAAP,CAAiBJ,KAAjB,CAAL,CAA8B,CAC5B,EAAEE,cAAF,CACD,CAAC;AACF,GAAIF,KAAK,CAAG,CAAZ,CAAe,CACb,EAAEE,cAAF,CACD,CAAC;AACF,gCAEA,GAAMG,CAAAA,KAAK,CAAGC,IAAI,CAACC,YAAL,CAAkB,OAAlB,CAA2B,CACvCC,wBAAwB,CAAEN,cADa,CAEvCO,WAAW,CAAE,KAF0B,CAA3B,EAGXC,MAHW,CAGJV,KAHI,CAAd,CAIA,GAAIK,KAAK,CAACzD,MAAN,EAAgBqD,SAApB,CAA+B,MAAOI,CAAAA,KAAP,CAE/B;AACA;AACA,MAAOL,CAAAA,KAAK,CAACW,aAAN,CAAoB,CAApB,CAAP,CACD","sourcesContent":["import { getChannelStats } from '@hms-dbmi/viv';\nimport { Matrix4 } from 'math.gl';\n\nasync function getSingleSelectionStats2D({ loader, selection }) {\n  const data = Array.isArray(loader) ? loader[loader.length - 1] : loader;\n  const raster = await data.getRaster({ selection });\n  const selectionStats = getChannelStats(raster.data);\n  const { domain, contrastLimits: slider } = selectionStats;\n  return { domain, slider };\n}\n\nasync function getSingleSelectionStats3D({ loader, selection }) {\n  const lowResSource = loader[loader.length - 1];\n  const { shape, labels } = lowResSource;\n  // eslint-disable-next-line no-bitwise\n  const sizeZ = shape[labels.indexOf('z')] >> (loader.length - 1);\n  const raster0 = await lowResSource.getRaster({\n    selection: { ...selection, z: 0 },\n  });\n  const rasterMid = await lowResSource.getRaster({\n    selection: { ...selection, z: Math.floor(sizeZ / 2) },\n  });\n  const rasterTop = await lowResSource.getRaster({\n    selection: { ...selection, z: Math.max(0, sizeZ - 1) },\n  });\n  const stats0 = getChannelStats(raster0.data);\n  const statsMid = getChannelStats(rasterMid.data);\n  const statsTop = getChannelStats(rasterTop.data);\n  return {\n    domain: [\n      Math.min(stats0.domain[0], statsMid.domain[0], statsTop.domain[0]),\n      Math.max(stats0.domain[1], statsMid.domain[1], statsTop.domain[1]),\n    ],\n    slider: [\n      Math.min(\n        stats0.contrastLimits[0],\n        statsMid.contrastLimits[0],\n        statsTop.contrastLimits[0],\n      ),\n      Math.max(\n        stats0.contrastLimits[1],\n        statsMid.contrastLimits[1],\n        statsTop.contrastLimits[1],\n      ),\n    ],\n  };\n}\n\n/**\n * Get bounding cube for a given loader i.e [[0, width], [0, height], [0, depth]]\n * @param {Object} loader PixelSource|PixelSource[]\n * @param {[]} selection Selection for stats.\n * @param {boolean} use3d Whether or not to get 3d stats.\n * @returns {Object} { domains, sliders }\n */\nexport const getSingleSelectionStats = async ({ loader, selection, use3d }) => {\n  const getStats = use3d\n    ? getSingleSelectionStats3D\n    : getSingleSelectionStats2D;\n  return getStats({ loader, selection });\n};\n\nexport const getMultiSelectionStats = async ({ loader, selections, use3d }) => {\n  const stats = await Promise.all(\n    selections.map(selection => getSingleSelectionStats({ loader, selection, use3d })),\n  );\n  const domains = stats.map(stat => stat.domain);\n  const sliders = stats.map(stat => stat.slider);\n  return { domains, sliders };\n};\n\n/**\n * Get physical size scaling Matrix4\n * @param {Object} loader PixelSource\n * @returns {Object} matrix\n */\nexport function getPhysicalSizeScalingMatrix(loader) {\n  const { x, y, z } = loader?.meta?.physicalSizes ?? {};\n  if (x?.size && y?.size && z?.size) {\n    const min = Math.min(z.size, x.size, y.size);\n    const ratio = [x.size / min, y.size / min, z.size / min];\n    return new Matrix4().scale(ratio);\n  }\n  return new Matrix4().identity();\n}\n\n/**\n * Get bounding cube for a given loader\n * @param {Object} loader PixelSource|PixelSource[]\n * @returns {Array} [0, width], [0, height], [0, depth]]\n */\nexport function getBoundingCube(loader) {\n  const source = Array.isArray(loader) ? loader[0] : loader;\n  const { shape, labels } = source;\n  const physicalSizeScalingMatrix = getPhysicalSizeScalingMatrix(source);\n  const xSlice = [0, physicalSizeScalingMatrix[0] * shape[labels.indexOf('x')]];\n  const ySlice = [0, physicalSizeScalingMatrix[5] * shape[labels.indexOf('y')]];\n  const zSlice = [\n    0,\n    physicalSizeScalingMatrix[10] * shape[labels.indexOf('z')],\n  ];\n  return [xSlice, ySlice, zSlice];\n}\n\nexport function abbreviateNumber(value) {\n  // Return an abbreviated representation of value, in 5 characters or less.\n\n  const maxLength = 5;\n  let maxNaiveDigits = maxLength;\n\n  /* eslint-disable no-plusplus */\n  if (!Number.isInteger(value)) {\n    --maxNaiveDigits;\n  } // Wasted on \".\"\n  if (value < 1) {\n    --maxNaiveDigits;\n  } // Wasted on \"0.\"\n  /* eslint-disable no-plusplus */\n\n  const naive = Intl.NumberFormat('en-US', {\n    maximumSignificantDigits: maxNaiveDigits,\n    useGrouping: false,\n  }).format(value);\n  if (naive.length <= maxLength) return naive;\n\n  // \"e+9\" consumes 3 characters, so if we even had two significant digits,\n  // it would take take us to six characters, including the decimal point.\n  return value.toExponential(0);\n}\n"]},"metadata":{},"sourceType":"module"}